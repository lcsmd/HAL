<!DOCTYPE html>
<html>
<head>
   <title>The Login Process</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="Login process,LOGIN VOC entry,MASTER.LOGIN" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "loginprocess.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">The Login Process</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="entering_qm.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="command_scripts.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>There are two stages to login; user authentication and process initialisation.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">User Authentication</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>On Windows, users connecting to QM via a network must enter a valid Windows user name and password. The new process runs as that user and with the associated access permissions.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QM implements a further layer of security on top of the Windows authentication by maintaining a register of user names allowed to use QM. A user name may be added to this register using the <span style="font-weight: bold;"><a href="create_user.htm" class="topiclink">CREATE.USER</a></span> or <span style="font-weight: bold;"><a href="admin_user.htm" class="topiclink">ADMIN.USER</a></span> commands. The register entry determines:</p>
<p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">1.</span>whether the user is allowed to use QM at all. This check can be suppressed using the <span style="font-weight: bold;"><a href="security.htm" class="topiclink">SECURITY</a></span> command.</p><p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">2.</span>whether the user is to be granted administrator rights within QM.</p><p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">3.</span>the name of the account that the user should start in. If no account is specified, a prompt is displayed for the account name. </p><p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">4.</span>restrictions on which accounts they may access.</p><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If security has been turned off and the user name does not appear in the user register, the user runs without administrator rights and an account name prompt is displayed.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>On USB installations of QM, the above mechanism is extended such that QM performs the user name and password validation using its own internal user register. The newly created process runs with the Windows user name and access permissions of the user that started the QMUSBSrvr process.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>On other platforms, users connecting to QM via a network usually open telnet sessions as normal users and then enter QM, perhaps automatically via their profile script. It is, however, possible to connect directly to QM in which case the security mechanisms described above for Windows apply unless the qmlnxd process is running as a non-root user. In this situation, the user name must have been defined using the <span style="font-weight: bold;"><a href="create_user.htm" class="topiclink">CREATE.USER</a></span> or <span style="font-weight: bold;"><a href="admin_user.htm" class="topiclink">ADMIN.USER</a></span> commands</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Process Initialisation</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When a user successfully enters an interactive QM session, the following steps occur:</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0; padding-left: 30px; margin: 0 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">1.</span>For users entering QM directly from a network connection, QM attempts to determine the terminal type by use of telnet negotiation commands. If the emulator in use does not support these, QM looks for an environment variable named TERM and, if this is found, uses it to set the default terminal type. If this also fails, vt100 is used by default.</p><p style="text-indent: -1px; margin: 0 0 0 60px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -1px; margin: 0 0 0 60px;">For QMConsole users on Windows, the terminal type is set to qmterm. For users entering QM from an operating command prompt on other platforms, QM looks for an environment variable named TERM and, if this is found, uses it to set the default terminal type. If this fails, vt100 is used by default. </p>
<p style="text-indent: -1px; margin: 0 0 0 60px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -1px; margin: 0 0 0 60px;">The terminal type can be changed later from within QM using the <span style="font-weight: bold;"><a href="term.htm" class="topiclink">TERM</a></span> command. When using AccuTerm, it is strongly recommended that the terminal types with the -at suffix (e.g. vt220-at) are used as these enable AccuTerm specific features such as the screen switching required for the full screen mode of the QMBasic debugger.</p>
<p style="text-indent: -1px; margin: 0 0 0 60px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0; padding-left: 30px; margin: 0 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">2.</span>QM then looks for environment variables named LINES and COLUMNS and, if found and valid, uses these to set the initial size of the terminal window. When using a QMConsole session on Windows, the displayed window will be adjusted to be this size. On other connections, it is the user's responsibility to ensure that the terminal emulator screen dimensions match those expected by QM.</p><p style="margin: 0 0 0 30px;">&nbsp;</p>
<p style="text-indent: 0; padding-left: 30px; margin: 0 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">3.</span>The system looks in the QMSYS account <a href="voc.htm" class="topiclink">VOC</a> file to find a paragraph named <a href="command_scripts.htm" class="topiclink">MASTER.LOGIN</a> and, if this exists, executes it. This paragraph can be used for system wide initialisation such as setting European date format or standard printer associations.</p><p style="text-indent: 4px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0; padding-left: 30px; margin: 0 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">4.</span>The system checks in the user's account <a href="voc.htm" class="topiclink">VOC</a> file to find an executable (menu, paragraph, sentence, verb) item named <a href="command_scripts.htm" class="topiclink">LOGIN</a> and, if this exists, executes it. The LOGIN item is typically used to perform account specific initialisation and the enter the application. Note that this happens for all QM processes, including phantoms and QMClient sessions. To exit from the LOGIN paragraph for a phantom process, insert a line</p><p style="margin: 6px 0 6px 90px;"><span style="font-family: 'Courier New',Courier,monospace;">IF @TTY = 'phantom' THEN STOP</span></p>
<p style="margin: 0 0 0 60px;">at the relevant point in the paragraph. For a QMClient session, test for 'vbsrvr'. See <a href="at_variables.htm#tty" class="topiclink">@TTY</a> for more details.</p>
<p style="margin: 0 0 0 60px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 60px;">Some other multivalue products look for an item named the same as the user's login id. This can be emulated on QM by creating a LOGIN item that is simply</p>
<p style="margin: 0 0 0 90px;"><span style="font-family: 'Courier New',Courier,monospace;">1: S</span></p>
<p style="margin: 0 0 0 90px;"><span style="font-family: 'Courier New',Courier,monospace;">2: &lt;&lt;@LOGNAME&gt;&gt;</span></p>
<p style="margin: 0 0 0 60px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: 0; padding-left: 30px; margin: 0 0 0 30px;"><span class="f_Normal" style="display:inline-block;width:30px;margin-left:-30px">5.</span>The break key is enabled. By running the MASTER.LOGIN and LOGIN paragraphs with the break key disabled, the user cannot quit out of any security checking done in these paragraphs. If a LOGIN paragraph is used to start the application, it may be necessary to enable the break key at this stage by including a <span style="font-weight: bold;"><a href="break.htm" class="topiclink">BREAKÂ ON</a></span> command.</p><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Step 4 above is also executed when the <span style="font-weight: bold;"><a href="logto.htm" class="topiclink">LOGTO</a></span> command is used to move to a new account.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>User specific process initialisation can be performed by testing the content of the <a href="at_variables.htm#logname" class="topiclink">@LOGNAME</a> variable in the MASTER.LOGIN or LOGIN paragraphs. For example,</p>
<p style="margin: 10px 0 10px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">IF @LOGNAME = 'ADMINISTRATOR' THEN ADMIN.STARTUP</span></p>

</td></tr></table>

</body>
</html>
