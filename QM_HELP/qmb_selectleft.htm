<!DOCTYPE html>
<html>
<head>
   <title>SELECTLEFT, SELECTRIGHT</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="SELECTLEFT,SELECTLEFTV,SELECTRIGHT,SELECTRIGHTV" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_selectleft.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">SELECTLEFT, SELECTRIGHT</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_selectinfo.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_send.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SELECTLEFT</span> and <span style="font-weight: bold;">SELECTRIGHT</span> statements create a numbered select list from the entry in an <a href="ak.htm" class="topiclink">alternate key index</a> to the left or right of the last entry processed. The <span style="font-weight: bold;">SELECTLEFTV</span> and <span style="font-weight: bold;">SELECTRIGHTV</span> statements are similar but create a select list variable.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTLEFT</span> <span style="font-style: italic;">index.name</span>  <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> {<span style="font-weight: bold;">SETTING</span> <span style="font-style: italic;">key</span>} {<span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.no</span>}</p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTRIGHT</span> <span style="font-style: italic;">index.name</span>  <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> {<span style="font-weight: bold;">SETTING</span> <span style="font-style: italic;">key</span>} {<span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.no</span>}</p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTLEFTV</span> <span style="font-style: italic;">index.name</span>  <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> {<span style="font-weight: bold;">SETTING</span> <span style="font-style: italic;">key</span>} <span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.var</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTRIGHTV</span> <span style="font-style: italic;">index.name</span>  <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> {<span style="font-weight: bold;">SETTING</span> <span style="font-style: italic;">key</span>} <span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.var</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">index.name</span></td><td style="border:none;padding:0">is the name of the alternate key index to be processed.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">file.var</span></td><td style="border:none;padding:0">is the file variable associated with an open file.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">key</span></td><td style="border:none;padding:0">is the variable to be set to the key value associated with the returned list.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">list.no</span></td><td style="border:none;padding:0">is the select list number of the list to be created. If omitted, select list zero is used.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">list.var</span></td><td style="border:none;padding:0">is the select list variable to be created.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SELECTLEFT</span> and <span style="font-weight: bold;">SELECTRIGHT</span> statements construct a select list from the alternate key index entry to the left or right of the one most recently returned using <span style="font-weight: bold;"><a href="qmb_selectindex.htm" class="topiclink">SELECTINDEX</a></span>, <span style="font-weight: bold;">SELECTLEFT</span> or <span style="font-weight: bold;">SELECTRIGHT</span>. The position of the scan can be set to the extreme left using <span style="font-weight: bold;"><a href="qmb_setleft.htm" class="topiclink">SETLEFT</a></span> or the extreme right using <span style="font-weight: bold;"><a href="qmb_setleft.htm" class="topiclink">SETRIGHT</a></span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>These operations allow a program to find a specific value and then walk through successive values in the sorted data structure that makes up an alternate key index.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If <span style="font-weight: bold;"><a href="qmb_selectindex.htm" class="topiclink">SELECTINDEX</a></span> is used to locate a value that does not exist in the index, <span style="font-weight: bold;">SELECTLEFT</span> will return a list of records for the value immediately before the non-existent one and <span style="font-weight: bold;">SELECTRIGHT</span> will return a list of records for the value immediately after the non-existent one.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function returns zero if the operation is successful, non-zero if it fails. Although other errors may occur, two useful status values are</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; width:77px; padding:0; border:none"><p style="margin: 5px 0 0 0;">3019</p>
</td>
<td style="vertical-align:top; width:130px; padding:0; border:none"><p style="margin: 5px 0 0 0;">ER$AKNF</p>
</td>
<td style="vertical-align:top; width:622px; padding:0; border:none"><p style="margin: 5px 0 0 0;">Specified index does not exist</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:77px; padding:0; border:none"><p style="margin: 5px 0 0 0;">3030</p>
</td>
<td style="vertical-align:top; width:130px; padding:0; border:none"><p style="margin: 5px 0 0 0;">ER$EOF</p>
</td>
<td style="vertical-align:top; width:622px; padding:0; border:none"><p style="margin: 5px 0 0 0;">No further items at end of index</p>
</td>
</tr>
</table>
</div>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="at_variables.htm#selected" class="topiclink">@SELECTED</a> </span>variable is set to the number of entries in the returned list, or zero if there are no further index entries to be returned.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of these statements inside a transaction will not reflect any uncommitted updates to the file.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>See the <span style="font-weight: bold;"><a href="qmb_selectindex.htm" class="topiclink">SELECTINDEX</a></span> statement for an example that describes how an index is sorted.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">KEY = 'M'</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">SELECTINDEX 'POSTCODE', KEY FROM CLIENTS.FILE</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">LOOP</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; LOOP</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;READNEXT CLIENT.NO ELSE EXIT</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;CRT CLIENT.NO</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; REPEAT</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; SELECTRIGHT 'POSTCODE' FROM CLIENTS.FILE SETTING POSTCODE</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">WHILE @SELECTED</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">WHILE POSTCODE[1,LEN(KEY)] = KEY </span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">REPEAT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program displays a list of all clients with postcodes beginning with M.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SELECTINDEX</span> looks for an index entry for a postcode of &quot;M&quot;. This is unlikely to exist and hence the select list will probably be empty. If it did find any records, the inner loop would display these. Having processed this initial list, the <span style="font-weight: bold;">SELECTRIGHT</span> moves one step right (i.e. in ascending order) through the index tree and builds a list of these records. The POSTCODE variable is returned as the value of the indexed item located. Processing continues until the <span style="font-weight: bold;">SELECTRIGHT</span> finds an item that does not begin with the characters in KEY.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">SELECTINDEX 'TIME', TIMESTAMP FROM LOG.F TO 1</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">IF @SELECTED = 0 THEN</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; SELECTLEFT 'TIME' FROM LOG.F TO 1</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">END IF</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above program fragment finds the record in the file open as LOG.F with the TIME field equal to TIMESTAMP. If there is no such record it finds the record with the nearest time before the requested timestamp. If multiple records have the same timestamp value, select list 1 will contain all of their ids. If TIME was the id of records in the log file, the select list could never contain multiple values. </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">See <a href="ak.htm" class="topiclink">Alternate Key Indices</a> for an example of how to perform partial key matching as a user enters characters of an item to be located via the index.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_selectindex.htm" class="topiclink">SELECTINDEX</a>, <a href="qmb_setleft.htm" class="topiclink">SETLEFT</a>, <a href="qmb_setleft.htm" class="topiclink">SETRIGHT</a></span></p>

</td></tr></table>

</body>
</html>
