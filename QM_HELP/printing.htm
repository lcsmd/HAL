<!DOCTYPE html>
<html>
<head>
   <title>Printing</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="Printing" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "printing.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">Printing</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="patterns.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="dates_times_and_epoch_values.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QM applications do not drive printing devices directly. Instead they reference numbered <span style="font-weight: bold;">print units</span> with no knowledge of where the output will actually go. This leads to a very flexible printing system where the output can be sent to a printer, a file or the user's screen. QM uses the underlying Print Manager on Windows or the operating system spooler on other platforms to perform output to printer devices.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Each QM session has its own pool of print units, numbered from 0 to 255. In most cases, if a print unit is not specified in a command, printer 0, the default printer, is used. Application developers are free to use these print units in any way that meets their needs. They might correspond to different printers, different paper types on the one printer, selection of portrait or landscape mode, etc. Although it is unlikely, all 256 print units can be used simultaneously.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The QMBasic <span style="font-weight: bold;"><a href="qmb_print.htm" class="topiclink">PRINT</a></span> statement directs its output to printer 0 unless the ON clause is used to specify some other printer:</p>
<p style="margin: 6px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">PRINT ON 4 &quot;Invoice Summary&quot;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Within QMBasic programs printer 0 is treated as a special case. If the program has not used the <span style="font-weight: bold;"><a href="qmb_printer.htm" class="topiclink">PRINTER ON</a></span> statement (or the LPTR qualifier to the <span style="font-weight: bold;"><a href="run.htm" class="topiclink">RUN</a></span> command), output to printer 0 is actually sent to the user's screen rather than the printer. This allows an application to use either the screen or the default printer simply by choosing whether to execute the <span style="font-weight: bold;"><a href="qmb_printer.htm" class="topiclink">PRINTER ON</a></span> statement rather than having to implement two alternative paths for every place that performs output.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QMBasic programs can also reference print unit -1 as a synonym for the user's screen.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Two Printing Models</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">There are two related methods by which the physical destination of printed output can be set. For compatibility with Information style multivalue products, QM supports the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command to set the characteristics of a print unit, including its destination.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Alternatively, for compatibility with Pick style products, a set of printer characteristics can be associated with a numbered <span style="font-weight: bold;">form queue</span> by use of the <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span> command which saves the characteristics in the file system for future reference by the <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> command.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The fundamental difference between the two approaches is that <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> directly specifies printer characteristics that take immediate effect whereas <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span> defines characteristics that can be set later by referencing the form queue number in an <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> command. Internally, <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> is simply executing a <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command based on the characteristics previously defined using <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span>. The two printing models can be mixed in any way the application designer wishes.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-weight: bold;">Setting Print Unit Characteristics with SETPTR</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Unless otherwise defined, print unit 0 is directed to the system's default printer and all other print units are directed to the $HOLD file. Almost all applications will need to modify this default behaviour by using the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command. This command is frequently executed from the <a href="command_scripts.htm" class="topiclink">MASTER.LOGIN</a> paragraph in the QMSYS account (to affect all users), from the <a href="command_scripts.htm" class="topiclink">LOGIN</a> paragraph of a specific account (to affect only users of that account), or from within the application.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command defines the shape of the printed page (width, depth, margins), the destination and various options relating to the treatment of the output:</p>
<p style="margin: 6px 0 0 30px;">SETPTR<span style="font-weight: bold;"> </span><span style="font-style: italic;">unit</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">width</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">depth</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">top.margin</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">bottom.margin</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">mode</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">options</span> }}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A print unit can operate in several modes:</p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">Mode 1</span> directs the output to the underlying operating system print processor, usually to send it to a physical printer.</p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">Mode 3</span> formats the data ready for printing but directs it to a record in the $HOLD file from where it may subsequently be viewed on the screen with a suitable editor or sent on to a printer when required. The hold file is most commonly used to defer printing until a process has completed, to gather diagnostic output, or for testing. The name of the file used by mode 3 can be set using the AS option of the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command which includes the ability to add a rotating sequence number for generate a different name for each output job. This sequence number can be determined using the QMBasic <span style="font-weight: bold;"><a href="qmb_getpu.htm" class="topiclink">GETPU()</a></span> function or the <a href="at_variables.htm#seqno" class="topiclink">@SEQNO</a> variable.</p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">Mode 4</span> directs the output to the stdout (standard output) file unit.</p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">Mode 5</span> buffers the data in the $HOLD file and then sends it to the terminal when the printer is closed, prefixing it with the control code to enable the terminal auxiliary printer port and disabling this port on completion of the print. This feature relies on the mc5 (aux on) and mc4 (aux off) <a href="terminfo.htm" class="topiclink">terminfo</a> items being set correctly.</p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">Mode 6</span> combines the actions of modes 1 and 3, creating a file and also printing the data.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A print job commences when the first line of output is sent to the printer and normally terminates when the program closes the print unit either explicitly or implicitly by returning to the command processor. It is possible to merge output from several successive print programs into one job by use of the <span style="font-weight: bold;"><a href="printer.htm" class="topiclink">PRINTER</a></span> command. The <span style="font-weight: bold;">KEEP.OPEN</span> option used before output commences followed by the <span style="font-weight: bold;">CLOSE</span> option after the final program completes treats the entire sequence as a single print job.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Pick Style Form Queues</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Although Pick style systems support the ON clause of the Basic <span style="font-weight: bold;"><a href="qmb_print.htm" class="topiclink">PRINT</a></span> statement, applications that need only one printer at a time more usually determine the output destination by selecting a numbered <span style="font-weight: bold;">form queue</span>. As an aid to migration, QM provides limited support for Pick style form queues by use of the <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> command. Internally, QM needs to relate form queue numbers to the equivalent <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> options and this is managed by a mapping file, $FORMS, using the <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span> command.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span> command is very similar to <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> but instead of assigning the specified characteristics to a numbered print unit, they are stored in the $FORMS file with a numeric id that corresponds to the form queue number. Subsequent use of the <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> command picks up the form queue details from the $FORMS file and applies these to printer 0 by internal use of <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span>. The R option of <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> allows the form characteristics to be applied to a different print unit.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Whereas each QM process has its own set of 256 numbered print units, form queue numbers and their settings are normally shared across all QM sessions because the same $FORMS file is visible to all accounts. By creating alternative $FORMS files and modifying the VOC F-pointer, it is possible to maintain separate form definitions for specific accounts or groups of accounts.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>For more information, see the <span style="font-weight: bold;"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></span> and <span style="font-weight: bold;"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></span> command descriptions.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Printing on Windows</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Windows defines two alternative printing interfaces. The graphical device interface (GDI) allows a Windows application to construct complex text and graphics images whereas the non-GDI mode (known in QM as raw mode) is a much simpler interface that permits only simple text output. QM uses the raw mode by default though, for compatibility with older releases, the <a href="configparams.htm#gdi" class="topiclink">GDI</a> configuration parameter can be used to make GDI the default. QM does not provide any functions to generate GDI graphics. When using GDI mode, the printer's default font can be replaced by a fixed pitch font of a given size by use of the FONT.SIZE option to <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Some options of the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command are applicable only to one or other of the two modes. Also, some options may not be supported by all Windows print drivers. In most cases, inapplicable options are simply ignored.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Printing on Other Platforms</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QM normally uses the underlying lp command to print data on these platforms though this can be modified by use of the <span style="font-weight: bold;"><a href="configparams.htm" class="topiclink">SPOOLER</a></span> configuration parameter or the SPOOLER option of the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command. <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> options that are not applicable are ignored.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of print spoolers other than lp may require QM to use different options to the command to pass the printer name, copy count, etc. To support this, there is an X-type record in the VOC file of the QMSYS account named $SPOOLERS. This has six associated multivalued fields such that:</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 2</td><td style="border:none;padding:0">Spooler name</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 3</td><td style="border:none;padding:0">Option to specify printer name</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 4</td><td style="border:none;padding:0">Option to specify copy count</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 5</td><td style="border:none;padding:0">Option to specify banner text</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 6</td><td style="border:none;padding:0">Option to set spooler options</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 7</td><td style="border:none;padding:0">Option to set landscape mode</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>In each case, the variable data to be inserted into the option is represented by a percent sign (%). The $SPOOLERS record released with QM contains a definition for use of lpr. This has</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 2</td><td style="border:none;padding:0">lpr</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 3</td><td style="border:none;padding:0">-P %</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 4</td><td style="border:none;padding:0">-K %</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 5</td><td style="border:none;padding:0">-T &quot;%&quot;</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 6</td><td style="border:none;padding:0">-Z &quot;%&quot;</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:89px">Field 7</td><td style="border:none;padding:0">-Z &quot;landscape&quot;</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Printing to a File</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command can be used to direct output to a record in the $HOLD file or to any specific pathname on the server system. Hold file entries have a default name of P<span style="font-style: italic;">n</span> where <span style="font-style: italic;">n</span> is the print unit number but this can be modified in <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> to use a different name and/or to add a rolling sequence number to the name.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When a print unit is directed to a file, a check is made to see if there is a catalogued subroutine named HOLD.FILE.LOGGER and, if there is, this is called when the file is opened and again when it is closed. This subroutine can be used, for example, to build a log of hold file entries or to take some action after the file has been closed. The subroutine takes three arguments; the print unit number, a flag indicating if this is an open (1) or a close (0), and the pathname of the file being created.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Print Prefix Files</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The PREFIX option of the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command can be used to specify the pathname of a file containing printer initialisation commands. The content of this file is sent to the printer before the first output from the application. A typical use of a prefix file might be to select a paper tray.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">PCL Printer Support</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The printing system of QM includes features for greater control of PCL printers. These include font selection, basic graphics and enhanced report formats. The PCL features are enabled by including the PCL option in the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command when defining the printer characteristics.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>By default, a PCL printer will print in Courier font at 10 characters per inch and 6 lines per inch. The <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command includes options to specify alternative values for the character and line spacing. The paper size defaults to A4 but can also be amended using <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span>. The LANDSCAPE option will rotate the page through 90 degrees. Default values for the PCL parameters can also be set using a $PCL VOC record. For more details, see the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The query processor also has special support for PCL printers in report generation commands (e.g. <span style="font-weight: bold;"><a href="list.htm" class="topiclink">LIST</a></span>). Page headings, footings and breakpoint values are printed in bold face. The <span style="font-weight: bold;"><a href="boxed.htm" class="topiclink">BOXED</a></span> option draws a box around the page and separates the heading and footing from the text with horizontal lines.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Graphical Overlays</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The OVERLAY option of the <span style="font-weight: bold;"><a href="setptr.htm" class="topiclink">SETPTR</a></span> command can be used to specify the name of a catalogued subroutine that will be called at the start of each page of output and can be used to emit printer specific control codes to draw a graphical overlay on the page. The <span style="font-weight: bold;"><a href="overlay.htm" class="topiclink">OVERLAY</a></span> option of the query processor reporting commands performs the same action but applies only to the report in which it is used.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>In either usage, the catalogued subroutine takes a single argument which is the print unit number. Any control strings output by this subroutine should be emitted using the <span style="font-weight: bold;"><a href="qmb_print.htm" class="topiclink">PRINT</a></span> statement, normally with the trailing carriage return/line feed suppressed. For PCL printers, it is recommended that the standard QMBasic PCL control string functions should be used.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Example</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">subroutine overlay(pu)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">$catalog overlay</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">$include pcl.h</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; s = pcl.save.csr() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;* Save cursor position</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; s := pcl.box(0,0,2320,3300,2,10) ;* Draw box</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; s := pcl.restore.csr() &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; ;* Restore cursor position</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; s := pcl.left.margin(1) &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;;* Left margin column 1</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; print on pu s :</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; return</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">end</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above subroutine draws a box around an A4 sized page on a PCL printer. Note how it saves the cursor position to ensure that subsequent application output appears at the correct place.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Because the subroutine is called before any other output to the page, it is possible for the subroutine to make other changes to the page settings. Note in the above example how the left margin is indented to bring the application output away from the left edge of the box.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="page-break-inside: avoid;"><span style="font-weight: bold;">Commands Relating to Printing</span></p>
<p style="page-break-inside: avoid;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; page-break-inside: avoid; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="clean_account.htm" class="topiclink">CLEAN.ACCOUNT</a></td><td style="border:none;padding:0">Clears $HOLD and other system temporary files.</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="printer.htm" class="topiclink">PRINTER</a></td><td style="border:none;padding:0">Various printer control operations</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="set_queue.htm" class="topiclink">SET.QUEUE</a></td><td style="border:none;padding:0">Define a form queue</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="setptr.htm" class="topiclink">SETPTR</a></td><td style="border:none;padding:0">Display or set print unit characteristics</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="sp_assign.htm" class="topiclink">SP.ASSIGN</a></td><td style="border:none;padding:0">Set printer parameters using form queue emulation</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="spool.htm" class="topiclink">SPOOL</a></td><td style="border:none;padding:0">Sends record(s) to the printer</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Query Processor Keywords Relating to Printing</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="footing.htm" class="topiclink">FOOTING</a></td><td style="border:none;padding:0">Set page footing</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="heading.htm" class="topiclink">HEADING</a></td><td style="border:none;padding:0">Set page heading</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="lptr.htm" class="topiclink">LPTR</a></td><td style="border:none;padding:0">Direct output to a printer (applies to many commands)</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">QMBasic Statements and Functions Relating to Printing</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_footing.htm" class="topiclink">FOOTING</a></td><td style="border:none;padding:0">Set page footing</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_heading.htm" class="topiclink">HEADING</a></td><td style="border:none;padding:0">Set page heading</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_getpu.htm" class="topiclink">GETPU()</a></td><td style="border:none;padding:0">Retrieve print unit characteristics</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_page.htm" class="topiclink">PAGE</a></td><td style="border:none;padding:0">Force a new page</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_print.htm" class="topiclink">PRINT</a></td><td style="border:none;padding:0">Emit data to a print unit</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer.htm" class="topiclink">PRINTER CLOSE</a></td><td style="border:none;padding:0">Close a print unit</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer.htm" class="topiclink">PRINTER OFF</a></td><td style="border:none;padding:0">Direct print unit 0 to the screen</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer.htm" class="topiclink">PRINTER ON</a></td><td style="border:none;padding:0">Direct print unit 0 to the printer</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer_reset.htm" class="topiclink">PRINTER RESET</a></td><td style="border:none;padding:0">Resets the default print unit</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer_display.htm" class="topiclink">PRINTER DISPLAY</a></td><td style="border:none;padding:0">Direct printer output to the screen</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer_file.htm" class="topiclink">PRINTER FILE</a></td><td style="border:none;padding:0">Direct printer output to a file</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_printer_name.htm" class="topiclink">PRINTER NAME</a></td><td style="border:none;padding:0">Direct printer output to a named printer</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px"><a href="qmb_setpu.htm" class="topiclink">SETPU</a></td><td style="border:none;padding:0">Set print unit characteristics</td></tr></table></div>
</td></tr></table>

</body>
</html>
