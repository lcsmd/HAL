<!DOCTYPE html>
<html>
<head>
   <title>Sorting</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="Sorting" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "sorting.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">Sorting</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="character_encodings.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="simple_web_services.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QM provides sorting options in the query processor and in the QMBasic programming language.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">There are four styles of sorting available:</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px">Left aligned</td><td style="border:none;padding:0">A simple left justified comparison, examining corresponding characters from the start of each string until either a difference is found or the end of both strings has been reached.</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px">Right aligned</td><td style="border:none;padding:0">A simple right justified comparison in which the shorter item is effectively padded with leading spaces and the resultant strings are compared character by character from the start until either a difference is found or the end of both strings has been reached. If both strings can be treated as integer values, possibly with a leading sign character, a numeric comparison is performed.</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px">Right aligned float</td><td style="border:none;padding:0">The same as the right aligned sort above except that the test for numeric items allows non-integer values.</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:180px">Compound</td><td style="border:none;padding:0">A compound sort in which the two strings are considered to be formed from a series of alternating integer numeric and non-numeric elements. Numeric elements are sorted into numerical value, non-numeric elements are sorted into collating sequence order. If the first element is numeric, it may have an optional leading sign character. Sign characters appearing later in the strings are treated as being non-numeric characters. Compound sorts are implemented inconsistently across different multivalue database products, particularly with regard to the relative placement of items such as &quot;0&quot; and &quot;+0&quot;. In most situations, these differences are irrelevant.</td></tr></table></div><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_BoldSubheading"><span class="f_BoldSubheading">Sorting in the Query Processor</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The query processor provides four sort clause options; <span style="font-weight: bold;"><a href="by.htm" class="topiclink">BY</a></span>, <span style="font-weight: bold;"><a href="by_dsnd.htm" class="topiclink">BY.DSND</a></span>, <span style="font-weight: bold;"><a href="by_exp.htm" class="topiclink">BY.EXP</a></span> and <span style="font-weight: bold;"><a href="by_exp_dsnd.htm" class="topiclink">BY.EXP.DSND</a></span>. The first two sort simple data into ascending or descending order respectively. The second two work on exploded data from multivalued data items. The sort operation will be performed in left aligned style unless the field being sorted is defined as right aligned in which case a compound sort is used.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_BoldSubheading"><span class="f_BoldSubheading">Sorting in Alternate Key Indices</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Alternate key indices sort the indexed values using a compound sort. Within any index entry, record ids are sorted using either left or right aligned sort mode depending on the justification specified in the dictionary.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_BoldSubheading"><span class="f_BoldSubheading">Sorting in QMBasic</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QMBasic provides two methods of sorting. The <span style="font-weight: bold;"><a href="qmbs_sort.htm" class="topiclink">!SORT()</a></span> subroutine sorts the items in a dynamic array based on a sort style and other options specified using a sort rule parameter. This also allows removal of duplicate items, case insensitivity, choice of ascending or descending sequence and omission of null items.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The second sort method uses the concept of a sort session in which a sort is initialised using the <span style="font-weight: bold;"><a href="qmb_sort.htm" class="topiclink">SORT()</a></span> function which allows up to 32 keys for nested sorting criteria plus an optional data element. Items are added to the sort using the <span style="font-weight: bold;"><a href="qmb_sortadd.htm" class="topiclink">SORTADD</a></span> statement. Once all the data has been added, items may be extracted individually with the <span style="font-weight: bold;"><a href="qmb_sortnext.htm" class="topiclink">SORTNEXT()</a></span> function or as a field mark delimited dynamic array using the <span style="font-weight: bold;"><a href="qmb_sortdata.htm" class="topiclink">SORTDATA()</a></span> function.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">It is valid for a single QM process to have multiple sorts active simultaneously though this can lead to high memory and disk space usage. It is recommended that sort sessions that are no longer required are terminated using <span style="font-weight: bold;"><a href="qmb_sortclear.htm" class="topiclink">SORTCLEAR</a></span>. A sort session is automatically terminated if the sort variable returned by <span style="font-weight: bold;"><a href="qmb_sort.htm" class="topiclink">SORT()</a></span> is overwritten or discarded.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_BoldSubheading"><span class="f_BoldSubheading">Collating Sequence</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The default behaviour of QM is that the collating sequence is simply the numeric value of each character. This does not allow, for example, the French Ã© (character 233) to appear next to its unaccented equivalent. Application developers can use the <span style="font-weight: bold;"><a href="edit_map.htm" class="topiclink">EDIT.MAP</a></span> command to modify or replace the character map to specify alternative collating sequence rules. It is valid for different users of the same application to have different maps and hence see sorted data in a different order. Character maps for common languages can be downloaded from the openqm.com web site.</p>
<p class="p_Normal">&nbsp;</p>

</td></tr></table>

</body>
</html>
