<!DOCTYPE html>
<html>
<head>
   <title>CSV</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="CSV,TO (redirect delimited report)" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "csv.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">CSV</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="col_sup.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="cumulative.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CSV</span> display option keyword specifies that the report should be produced in CSV format.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">CSV </span>{<span style="font-style: italic;">mode</span>} {<span style="font-weight: bold;">&quot;</span><span style="font-style: italic;">delimiter</span><span style="font-weight: bold;">&quot;</span>} {<span style="font-weight: bold;">TO </span><span style="font-style: italic;">pathname</span> | <span style="font-weight: bold;">AS</span> <span style="font-style: italic;">file id</span> {<span style="font-weight: bold;">NO.QUERY</span> | <span style="font-weight: bold;">APPENDING</span>}} {<span style="font-weight: bold;">ENCODING</span> <span style="font-style: italic;">name</span>}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">mode</span></td><td style="border:none;padding:0">is a numeric value specifying the format rules to be applied.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">delimiter</span></td><td style="border:none;padding:0">is an alternative delimiting character. This may not be a double quote.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">pathname</span></td><td style="border:none;padding:0">is the pathname of the file to receive the output.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">file &nbsp;id</span></td><td style="border:none;padding:0">is a filename and record id pair identifying the destination for the output.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of an encoding to be applied.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CSV</span> keyword produces a report in CSV (comma separated variable) format as used by many software products. In this format, each item in the report is separated by a comma instead of the usual tabular style of report. QM extends this format by allowing use of an alternative <span style="font-style: italic;">delimiter</span> character.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">mode</span> option specifies the format rules to be applied. A <span style="font-style: italic;">mode</span> value of 1 (the default if no <span style="font-style: italic;">mode</span> is given) produces output that conforms to the CSV format specification (RFC 4180). This requires that items containing double quotes or the delimiter character are enclosed in double quotes with embedded double quotes replaced by two adjacent double quotes. </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A <span style="font-style: italic;">mode</span> value of 2 encloses all non-null values in double quotes except for numeric items that do not contain a comma. Embedded double quotes are replaced by two adjacent double quotes.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A <span style="font-style: italic;">mode</span> value of 3 encloses all values in double quotes. Embedded double quotes are replaced by two adjacent double quotes.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-style: italic;">delimiter</span> may be set to a tab character by use of the special syntax &quot;&lt;TAB&gt;&quot;. Other non-printing characters can be specified by use of the ^<span style="font-style: italic;">nnn</span> notation where <span style="font-style: italic;">nnn</span> is the three digit character number from the ASCII character set.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Multivalued items will be split over multiple lines of CSV output. If an item is defined as single valued in the dictionary (or by use of the <span style="font-weight: bold;"><a href="single_value.htm" class="topiclink">SINGLE.VALUE</a></span> keyword) but the corresponding data contains value marks, the marks are treated as normal data characters and the entire multivalued item, including the embedded value marks, will be output as a single element of the CSV output.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">TO</span> option directs output to an operating system file by pathname. The <span style="font-weight: bold;">AS</span> option directs output to a named record in a QM directory file. If the destination item already exists, the user will be prompted to confirm whether it should be overwritten. The <span style="font-weight: bold;">NO.QUERY</span> option suppresses this prompt, overwriting the existing file. The <span style="font-weight: bold;">APPENDING</span> option causes the output to be appended to the output file if it already exists. The <span style="font-weight: bold;">NO.QUERY</span> and <span style="font-weight: bold;">APPENDING</span> options may not be used together. The optional <span style="font-weight: bold;">ENCODING</span> qualifier can be used to set or override the character encoding for the destination file.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of <span style="font-weight: bold;">TO</span> or <span style="font-weight: bold;">AS</span> implies use of <span style="font-weight: bold;"><a href="hdr_sup.htm" class="topiclink">HDR.SUP</a></span> as the output is not paginated.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>In normal usage, the page heading and record counts would probably need to be suppressed using the <span style="font-weight: bold;"><a href="hdr_sup.htm" class="topiclink">HDR.SUP</a></span> and  <span style="font-weight: bold;"><a href="count_sup.htm" class="topiclink">COUNT.SUP</a></span> keywords. The <span style="font-weight: bold;"><a href="col_sup.htm" class="topiclink">COL.SUP</a></span> keyword can be used to suppress column headings.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The command</p>
<p style="margin: 10px 0 10px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST CUSTOMERS NAME TEL HDR.SUP COL.SUP COUNT.SUP CSV</span></p>
<p>would produce a display such as that below.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">17463,Arkright Tool Hire,01726-48745</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">56221,&quot;Smith,Price and Samuel&quot;, 01876-28414</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Note how the customer name in the second line has been quoted because it contains a comma.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST STOCK PROD.NO QOH DESCR CSV TO C:\STOCK.CSV</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This command constructs comma separated format report of the STOCK file into the C:\STOCK.CSV file.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST STOCK PROD.NO QOH DESCR CSV AS $HOLD STK.RPT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This command constructs comma separated format report of the STOCK file in a record named SRK.RPT in the $HOLD file.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A command such as</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">LIST SALES ITEM.NO CSV</span></p>
<p>where ITEM.NO is multivalued might produce a report containing</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">26832,176</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">,218</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">,398</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Modifying the command to be</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">LIST SALES ITEM.NO SINGLE.VALUE CSV</span></p>
<p>would change the output to be</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">16832,176</span><span class="f_CodeSingleLine" style="font-size: 6pt; font-family: 'Times New Roman',Times,Georgia,serif;">VM</span><span class="f_CodeSingleLine">218</span><span class="f_CodeSingleLine" style="font-size: 6pt; font-family: 'Times New Roman',Times,Georgia,serif;">VM</span><span class="f_CodeSingleLine">398</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>See also: <span style="font-weight: bold;"><a href="delimiter.htm" class="topiclink">DELIMITER</a></span></p>

</td></tr></table>

</body>
</html>
