<!DOCTYPE html>
<html>
<head>
   <title>SELECTINDEX, SELECTINDEXV</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="SELECTINDEX,SELECTINDEXV" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_selectindex.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">SELECTINDEX, SELECTINDEXV</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_selecte.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_selectinfo.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SELECTINDEX</span> statement creates a numbered select list from an  <a href="ak.htm" class="topiclink">alternate key index</a> entry. The <span style="font-weight: bold;">SELECTINDEXV</span> statement is similar but creates a select list variable.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTINDEX</span> <span style="font-style: italic;">index.name</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">value</span>} <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> {<span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.no</span>}</p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SELECTINDEXV</span> <span style="font-style: italic;">index.name</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">value</span>} <span style="font-weight: bold;">FROM</span> <span style="font-style: italic;">file.var</span> <span style="font-weight: bold;">TO</span> <span style="font-style: italic;">list.var</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">index.name</span></td><td style="border:none;padding:0">is the name of the alternate key index to be processed.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">value</span></td><td style="border:none;padding:0">is the value to be located in the index.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">file.var</span></td><td style="border:none;padding:0">is the file variable associated with an open file.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">list.no</span></td><td style="border:none;padding:0">is the select list number of the list to be created. If omitted, select list zero is used.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">list.var</span></td><td style="border:none;padding:0">is the select list variable to be created.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the <span style="font-style: italic;">value</span> is omitted, the <span style="font-weight: bold;">SELECTINDEX</span> statement constructs a select list containing all the values of the index identified by <span style="font-style: italic;">index.name</span>. If the <span style="font-style: italic;">value</span> is included, the <span style="font-weight: bold;">SELECTINDEX</span> statement constructs a select list containing keys of records for which the index identified by <span style="font-style: italic;">index.name</span> has the given <span style="font-style: italic;">value</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Thus, in a file of orders with an index on the customer number field, the first form would return a list of customers referenced by the orders file and the second form would return a list of orders for a specific customer.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function returns zero if the <span style="font-weight: bold;">SELECTINDEX</span> is successful, non-zero if it fails because the index does not exist. Selecting records for a <span style="font-style: italic;">value</span> that is not present in the index will return an empty list.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="at_variables.htm#selected" class="topiclink">@SELECTED</a> </span>variable is set to the number of entries in the returned list.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SELECTINDEX</span> operation leaves the internal index pointer used by the <span style="font-weight: bold;"><a href="qmb_selectleft.htm" class="topiclink">SELECTLEFT</a></span> and <span style="font-weight: bold;"><a href="qmb_selectleft.htm" class="topiclink">SELECTRIGHT</a></span> statements positioned at the item that has been located or, if not found, at the position where such an item would go.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of this statement inside a transaction will not reflect any uncommitted updates to the file.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>To understand the order in which items are returned by <span style="font-weight: bold;">SELECTINDEX</span>, consider an orders file keyed by order number for which there is an index on a field that contains the customer number. The index will have an entry for each customer who has placed an order and each of these entries will hold a list of the order numbers for that customer. The order of the indexed values (customer numbers, left column in the diagram below) will be sorted left or right aligned according to the format code in the dictionary entry for the customer number field. The order numbers stored for each customer (a single line from the right column in the diagram below) will be sorted according to the format code in the dictionary entry for the @ID item in the customers file. In this example, both items are likely to be defined as right aligned and hence sorted into ascending order.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><img alt="index" width="428" height="257" style="margin:0;width:428px;height:257px;border:none" src="index_zoom86.png"/></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">SELECTINDEX 'CUST.NO' FROM ORDERS.FILE TO 7</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">LOOP</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; READNEXT CUST.NO FROM 7 ELSE EXIT</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; CRT CUST.NO</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; SELECTINDEX 'CUST.NO', CUST.NO FROM ORDERS.FILE</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; LOOP</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;READNEXT ORDER.NO ELSE EXIT</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;CRT ORDER.NO</span><br />
<span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; REPEAT</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">REPEAT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program builds a select list of all the customers referenced by the orders file as list 7. The inner loop then constructs a list of the order numbers for each customer in turn.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_setleft.htm" class="topiclink">SETLEFT</a></span>, <span style="font-weight: bold;"><a href="qmb_setleft.htm" class="topiclink">SETRIGHT</a></span>, <span style="font-weight: bold;"><a href="qmb_selectleft.htm" class="topiclink">SELECTLEFT</a></span>, <span style="font-weight: bold;"><a href="qmb_selectleft.htm" class="topiclink">SELECTRIGHT</a></span></p>

</td></tr></table>

</body>
</html>
