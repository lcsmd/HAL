<!DOCTYPE html>
<html>
<head>
   <title>DPARSE and DPARSE.CSV</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DPARSE,DPARSE.CSV" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_dparse.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">DPARSE, DPARSE.CSV</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_downcase.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_dtx.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DPARSE</span> statement splits the elements of a delimited string into other variables. <span style="font-weight: bold;">DPARSE.CSV</span> is similar but unquotes strings according to the rules in the CSV standard.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">DPARSE </span><span style="font-style: italic;">string</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">delimiter</span><span style="font-weight: bold;">,</span><span style="font-style: italic;"> var1</span><span style="font-weight: bold;">,</span><span style="font-style: italic;"> var2</span><span style="font-weight: bold;">,</span>...</p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">DPARSE.CSV </span><span style="font-style: italic;">string</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">delimiter</span><span style="font-weight: bold;">,</span><span style="font-style: italic;"> var1</span><span style="font-weight: bold;">,</span><span style="font-style: italic;"> var2</span><span style="font-weight: bold;">,</span>...</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">string</span></td><td style="border:none;padding:0">evaluates to the string to be processed.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">delimiter</span></td><td style="border:none;padding:0">evaluates to the substring delimiter. If this is more than one character, only the first character is used.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">var1,var2,...</span></td><td style="border:none;padding:0">is a list of variables to receive the elements extracted from <span style="font-style: italic;">string</span>. These may be simple variables, matrix elements or field, value or subvalue references. If <span style="font-style: italic;">string</span> has more elements than the number of variables, the excess is lost. If it has fewer elements than the number of variables, the trailing unused ones are set to null strings.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DPARSE</span> statement extracts successive elements delimited by <span style="font-style: italic;">delimiter</span> within <span style="font-style: italic;">string</span> into the listed variables. A statement such as</p>
<p style="margin: 10px 0 10px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DPARSE S, &quot;,&quot;, A, B, C</span></p>
<p>is equivalent to</p>
<p style="margin: 10px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">A = FIELD(S, &quot;,&quot;, 1)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">B = FIELD(S, &quot;,&quot;, 2)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">C = FIELD(S, &quot;,&quot;, 3)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">DPARSE.CSV</span> extends this action by removing quotes that have been applied to meet the CSV standard. CSV format allows optional double quotes around items and specifies that these must be present when the item contains the delimiting character or a double quote. In the latter case, the embedded double quote will be represented by two adjacent double quotes.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LOOP</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; READSEQ LINE FROM SEQ.F ELSE EXIT</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; STOCK.REC = &quot;&quot;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; DPARSE LINE, &quot;,&quot;, PART.NO, STOCK.REC&lt;1&gt;, STOCK.REC&lt;2&gt;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; ...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">Processing</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">REPEAT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This loop dismantles a comma separated string to extract three elements.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">S = 'abc,&quot;de&quot;&quot;f&quot;'</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DPARSE S, ',', A, B</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DISPLAY A,B</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DPARSE.CSV S, ',', A, B</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DISPLAY A,B</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program will print</p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">abc &nbsp; &nbsp; &nbsp; &quot;de&quot;&quot;f&quot;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">abc &nbsp; &nbsp; &nbsp; de&quot;f</span></p>
<p>showing the difference between the <span style="font-weight: bold;">DPARSE</span> and <span style="font-weight: bold;">DPARSE.CSV</span> statements.</p>

</td></tr></table>

</body>
</html>
