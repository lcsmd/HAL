<!DOCTYPE html>
<html>
<head>
   <title>Matrix File I/O</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="Matrix file i/o" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "matrix_file_io.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">Matrix File I/O</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="file_processing.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="sequential_file_io.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QMBasic has two styles of file i/o that may be freely mixed within an application. Using <span style="font-weight: bold;"><a href="qmb_read.htm" class="topiclink">READ</a></span> and <span style="font-weight: bold;"><a href="qmb_write.htm" class="topiclink">WRITE</a></span> to transfer data using dynamic arrays is simpler and usually faster for programs that do little processing of the data or work with records that have few fields. For programs that perform a significant amount of processing of the data in records that have many fields, it may be worth the cost of breaking the fields into separate elements of a dimensioned matrix using <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span> and <span style="font-weight: bold;"><a href="qmb_matwrite.htm" class="topiclink">MATWRITE</a></span>.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">These statement have the same locking variants as their dynamic array counterparts. They also share an almost identical syntax where the prefix MAT is used to select the matrix version of the operation and the variable representing the database record must be a dimensioned array. For example, the dynamic array read:</p>
<p class="p_Normal" style="margin: 6px 0 6px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">READ </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">var</span><span style="font-family: 'Courier New',Courier,monospace;"> FROM </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">filevar</span><span style="font-family: 'Courier New',Courier,monospace;">, </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">id</span></p>
<p class="p_Normal">becomes</p>
<p class="p_Normal" style="margin: 6px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">MATREAD </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">array </span><span style="font-family: 'Courier New',Courier,monospace;">FROM </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">filevar</span><span style="font-family: 'Courier New',Courier,monospace;">, </span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">id</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span> statement places each field of the record into a separate element of the array, keeping values and subvalues together as these are instances of the same data item.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">For example, if a record has three fields, the second of which is multivalued:</p>
<p class="p_Normal" style="margin: 6px 0 6px 30px;">A<span style="font-size: 6pt;">FM</span>B1<span style="font-size: 6pt;">VM</span>B2<span style="font-size: 6pt;">FM</span>C</p>
<p class="p_Normal">using <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span> to read this into a three element (plus the zero element) matrix would result in:</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">0</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><br />
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">1</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">A</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">2</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">B1<span style="font-size: 6pt;">VM</span>B2</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">3</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">C</p>
</td>
</tr>
</table>
</div>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;"><a href="qmb_matwrite.htm" class="topiclink">MATWRITE</a></span> operation joins together each element of the matrix, inserting field marks between them and writes this to the file.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the matrix has more elements than there are fields in the record, the excess elements are set to null strings:</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">0</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><br />
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">1</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">A</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">2</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">B1<span style="font-size: 6pt;">VM</span>B2</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">3</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">C</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">4</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><br />
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">5</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><br />
</td>
</tr>
</table>
</div>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;"><a href="qmb_inmat.htm" class="topiclink">INMAT()</a></span> function can be used after a <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span> to determine how many elements of the matrix were used. The <span style="font-weight: bold;"><a href="qmb_matwrite.htm" class="topiclink">MATWRITE</a></span> operation ignores all trailing empty fields so that above situation would not write two empty fields at the end of the record.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the matrix has fewer elements than there are fields in the record, the zero element is used to store the excess data. Consider the a record with five fields and a matrix with three elements:</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">0</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">D<span style="font-size: 6pt;">FM</span>E</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">1</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">A</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">2</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">B1<span style="font-size: 6pt;">VM</span>B2</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">3</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">C</p>
</td>
</tr>
</table>
</div>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;"><a href="qmb_matwrite.htm" class="topiclink">MATWRITE</a></span> operation adds the contents of the zero element to the record formed from the remaining elements of the matrix, reconstructing the correctly formed data. The zero element thus acts as an &quot;overflow bucket&quot; allowing programs that did not expect to find the excess data to function correctly.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Pick style matrices do not have a zero element. In this case, the excess data is stored in the final element of the matrix:</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none; border-spacing:0; border-collapse:collapse;">
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">1</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">A</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">2</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">B1<span style="font-size: 6pt;">VM</span>B2</p>
</td>
</tr>
<tr>
<td style="vertical-align:top; width:47px; padding:3px; border:solid thin #000000;"><p class="p_Normal">3</p>
</td>
<td style="vertical-align:top; width:160px; padding:3px; border:solid thin #000000;"><p class="p_Normal">C<span style="font-size: 6pt;">FM</span>D<span style="font-size: 6pt;">FM</span>E</p>
</td>
</tr>
</table>
</div>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">This is likely to cause the program to malfunction if it updates element 3 where it expected only to find the third field of the database record. To avoid this, Pick style programmers usually ensure that the matrix has at least one more element than they expect it to need, effectively moving the &quot;overflow bucket&quot; to the end of the matrix.</p>

</td></tr></table>

</body>
</html>
