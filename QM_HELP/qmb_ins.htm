<!DOCTYPE html>
<html>
<head>
   <title>INS</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="INS,INSERT()" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_ins.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">INS, INSERT()</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_inputtrap.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_int.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">INS</span> statement and <span style="font-weight: bold;">INSERT()</span> function insert a field, value or subvalue into a dynamic array. Used with a data collection, the <span style="font-weight: bold;">INS</span> statement inserts a name/value pair.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 10px 30px;"><span style="font-weight: bold;">INS </span><span style="font-style: italic;">string</span> <span style="font-weight: bold;">BEFORE</span> <span style="font-style: italic;">dyn.array</span><span style="font-weight: bold;">&lt;</span><span style="font-style: italic;">field</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">value </span>{<span style="font-style: italic; font-weight: bold;">,</span> <span style="font-style: italic;">subvalue</span>}}<span style="font-weight: bold;">&gt;</span></p>
<p style="margin: 0 0 10px 30px;"><span style="font-weight: bold;">INSERT(</span><span style="font-style: italic;">dyn.array</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">field</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">value</span><span style="font-style: italic; font-weight: bold;">,</span> <span style="font-style: italic;">subvalue</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">string</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 0 0 10px 30px;"><span style="font-weight: bold;">INSERT(</span><span style="font-style: italic;">dyn.array</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">field</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">value </span>{<span style="font-style: italic; font-weight: bold;">,</span> <span style="font-style: italic;">subvalue</span>}} <span style="font-weight: bold;">;</span> <span style="font-style: italic;">string</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">INS</span> <span style="font-style: italic;">item</span> <span style="font-weight: bold;">AS</span> <span style="font-style: italic;">collection</span><span style="font-weight: bold;">{</span><span style="font-style: italic;">path</span><span style="font-weight: bold;">}</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">string</span></td><td style="border:none;padding:0">is the string to be inserted.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">dyn.array</span></td><td style="border:none;padding:0">is the dynamic array into which the item is to be inserted.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">field</span></td><td style="border:none;padding:0">evaluates to the number of the field before which insertion is to occur.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">value</span></td><td style="border:none;padding:0">evaluates to the number of the value before which insertion is to occur. If omitted or zero, value 1 is assumed.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">subvalue</span></td><td style="border:none;padding:0">evaluates to the number of the subvalue before which insertion is to occur. If omitted or zero, subvalue 1 is assumed.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">item</span></td><td style="border:none;padding:0">is a data item value to be inserted into a data collection.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">collection</span></td><td style="border:none;padding:0">is a data collection variable.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">path</span></td><td style="border:none;padding:0">is the element path to be used for the inserted item.</td></tr></table></div><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Dynamic Arrays</span></p>
<p class="p_Normal">&nbsp;</p>
<p>The <span style="font-style: italic;">string</span> is inserted before the specified field, value or subvalue of the dynamic array. The <span style="font-weight: bold;">INS</span> statement assigns the result to the <span style="font-style: italic;">dyn.array</span> variable. The <span style="font-weight: bold;">INSERT()</span> function returns the result without modifying <span style="font-style: italic;">dyn.array</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A negative value of <span style="font-style: italic;">field</span>, <span style="font-style: italic;">value</span> or <span style="font-style: italic;">subvalue</span> causes the next item at this level to be appended. For example,</p>
<p style="margin: 10px 0 10px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">INS X BEFORE S&lt;3, -1&gt;</span></p>
<p>appends X as a new value at the end of field 3 of S. See the description of the <a href="qmbasic_assignmentstatements.htm" class="topiclink">S&lt;f,v,sv&gt; assignment operator</a> for a discussion of how QM appends items.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Additional delimiters will be added to reach the specified field, value and subvalue unless the <span style="font-style: italic;">string</span> to be inserted is null. Absent fields, values and subvalues are assumed to be null so there is no need to insert additional marks in this case.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Setting the COMPATIBLE.APPEND option of the <span style="font-weight: bold;"><a href="qmbd_mode.htm" class="topiclink">$MODE</a></span> compiler directive modifies the behaviour such that a mark character is not inserted if the final element of the portion of the dynamic array to which data is being appended is null.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;<br />
<span style="font-weight: bold;">Data Collections</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;">INS</span> statement inserts the supplied <span style="font-style: italic;">item</span> value into the named data <span style="font-style: italic;">collection</span> at the specified element <span style="font-style: italic;">path</span>. Note that when used in this way, the curly brackets surrounding the <span style="font-style: italic;">path</span> are part of the syntax, not markers for optional items.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the element path corresponds to an array element, the final component of the element path must be numeric and is the array index position at which the <span style="font-style: italic;">item</span> is to be inserted. Any elements at or beyond this position are moved to make space. The index value must not be greater than one more than the existing number of elements in the array.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the element path does not correspond to an array element, the new <span style="font-style: italic;">item</span> is inserted. If the <span style="font-style: italic;">path</span> already exists, the named collection element is replaced.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p>&nbsp;</p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LOCATE PART.NO IN PARTS&lt;1&gt; BY &quot;AL&quot; SETTING I ELSE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; INS PART.NO BEFORE PARTS&lt;I&gt;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment locates PART.NO in a sorted list PARTS and, if it is not already present, inserts it.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_CodeBody"><span class="f_CodeBody">INS CLIENT.NAME AS CLIENT.DATA{'CONTACT.NAME'}</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">This statement inserts or updates the CONTACT.NAME element of the CLIENT.DATA collection.</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><a href="qmbasic_collections.htm" class="topiclink">Data collections</a>, <span style="font-weight: bold;"><a href="qmb_del.htm" class="topiclink">DEL</a></span>, <span style="font-weight: bold;"><a href="qmb_del.htm" class="topiclink">DELETE()</a></span>, <span style="font-weight: bold;"><a href="qmb_extract.htm" class="topiclink">EXTRACT()</a></span>, <span style="font-weight: bold;"><a href="qmb_find.htm" class="topiclink">FIND</a></span>, <span style="font-weight: bold;"><a href="qmb_findstr.htm" class="topiclink">FINDSTR</a></span>, <span style="font-weight: bold;"><a href="qmb_listindex.htm" class="topiclink">LISTINDEX()</a></span>, <span style="font-weight: bold;"><a href="qmb_locate.htm" class="topiclink">LOCATE</a></span>, <span style="font-weight: bold;"><a href="qmb_locate.htm" class="topiclink">LOCATE()</a></span>, <span style="font-weight: bold;"><a href="qmb_replace.htm" class="topiclink">REPLACE()</a></span></p>

</td></tr></table>

</body>
</html>
