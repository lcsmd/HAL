<!DOCTYPE html>
<html>
<head>
   <title>QMSelectIndex()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="QMSelectIndex" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmselectindex.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">QMSelectIndex()</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmselect.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmselectleft.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">QMSelectIndex()</span> function generates a select list from an alternate key index.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The function arguments are:</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">FileNo</span></td><td style="border:none;padding:0">is the file number returned by a previous <span style="font-weight: bold;"><a href="qmopen.htm" class="topiclink">QMOpen()</a></span> call.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">IndexName</span></td><td style="border:none;padding:0">is the name of the alternate key index to be used.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">IndexValue</span></td><td style="border:none;padding:0">is the value to be located in the alternate key index.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">ListNo</span></td><td style="border:none;padding:0">is the select list number (0 to 10). </td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">QMSelectIndex</span> function constructs a list of record ids from an entry in an alternate key index. This list can subsequently be processed using the <span style="font-weight: bold;"><a href="qmreadnext.htm" class="topiclink">QMReadNext()</a></span> function. Select list 0, the default select list, is used automatically by many QM components to control their action and should, therefore, be used with caution. An unwanted or partially processed select list can be cleared using the <span style="font-weight: bold;"><a href="qmclearselect.htm" class="topiclink">QMClearSelect</a></span> function.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The number of items in the select list can be established by using <span style="font-weight: bold;"><a href="qmgetvar.htm" class="topiclink">QMGetVar()</a></span> to retrieve the <a href="at_variables.htm#selected" class="topiclink">@SELECTED</a> variable immediately after the <span style="font-weight: bold;">QMSelectIndex()</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>See the <span style="font-weight: bold;"><a href="qmreadlist.htm" class="topiclink">QMReadList()</a></span> function for a discussion on different ways to process the select list.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The example program fragments below build select list 1 from an index and use it to process records from the file open as fClients.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A1_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A1','TOGGLE0186A1_ICON')">C</a></span></td></tr></table></div><div id="TOGGLE0186A1" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">void QMSelectIndex(int </span><span style="font-style: italic;">FileNo</span><span style="font-weight: bold;">, char * </span><span style="font-style: italic;">IndexName</span><span style="font-weight: bold;">, char * </span><span style="font-style: italic;">IndexValue</span><span style="font-weight: bold;">, int </span><span style="font-style: italic;">ListNo</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">QMSelectIndex(fClients, &quot;REGION&quot;, RegionNo, 1);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">while((Id = QMReadNext(1)) != NULL)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;Rec = QMRead(fClients, Id, Err);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;if (Err == 0)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp;...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">process record</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp;QMFree(Rec);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; } </span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;QMFree(Id);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> }</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Note the use of <span style="font-weight: bold;"><a href="qmfree.htm" class="topiclink">QMFree()</a></span> to release the dynamically allocated memory from some of the functions in this example.</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A2_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A2','TOGGLE0186A2_ICON')">VB.Net</a></span></td></tr></table></div><div id="TOGGLE0186A2" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">QMSelectIndex ByVal </span><span style="font-style: italic;">FileNo</span><span style="font-weight: bold;"> as Integer, ByVal </span><span style="font-style: italic;">IndexName</span> <span style="font-weight: bold;">as String, ByVal </span><span style="font-style: italic;">IndexValue</span><span style="font-weight: bold;"> as String, ByVal </span><span style="font-style: italic;">ListNo</span><span style="font-weight: bold;"> as Integer</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">QMSelectIndex fClients, &quot;REGION&quot;, RegionNo, 1</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">Do</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Id = QMReadNext(1, Err)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; If Err &lt;&gt; 0 Then Exit Do</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Rec = QMRead(fClients, Id, Err)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; If Err = 0 Then</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">process record</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; End If</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">Loop</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A3_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A3','TOGGLE0186A3_ICON')">QMBasic</a> Class Module</span></td></tr></table></div><div id="TOGGLE0186A3" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">SelectIndex(</span><span style="font-style: italic;">FileNo</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">IndexName</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">IndexValue</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">ListNo</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">session-&gt;SelectIndex(fClients, 'REGION', RegionNo, 1))</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">loop</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Id = session-&gt;ReadNext(1)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">until Id = &quot;&quot;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Rec = session-&gt;Read(fClients, Id, Err)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; if Err = 0 then</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">process record</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; end</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">repeat</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A4_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A4','TOGGLE0186A4_ICON')">Java</a></span></td></tr></table></div><div id="TOGGLE0186A4" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">SelectIndex(int </span><span style="font-style: italic;">FileNo</span><span style="font-weight: bold;">, String </span><span style="font-style: italic;">IndexName</span><span style="font-weight: bold;">, String </span><span style="font-style: italic;">IndexValue</span><span style="font-weight: bold;">, int </span><span style="font-style: italic;">ListNo</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">qm.SelectIndex(fClients, &quot;REGION&quot;, RegionNo, 1);</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">qm.Select(fClients, 1);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">while((Id = qm.ReadNext(1)) != NULL)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;Rec = qm.Read(fClients, Id);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;if (qm.ServerError == SV$OK)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp;...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">process record</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; } </span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> }</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A5_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A5','TOGGLE0186A5_ICON')">Python</a></span></td></tr></table></div><div id="TOGGLE0186A5" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">SelectIndex(</span><span style="font-style: italic;">FileNo</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">IndexName</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">IndexValue</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">ListNo</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">qm.SelectIndex(fClients, &quot;REGION&quot;, RegionNo, 1)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">while True:</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Id = qm.ReadNext(1)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; if Id = &quot;&quot;: break</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; Rec, Err = qm.Read(fClients, Id)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; ...</span><span style="font-family: 'Courier New',Courier,monospace; font-style: italic;">process record</span><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
</td>
</tr>
</table>
</div>

</td></tr></table>

<script type="text/javascript">
HMInitToggle('TOGGLE0186A1_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A1\',\'TOGGLE0186A1_ICON\')');
HMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A2_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A2\',\'TOGGLE0186A2_ICON\')');
HMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A3_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A3\',\'TOGGLE0186A3_ICON\')');
HMInitToggle('TOGGLE0186A3','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A4_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A4\',\'TOGGLE0186A4_ICON\')');
HMInitToggle('TOGGLE0186A4','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A5_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A5\',\'TOGGLE0186A5_ICON\')');
HMInitToggle('TOGGLE0186A5','hm.type','dropdown','hm.state','0');
</script>
</body>
</html>
