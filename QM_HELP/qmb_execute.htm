<!DOCTYPE html>
<html>
<head>
   <title>EXECUTE</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="EXECUTE,PERFORM,Silent command execution" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_execute.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">EXECUTE, PERFORM</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_evaluate.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_exit.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">EXECUTE</span> statement enables a QMBasic program to execute any command. The synonym <span style="font-weight: bold;">PERFORM</span> can be used in place of <span style="font-weight: bold;">EXECUTE</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal" style="text-indent: -147px; margin: 0 0 0 178px;"><span style="font-weight: bold;">EXECUTE</span> <span style="font-style: italic;">expr</span> {<span style="font-weight: bold;">TRAPPING ABORTS</span>}</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">CAPTURING</span> <span style="font-style: italic;">var</span>}</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">NO.TTY</span>}</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">PASSLIST</span> {<span style="font-style: italic;">src.list</span> }}</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">RTNLIST</span> <span style="font-style: italic;">tgt.list</span> }</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">SILENT</span>}</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">STACKLIST</span>}</td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:148px"></td><td style="border:none;padding:0">{<span style="font-weight: bold;">SETTING</span> <span style="font-style: italic;">status.var</span>} &nbsp;or &nbsp;{<span style="font-weight: bold;">RETURNING</span> <span style="font-style: italic;">status.var</span>}</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">expr</span></td><td style="border:none;padding:0">evaluates to the command(s) to be executed. Multiple commands are separated by field marks.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">var</span></td><td style="border:none;padding:0">is a variable to receive captured output.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">src.list</span></td><td style="border:none;padding:0">is a select list variable holding a list to be passed into the executed command as list 0.</td></tr></table></div><p><span style="width:48px;display:inline-block">&nbsp;</span> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">tgt.list</span></td><td style="border:none;padding:0">is a variable to receive a returned select list. This variable may be used in a subsequent <span style="font-weight: bold;"><a href="qmb_readnext.htm" class="topiclink">READNEXT</a></span> to extract &nbsp;items from the list.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">status.var</span></td><td style="border:none;padding:0">is a variable to receive the value of <a href="at_variables.htm#system.return.code" class="topiclink">@SYSTEM.RETURN.CODE</a> after the command is executed.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">EXECUTE</span> statement creates a new command level by starting a new version of the command processor and passing it the command line to be executed. On completion of the command, the command processor returns control to the calling program.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The value in <span style="font-style: italic;">expr</span> may contain several commands delimited by field marks. These will be processed as a paragraph and may include <span style="font-weight: bold;"><a href="qmb_data.htm" class="topiclink">DATA</a></span> and <span style="font-weight: bold;"><a href="qmb_loop.htm" class="topiclink">LOOP</a></span> constructs, etc.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>An abort occurring in the command(s) processed by the <span style="font-weight: bold;">EXECUTE</span> statement is normally trapped by the command processor. The <span style="font-weight: bold;">TRAPPING ABORTS</span> qualifier to the <span style="font-weight: bold;">EXECUTE</span> statement causes aborts to return to the program issuing the <span style="font-weight: bold;">EXECUTE</span> without execution of the optional <a href="command_scripts.htm" class="topiclink">ON.ABORT</a> paragraph. The <a href="at_variables.htm#abort.code" class="topiclink">@ABORT.CODE</a> variable may be used to determine whether the command caused an abort to occur. This variable is initially zero and is reset to zero only by the <span style="font-weight: bold;">EXECUTE</span> statement.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CAPTURING</span> clause captures output that would otherwise have gone to the terminal or phantom log file, saving it in the named variable with field marks in place of newlines. Alternatively, all command output can be suppressed by use of the <span style="font-weight: bold;">SILENT</span> clause which is equivalent to using <span style="font-weight: bold;"><a href="hush.htm" class="topiclink">HUSHÂ ON</a></span> before the executed command and restoring the previous hush state afterwards.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">NO.TTY</span> clause suppresses all @() function expansion in the executed command. Used with <span style="font-weight: bold;">CAPTURING</span>, this ensures that no control sequences will appear in the captured data.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">PASSLIST</span> clause passes the list in the <span style="font-style: italic;">src.list</span> select list variable into the executed command as list 0. If <span style="font-style: italic;">src.list</span> is omitted, the default select list is passed to the executed command. If neither form of <span style="font-weight: bold;">PASSLIST</span> is present, the behaviour depends on the setting of the EXECUTE.CLEARLIST option of the <span style="font-weight: bold;"><a href="qmbd_mode.htm" class="topiclink">$MODE</a></span> compiler directive. If this mode is not set, the default select list is passed into the executed command. If the mode is set, the default select list is cleared prior to execution of the command.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">RTNLIST</span> clause returns the named variable as the content of the default select list after execution of the command.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">STACKLIST</span> option saves the current state of the default select list (list 0) before executing the command and restores the list on return to the program, thus allowing the executed command to use the default select list internally. This option cannot be used with either <span style="font-weight: bold;">PASSLIST</span> or <span style="font-weight: bold;">RTNLIST</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SETTING</span> or <span style="font-weight: bold;">RETURNING</span> clause copies the value of <a href="at_variables.htm#system.return.code" class="topiclink">@SYSTEM.RETURN.CODE</a> to the named variable after the command has been executed.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The unnamed common area is saved by the <span style="font-weight: bold;">EXECUTE</span> statement and the new command level may define a new structure for this area. On return from the <span style="font-weight: bold;">EXECUTE</span> statement, the original unnamed common area is restored. Named common areas are not affected by the <span style="font-weight: bold;">EXECUTE</span> statement. Except as influenced by the <span style="font-weight: bold;">PASSLIST</span> and <span style="font-weight: bold;">RTNLIST</span> options described above, the numbered select lists are carried into the executed command and any changes will be visible on return.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Application designers should carefully consider the possible impact of <span style="font-weight: bold;">EXECUTE</span> inside a <a href="transactions.htm" class="topiclink">transaction</a>.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The value of the <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function after an <span style="font-weight: bold;">EXECUTE</span> is undefined.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the executed command directly or indirectly changes account by performing a <span style="font-weight: bold;"><a href="logto.htm" class="topiclink">LOGTO</a></span>, the process will continue to run in the new account on return from the <span style="font-weight: bold;">EXECUTE</span>. Setting the STACKED.ACCOUNT mode of the <span style="font-weight: bold;"><a href="option.htm" class="topiclink">OPTION</a></span> command causes the system to revert to the previous account on completion of the <span style="font-weight: bold;">EXECUTE</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">EXECUTE &quot;LIST STOCK.FILE ITEMS QUANTITY&quot;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This statement performs the <span style="font-weight: bold;"><a href="list.htm" class="topiclink">LIST</a></span> command from within the calling program. Control is returned to the program once the <span style="font-weight: bold;">LIST</span> command is complete.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 29px;"><span style="font-family: 'Courier New',Courier,monospace;">EXECUTE &quot;SELECT CLIENTS WITH BALANCE &gt; 1000&quot; : @FM : RUN PAYMENT.LETTER</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This statement executes two related commands in a single step.</p>

</td></tr></table>

</body>
</html>
