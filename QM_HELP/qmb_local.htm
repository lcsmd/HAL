<!DOCTYPE html>
<html>
<head>
   <title>LOCAL</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="LOCAL" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_local.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">LOCAL</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_ln.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_locate.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">LOCAL</span> statement introduces an internal function or subroutine that may have private local variables.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">LOCAL </span>{<span style="font-weight: bold;">FUNCTION</span> | <span style="font-weight: bold;">SUBROUTINE</span>} <span style="font-style: italic;">name</span>{<span style="font-weight: bold;">(</span><span style="font-style: italic;">args</span><span style="font-weight: bold;">)</span>}</p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">PRIVATE </span><span style="font-style: italic;">vars</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-style: italic;">...statements...</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of the function subroutine.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">args</span></td><td style="border:none;padding:0">is the comma separated list of arguments to the function or subroutine. An argument may reference a whole matrix by prefixing it with <span style="font-weight: bold;">MAT</span>. The variable names used for the arguments are visible only to the one function or subroutine and do not prevent use of the same name in other parts of the program module to reference a different variable. Enclose the argument name in parenthesis to pass it by value.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When passing a whole matrix as an argument to a local function or subroutine, a <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span> statement can be used within the body of the local function or subroutine to re dimension the matrix. This is not the same behaviour as applying <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span> to a matrix passed as an argument to an external subroutine where the <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span> statement merely specifies the number of dimensions, the actual dimension values being ignored.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Further local variables that are private to the function or subroutine may be defined by immediately following the <span style="font-weight: bold;">LOCAL</span> statement by one or more <span style="font-weight: bold;">PRIVATE</span> statements. These contain a comma separated list of variable names which may be simple scalar items or matrices where the dimension values are numeric constants. Any variables referenced in the local function or subroutine but not declared as private are considered as having scope across the entire program module.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Functions and subroutines declared using <span style="font-weight: bold;">LOCAL</span> must be terminated with an <span style="font-weight: bold;">END</span> statement. The private variables declared using the <span style="font-weight: bold;">PRIVATE</span> statement have scope from the <span style="font-weight: bold;">LOCAL</span> statement until the corresponding <span style="font-weight: bold;">END</span> statement. Variables referenced in the main body of the program and in conventional internal subroutines are accessible unless they have the same name as a locally defined variable.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A local function must be defined using the <span style="font-weight: bold;"><a href="qmb_deffun.htm" class="topiclink">DEFFUN</a></span> statement with the <span style="font-weight: bold;"><a href="qmb_local.htm" class="topiclink">LOCAL</a></span> option before its first use in the program.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Label names are in scope across the whole program module. Because the multivalue Basic language has no concept of the top/bottom of an internal subroutine, the compiler can only perform limited validation. It is the developer's responsibility ensure that the flow of execution is correct. A program must not attempt to enter a local subroutine other than by use of a <span style="font-weight: bold;"><a href="qmb_gosub.htm" class="topiclink">GOSUB</a></span> or <span style="font-weight: bold;"><a href="qmb_on_gosub.htm" class="topiclink">ONÂ GOSUB</a></span> to the name defined in the <span style="font-weight: bold;">LOCAL</span> statement. Similarly, a program must only enter a local function by use of the name in the <span style="font-weight: bold;"><a href="qmb_deffun.htm" class="topiclink">DEFFUN</a></span> statement.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If a local subroutine is called recursively, either directly or indirectly via some other intermediate subroutine, the local variables are stacked and the new invocation has its own private local variables.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>There is a small performance cost by comparison to use of conventional internal subroutines due to the dynamic allocation of variables but this should be negligible in most applications.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When using the QMBasic debugger, local variables have a name formed from the subroutine name and variable name separated by a colon.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LOCAL SUBROUTINE SCAN.LIST</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; PRIVATE I, N, REC</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; N = DCOUNT(LIST, @FM)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; FOR I = 1 TO N</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;READV REC FROM STOCK.F, LIST&lt;I&gt; , 0 ELSE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; DISPLAY LIST&lt;I&gt; : ' is not in stock file'</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;END</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; NEXT</span><span style="font-family: Courier,monospace;"> I</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; RETURN</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above program fragment represents a local subroutine that scans a list, checking that each entry corresponds to a record in a file. By using <span style="font-weight: bold;">LOCAL</span> and three local variables, all risk of overwriting valuable data in variables of the same names in the main body of the program is removed.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LOCAL FUNCTION NEXT.ID(FILENAME)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; PRIVATE DICT.F, ID</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; OPEN 'DICT', FILENAME TO DICT.F THEN</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;READU ID FROM DICT.F, 'NEXT.ID' THEN</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; WRITE ID+1 TO DICT.F, 'NEXT.ID'</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; RETURN ID</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;END</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; END</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; RETURN ''</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above local function takes a file name as its argument and gets the next sequential record id from a record stored in the corresponding dictionary, returning this as the value of the function. The dictionary will automatically be closed when the DICT.F variable is discarded on return from the function.</p>

</td></tr></table>

</body>
</html>
