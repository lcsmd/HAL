<!DOCTYPE html>
<html>
<head>
   <title>OPENSEQ</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="OPENSEQ" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_openseq.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">OPENSEQ</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_openpath.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_opentemp.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">OPENSEQ</span> statement opens a record of a directory file, a device or a pipe for sequential access.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">OPENSEQ</span> <span style="font-style: italic;">file.name</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">id</span><span style="font-weight: bold;"> </span>{<span style="font-style: italic;">options</span>} <span style="font-weight: bold;">TO </span><span style="font-style: italic;">file.var</span></p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">ON ERROR</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">LOCKED</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">THEN</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">ELSE</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p>or</p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">OPENSEQ</span> <span style="font-style: italic;">pathname</span><span style="font-weight: bold;"> </span>{<span style="font-style: italic;">options</span>} <span style="font-weight: bold;">TO </span><span style="font-style: italic;">file.var</span></p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">ON ERROR</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">LOCKED</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">THEN</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p style="margin: 0 0 0 30px;">{<span style="font-weight: bold;">ELSE</span> <span style="font-style: italic;">statement(s)</span>}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">file.name</span></td><td style="border:none;padding:0">evaluates to the VOC name of the directory file holding the record to be opened.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">id</span></td><td style="border:none;padding:0">evaluates to the name of the record to be opened.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">pathname</span></td><td style="border:none;padding:0">evaluates to the operating system pathname of the record to be opened. This may be a file, a device or a pipe.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">options</span></td><td style="border:none;padding:0">are chosen from the following, each of which is described in detail below:</td></tr></table></div><p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">ENCODING</span> <span style="font-style: italic;">name</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">APPEND</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">CREATING</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">NOBUF</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">NO.MAP</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">OVERWRITE</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">READONLY</span></p>
<p style="text-indent: -195px; margin: 0 0 0 405px;"><span style="font-weight: bold;">SHARED</span></p>
<p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">file.var</span></td><td style="border:none;padding:0">is the name of a variable to be used in later statements accessing this record.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">statement(s)</span></td><td style="border:none;padding:0">are statement(s) to be executed depending on the outcome of the <span style="font-weight: bold;">OPENSEQ</span> statement.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>At least one of the <span style="font-weight: bold;">THEN</span> and <span style="font-weight: bold;">ELSE</span> clauses must be present.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The named record is opened and associated with <span style="font-style: italic;">file.var</span> for later operations.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The optional <span style="font-weight: bold;">ENCODING</span> clause sets the default character encoding to be used and overrides any encoding set in the <a href="voc_f.htm" class="topiclink">VOC F-type</a> record for the first form of <span style="font-weight: bold;">OPENSEQ</span>. Because the second form of this statement does not reference the VOC, any encoding to be applied must be specified using the <span style="font-weight: bold;">ENCODING</span> option. The <span style="font-style: italic;">name</span> may be a quoted literal string or an expression that evaluates to the encoding name. A null string as the encoding name is equivalent to not having the <span style="font-weight: bold;">ENCODING</span> clause at all. To disable the default encoding, the encoding name should be specified as &quot;NULL&quot;.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of the <span style="font-weight: bold;">APPEND</span> option causes the <span style="font-weight: bold;">OPENSEQ</span> statement to position at the end of any existing data in the record such that subsequent write operations will append new data. Use of <span style="font-weight: bold;">OVERWRITE</span> truncates the record to remove any existing data. These two options may not be used together.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">NOBUF</span> option causes the file, device or pipe opened by <span style="font-weight: bold;">OPENSEQ</span> to be accessed in an unbuffered mode. This is likely to degrade performance compared to use of the default buffered mode but allows, for example, two processes to read from the same pipe.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">NO.MAP</span> option suppresses the normal translation of restricted characters in record ids. See <a href="directoryfiles.htm" class="topiclink">directory files</a> for more information.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">READONLY</span> option opens the item for read only access. Any attempt to write will fail.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SHARED</span> option allows multiple QM processes to open the same record such that use of <span style="font-weight: bold;"><a href="qmb_writeblk.htm" class="topiclink">WRITEBLK</a></span>, <span style="font-weight: bold;"><a href="qmb_writecsv.htm" class="topiclink">WRITECSV</a></span>, <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQ</a></span> or <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQF</a></span> will append to the record, allowing easy construction of audit trail logs or other similar items. Use of this option implies <span style="font-weight: bold;">APPEND</span> and <span style="font-weight: bold;">NOBUF</span>. Also, the record will be created by <span style="font-weight: bold;">OPENSEQ </span>if it does not already exist.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the record already exists, the <span style="font-weight: bold;">THEN</span> clause is executed. Except when using the <span style="font-weight: bold;">SHARED</span> option, an update lock will be set on this record unless the record is read-only in which case a shared read lock is set.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the record does not already exist, the action depends on whether the <span style="font-weight: bold;">CREATING</span> option has been used. If this option is present, the record is created and the <span style="font-weight: bold;">THEN</span> clause is executed. Otherwise the <span style="font-weight: bold;">ELSE</span> clause is executed and the <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function returns zero. The record will have been locked and use of <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQ</a></span>, <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQF</a></span>, <span style="font-weight: bold;"><a href="qmb_writeblk.htm" class="topiclink">WRITEBLK</a></span>, <span style="font-weight: bold;"><a href="qmb_weofseq.htm" class="topiclink">WEOFSEQ</a></span> or <span style="font-weight: bold;"><a href="qmb_create.htm" class="topiclink">CREATE</a></span> with the returned <span style="font-style: italic;">file.var</span> will create the record. Alternatively, the lock can be released using <span style="font-weight: bold;"><a href="qmb_release.htm" class="topiclink">RELEASE</a></span> or closing the <span style="font-style: italic;">file.var</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">ELSE</span> clause is also executed if the specified item cannot be opened due to an error. The <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function will contain the error code.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">LOCKED</span> clause is executed if the record is already locked by another process.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">ON ERROR</span> clause is executed if a fatal error occurs when opening the record. The <span style="font-weight: bold;"><a href="qmb_status.htm" class="topiclink">STATUS()</a></span> function will return an error code relating to the problem.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A record open for sequential access may be read and written using <span style="font-weight: bold;"><a href="qmb_readseq.htm" class="topiclink">READSEQ</a></span> and <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQ</a></span> respectively. The <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQF</a></span> statement provides a forced write and <span style="font-weight: bold;"><a href="qmb_weofseq.htm" class="topiclink">WEOFSEQ</a></span> sets an end of file marker. The record should be closed using <span style="font-weight: bold;"><a href="qmb_closeseq.htm" class="topiclink">CLOSESEQ</a></span> though it will be closed automatically when the program in which the file variable lies terminates. </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The second form of <span style="font-weight: bold;">OPENSEQ</span> may be used to open a serial port by using the device name as <span style="font-style: italic;">pathname</span>. On Windows, this name is COM1, COM2, etc optionally followed by a colon. On other platforms, it is the device driver name. </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>To open a floppy disk drive (e.g. a Pick style account save) specify the pathname as &quot;A:&quot; on Windows or use the device driver name (probably /dev/fd0) on Linux.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">OPENSEQ &quot;STOCKS&quot;, &quot;STOCK.LIST&quot; TO STOCK.LIST ELSE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; IF STATUS() THEN ABORT &quot;Cannot open stocks list&quot;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment opens the record STOCK.LIST of directory file STOCKS. If it fails to either open an existing record or to create a new record, the program aborts.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">OPENSEQ &quot;C:\TEMP\IMPORT.DATA&quot; TO DAT.F ELSE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; IF STATUS() THEN ABORT &quot;Cannot open import data file&quot;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment opens the operating system file in C:\TEMP\IMPORT.DATA for sequential processing.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_closeseq.htm" class="topiclink">CLOSESEQ</a></span>, <span style="font-weight: bold;"><a href="qmb_create.htm" class="topiclink">CREATE</a></span>, <span style="font-weight: bold;"><a href="qmb_nobuf.htm" class="topiclink">NOBUF</a></span>, <span style="font-weight: bold;"><a href="qmb_readblk.htm" class="topiclink">READBLK</a></span>, <span style="font-weight: bold;"><a href="qmb_readcsv.htm" class="topiclink">READCSV</a></span>, <span style="font-weight: bold;"><a href="qmb_readseq.htm" class="topiclink">READSEQ</a></span>, <span style="font-weight: bold;"><a href="qmb_seek.htm" class="topiclink">SEEK</a></span>, <span style="font-weight: bold;"><a href="qmb_weofseq.htm" class="topiclink">WEOFSEQ</a></span>, <span style="font-weight: bold;"><a href="qmb_writeblk.htm" class="topiclink">WRITEBLK</a></span>, <span style="font-weight: bold;"><a href="qmb_writecsv.htm" class="topiclink">WRITECSV</a></span>, <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQ</a></span>, <span style="font-weight: bold;"><a href="qmb_writeseq.htm" class="topiclink">WRITESEQF</a></span></p>

</td></tr></table>

</body>
</html>
