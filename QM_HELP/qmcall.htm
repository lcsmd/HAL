<!DOCTYPE html>
<html>
<head>
   <title>QMCall()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="QMCall" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmcall.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">QMCall()</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmclient-example.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmcallx.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p class="p_Normal">&nbsp;</p>
<p>The <span style="font-weight: bold;">QMCall()</span> function calls a catalogued subroutine on the server. It is analogous to the QMBasic <span style="font-weight: bold;"><a href="qmb_call.htm" class="topiclink">CALL</a></span> statement.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The subroutine may take up to 20 arguments that must be passed as strings. QMClient<span style="font-weight: bold;"> </span>does not provide a method to call subroutines with a greater number of arguments or those that are defined to pass a QMBasic dimensioned matrix as an argument.</p>
<p class="p_Normal">&nbsp;</p>
<p>The called subroutine may make use of any of the standard QMBasic programming statements and functions, however, it may not perform terminal input that is not handled via the data queue as there is no terminal associated with the server process. Any terminal output will be discarded unless redirected to a COMO file.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <a href="configparams.htm#qmclient" class="topiclink">QMCLIENT</a> configuration parameter can be used to restrict <span style="font-weight: bold;">QMCall()</span> to calling only subroutines that have been compiled with the <a href="qmbd_qmcall.htm" class="topiclink">$QMCALL</a> compiler directive. Use of this feature prevents a malicious application that uses the QMClient API calling other subroutines that might not perform adequate security validation to protect the system.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Handling values returned via the subroutine arguments differs depending on the variant of the QMClient API in use. Some update the argument variables directly, others require use of the <span style="font-weight: bold;"><a href="qmgetarg.htm" class="topiclink">QMGetArg()</a></span> function. The language specific descriptions below give more details.</p>
<p class="p_Normal">&nbsp;</p>
<p>The example program fragments below call a subroutine on the server that sets the credit limit for a specific client. The subroutine takes three arguments, the third of which is used to return an error message if the action fails. Note how the ErrMsg variable is set to a null string before calling the subroutine so that any old content of this variable is not unnecessarily sent across the network to the server. To optimise network traffic, the server only returns arguments values if they have been modified by the called subroutine.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A1_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A1','TOGGLE0186A1_ICON')">C</a></span></td></tr></table></div><div id="TOGGLE0186A1" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">void QMCall(char * </span><span style="font-style: italic;">SubrName</span><span style="font-weight: bold;">, short int </span><span style="font-style: italic;">ArgCount</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">ArgList</span><span style="font-weight: bold;">...)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg[0] = '\0';</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">QMCall(&quot;SET.CREDIT.LIMIT&quot;, 3, Client, NewLimit, ErrMsg);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">if (ErrMsg[0] != '\0') printf(&quot;Failed - %s\n&quot;, ErrMsg);</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Use of this function in the C API is not recommended as the size of any argument variable that may be overwritten by the subroutine must be large enough to receive the updated value. Failure to observe this rule will result in memory corruption. See the <span style="font-weight: bold;"><a href="qmcallx.htm" class="topiclink">QMCallx()</a></span> function for an alternative way to handle returned argument values.</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A2_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A2','TOGGLE0186A2_ICON')">VB.Net</a></span></td></tr></table></div><div id="TOGGLE0186A2" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">QMCall(ByVal </span><span style="font-style: italic;">SubrName</span><span style="font-weight: bold;"> as String, ByVal </span><span style="font-style: italic;">ArgCount</span><span style="font-weight: bold;"> as Short, Optional ByRef </span><span style="font-style: italic;">Arg1</span><span style="font-weight: bold;"> as String, ...)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = &quot;&quot;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">QMCall(&quot;SET.CREDIT.LIMIT&quot;, 3, Client, NewLimit, ErrMsg)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">If ErrMsg &lt;&gt; &quot;&quot; Then MsgBox(ErrMsg, MsgBoxStyle.Exclamation, &quot;Failed&quot;)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the subroutine modifies the values of any of its arguments, this will be reflected in the variables specified in <span style="font-style: italic;">ArgList</span> on return from the call.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A3_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A3','TOGGLE0186A3_ICON')">QMBasic</a> Class Module</span></td></tr></table></div><div id="TOGGLE0186A3" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">Call(</span><span style="font-style: italic;">SubrName</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">ArgList...</span><span style="font-weight: bold;">)</span></p>
<p style="text-indent: -91px; margin: 0 0 0 91px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -91px; margin: 0 0 0 91px;"><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = &quot;&quot;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">session-&gt;Call(&quot;SET.CREDIT.LIMIT&quot;, Client, NewLimit, ErrMsg)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">if ErrMsg # &quot;&quot; then display &quot;Failed - &quot; : ErrMsg</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the subroutine modifies the values of any of its arguments, this will be reflected in the variables specified in ArgList on return from the call.</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A4_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A4','TOGGLE0186A4_ICON')">Java</a></span></td></tr></table></div><div id="TOGGLE0186A4" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">Call(String </span><span style="font-style: italic;">SubrName</span><span style="font-weight: bold;">, &nbsp;String </span><span style="font-style: italic;">Arg1</span><span style="font-weight: bold;">, &nbsp;String </span><span style="font-style: italic;">Arg2</span><span style="font-weight: bold;">...)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = &quot;&quot;;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">qm.Call(&quot;SET.CREDIT.LIMIT&quot;, Client, NewLimit, ErrMsg);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = qm.GetArg(3);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">if (ErrMsg != &quot;&quot;) System.out.printf(&quot;Failed - %s%n&quot;, ErrMsg);</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note use of the <span style="font-weight: bold;"><a href="qmgetarg.htm" class="topiclink">GetArg()</a></span> method to retrieve the value of the modified ErrMsg argument. The ErrMsg variable in the call could have been replaced with a literal null string as it is an output only argument.</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A5_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A5','TOGGLE0186A5_ICON')">Python</a></span></td></tr></table></div><div id="TOGGLE0186A5" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">Call(</span><span style="font-style: italic;">SubrName</span><span style="font-weight: bold;">,  </span><span style="font-style: italic;">ArgCt</span><span style="font-weight: bold;">,  </span><span style="font-style: italic;">Arg1</span><span style="font-weight: bold;">,  </span><span style="font-style: italic;">Arg2</span><span style="font-weight: bold;">...)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = &quot;&quot;</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">qm.Call(&quot;SET.CREDIT.LIMIT&quot;, 3, Client, NewLimit, ErrMsg)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">ErrMsg = qm.GetArg(3);</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">if ErrMsg == &quot;&quot;: print(&quot;Failed&quot;, ErrMsg)</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Note use of <span style="font-weight: bold;"><a href="qmgetarg.htm" class="topiclink">QMGetArg()</a></span> to retrieve the value of the modified ErrMsg argument. The ErrMsg variable in the call could have been replaced with a literal null string as it is an output only argument.</p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmcallx.htm" class="topiclink">QMCallx</a></span>, <span style="font-weight: bold;"><a href="qmtrapcallabort.htm" class="topiclink">QMTrapCallAbort</a></span></p>

</td></tr></table>

<script type="text/javascript">
HMInitToggle('TOGGLE0186A1_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A1\',\'TOGGLE0186A1_ICON\')');
HMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A2_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A2\',\'TOGGLE0186A2_ICON\')');
HMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A3_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A3\',\'TOGGLE0186A3_ICON\')');
HMInitToggle('TOGGLE0186A3','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A4_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A4\',\'TOGGLE0186A4_ICON\')');
HMInitToggle('TOGGLE0186A4','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A5_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A5\',\'TOGGLE0186A5_ICON\')');
HMInitToggle('TOGGLE0186A5','hm.type','dropdown','hm.state','0');
</script>
</body>
</html>
