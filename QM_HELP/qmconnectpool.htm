<!DOCTYPE html>
<html>
<head>
   <title>QMConnectPool()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="QMConnectPool()" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmconnectpool.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">QMConnectPool()</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmconnectlocal.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmcreateobject.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">QMConnectPool()</span> function establishes a QMClient session using <a href="connection_pooling.htm" class="topiclink">connection pooling</a>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">The function arguments are:</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">Host</span></td><td style="border:none;padding:0">is the IP address or name of the server system. Use of IPV6 addresses requires that the <span style="font-weight: bold;"><a href="qmconnectiontype.htm" class="topiclink">QMConnectionType()</a></span> function is used first to enabled IPV6 support.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">Port</span></td><td style="border:none;padding:0">is the port number to which connection is to be made. Set this to -1 to use the default QMClient port.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">UserName</span></td><td style="border:none;padding:0">is the user name under which the server process is to run.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">Password</span></td><td style="border:none;padding:0">is the password for the given <span style="font-style: italic;">UserName</span>.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">Account</span></td><td style="border:none;padding:0">is the name of the QM account to be accessed.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 29px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">Pool</span></td><td style="border:none;padding:0">is the connection pool name.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">QMConnectPool()</span> function attempts to establish a QMClient<span style="font-weight: bold;"> </span>process on the system identified by the <span style="font-style: italic;">Host</span> argument. If successful, the function returns True. If unsuccessful, the function returns False and the <span style="font-weight: bold;"><a href="qmerror.htm" class="topiclink">QMError()</a></span> function can be used to retrieve a text error message identifying the cause of the failure. If there is an idle QMClient process that matches the user, account and pool names, the function connects to this session rather than creating a new one.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A single client may open multiple connections simultaneously. For the C and VB.Net variants of QMClient, the internal session number associated with the session opened by <span style="font-weight: bold;">QMConnectPool()</span> can be retrieved using <span style="font-weight: bold;"><a href="qmgetsession.htm" class="topiclink">QMGetSession()</a></span>. All subsequent QMClient function calls relate to the most recently opened session unless <span style="font-weight: bold;"><a href="qmsetsession.htm" class="topiclink">QMSetSession()</a></span> is used to select an alternative session. For the QMBasic class module, Java and Python variants of QMClient, each session is instantiated as a separate object.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QMClient sessions run the <a href="command_scripts.htm" class="topiclink">MASTER.LOGIN</a> and/or <a href="command_scripts.htm" class="topiclink">LOGIN</a> paragraph (if present). A QMClient session can be recognised within these paragraphs by testing the value of @TTY which will be &quot;vbsrvr&quot; for QMClient. Note that a prompt for input within the actions performed by the paragraph cannot be handled via QMClient.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A1_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A1','TOGGLE0186A1_ICON')">C</a></span></td></tr></table></div><div id="TOGGLE0186A1" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">int QMConnectPool(char *</span> <span style="font-style: italic;">Host</span><span style="font-weight: bold;">, int</span> <span style="font-style: italic;">Port</span><span style="font-weight: bold;">, char *</span> <span style="font-style: italic;">UserName</span><span style="font-weight: bold;">, char *</span> <span style="font-style: italic;">Password</span><span style="font-weight: bold;">, char *</span> <span style="font-style: italic;">Account</span><span style="font-weight: bold;">, char * </span><span style="font-style: italic;">Pool</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">if (!QMConnectPool(Host, -1, UserName, Password, Account, Pool))</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;printf(&quot;Failed to connect - %s\n&quot;, QMError());</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> }</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A2_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A2','TOGGLE0186A2_ICON')">VB.Net</a></span></td></tr></table></div><div id="TOGGLE0186A2" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">QMConnectPool(ByVal</span> <span style="font-style: italic;">Host </span><span style="font-weight: bold;">as String, ByVal</span> <span style="font-style: italic;">Port </span><span style="font-weight: bold;">as Integer, ByVal</span> <span style="font-style: italic;">UserName </span><span style="font-weight: bold;">as String, ByVal</span> <span style="font-style: italic;">Password </span><span style="font-weight: bold;">as String, ByVal</span> <span style="font-style: italic;">Account </span><span style="font-weight: bold;">as String, ByVal</span> <span style="font-style: italic;">Pool </span><span style="font-weight: bold;">as String) as Boolean</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">If Not QMConnectPool(Host, -1, UserName, Password, Account, Pool) Then</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; MsgBox(QMError(), MsgBoxStyle.Exclamation, &quot;Failed to connect&quot;)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">End If</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A3_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A3','TOGGLE0186A3_ICON')">QMBasic</a> Class Module</span></td></tr></table></div><div id="TOGGLE0186A3" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-style: italic;">Bool</span><span style="font-weight: bold;"> </span><span style="font-style: italic;">session</span><span style="font-weight: bold;">-&gt;ConnectPool(</span><span style="font-style: italic;">Host</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Port</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">UserName</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Password</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Account</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Pool</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">session = object(&quot;!qmclient&quot;)</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">if not(session-&gt;ConnectPool(Host, -1, UserName, Password, Account, Pool)) then</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; stop &quot;Failed to connect - &quot; : session-&gt;error()</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;">end</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A4_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A4','TOGGLE0186A4_ICON')">Java</a></span></td></tr></table></div><div id="TOGGLE0186A4" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">boolean ConnectPool(String</span> <span style="font-style: italic;">Host</span><span style="font-weight: bold;">, int</span> <span style="font-style: italic;">Port</span><span style="font-weight: bold;">, String</span> <span style="font-style: italic;">UserName</span><span style="font-weight: bold;">, String</span> <span style="font-style: italic;">Password</span><span style="font-weight: bold;">, String</span> <span style="font-style: italic;">Account</span><span style="font-weight: bold;">, String</span> <span style="font-style: italic;">Pool</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">if (!qm.ConnectPool(Host, -1, UserName, Password, Account, Pool))</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> {</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;System.out.println(&quot;Failed to connect - &quot; + qm.Error());</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> }</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; border-color: #000000; border-style: solid; border-width: thin; background: #99ccff; padding: 0 0 0 0; margin: 0 0 0 0;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:18px"><img id="TOGGLE0186A5_ICON" class="dropdown-toggle-icon" alt="hmtoggle_plus1" width="9" height="9" style="margin:0;width:9px;height:9px;border:none" src="hmtoggle_plus1.gif"/></td><td style="border:none;padding:0"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif;"><a class="dropdown-toggle" style="font-style: normal; font-weight: normal; color: #000000; background-color: transparent; text-decoration: none;" href="javascript:HMToggle('toggle','TOGGLE0186A5','TOGGLE0186A5_ICON')">Python</a></span></td></tr></table></div><div id="TOGGLE0186A5" class="dropdown-toggle-body" style="text-align: left; padding: 0 0 0 0; margin: 0 0 0 18px;"><table style="border:none; border-spacing:0;">
<tr>
<td style="vertical-align:top; padding:0; border:none"><p style="margin: 10px 0 0 0;"><span style="font-weight: bold;">ConnectPool(</span><span style="font-style: italic;">Host</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Port</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">UserName</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Password</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Account</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">Pool</span><span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 0;"><span style="font-family: 'Courier New',Courier,monospace;">if not qm.ConnectPool(Host, -1, UserName, Password, Account, Pool):</span></p>
<p><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;print(&quot;Failed to connect - &quot;, qm.Error())</span></p>
</td>
</tr>
</table>
</div>
<p style="text-indent: -18px; margin: 0 0 0 18px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><a href="connection_pooling.htm" class="topiclink">Connection pooling</a>, <span style="font-weight: bold;"><a href="qmdisconnect.htm" class="topiclink">QMDisconnect</a>, <a href="qmpoolidle.htm" class="topiclink">QMPoolIdle()</a></span></p>

</td></tr></table>

<script type="text/javascript">
HMInitToggle('TOGGLE0186A1_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A1\',\'TOGGLE0186A1_ICON\')');
HMInitToggle('TOGGLE0186A1','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A2_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A2\',\'TOGGLE0186A2_ICON\')');
HMInitToggle('TOGGLE0186A2','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A3_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A3\',\'TOGGLE0186A3_ICON\')');
HMInitToggle('TOGGLE0186A3','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A4_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A4\',\'TOGGLE0186A4_ICON\')');
HMInitToggle('TOGGLE0186A4','hm.type','dropdown','hm.state','0');
HMInitToggle('TOGGLE0186A5_ICON','hm.type','dropdown','hm.state','0','hm.src0','hmtoggle_plus0.gif','hm.src1','hmtoggle_plus1.gif','onclick','HMToggle(\'toggle\',\'TOGGLE0186A5\',\'TOGGLE0186A5_ICON\')');
HMInitToggle('TOGGLE0186A5','hm.type','dropdown','hm.state','0');
</script>
</body>
</html>
