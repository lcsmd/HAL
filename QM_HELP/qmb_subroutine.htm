<!DOCTYPE html>
<html>
<head>
   <title>SUBROUTINE</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="SUBROUTINE" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_subroutine.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">SUBROUTINE</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_subr.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_substitute.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SUBROUTINE</span> statement introduces a subroutine. The abbreviation <span style="font-weight: bold;">SUB</span> may be used.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">SUBROUTINE</span> <span style="font-style: italic;">name</span>{<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">arg2</span>...}<span style="font-weight: bold;">)</span> {<span style="font-weight: bold;">VAR.ARGS</span>}}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of the subroutine.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">arg1</span>, etc</td><td style="border:none;padding:0">are the names of the arguments to the subroutine.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QMBasic programs should commence with a <span style="font-weight: bold;"><a href="qmb_program.htm" class="topiclink">PROGRAM</a></span>, <span style="font-weight: bold;">SUBROUTINE</span>, <span style="font-weight: bold;"><a href="qmb_function.htm" class="topiclink">FUNCTION</a></span> or <span style="font-weight: bold;"><a href="qmb_class.htm" class="topiclink">CLASS</a></span> statement. If none of these is present<span style="font-weight: bold;">,</span> the compiler behaves as though a <span style="font-weight: bold;"><a href="qmb_program.htm" class="topiclink">PROGRAM</a></span> statement had been used with <span style="font-style: italic;">name</span> as the name of the source record.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">SUBROUTINE</span> statement must appear before any executable statements. A <span style="font-weight: bold;">SUBROUTINE</span> with no arguments is equivalent to a <span style="font-weight: bold;"><a href="qmb_program.htm" class="topiclink">PROGRAM</a></span>. The brackets are optional if there are no arguments. The <span style="font-weight: bold;">SUBROUTINE</span> statement may be split over multiple lines by breaking after a comma.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The name used in a <span style="font-weight: bold;">SUBROUTINE</span> statement need not be related to the name of the source record though it is recommended that they are the same as this eases program maintenance. The name must comply with the QMBasic <a href="qmbasic_variablenamesandvalues.htm" class="topiclink">name format rules</a> </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A subroutine module is entered by referencing it a <span style="font-weight: bold;"><a href="qmb_call.htm" class="topiclink">CALL</a></span> statement. A subroutine that has no arguments can also be entered by use of the <span style="font-weight: bold;"><a href="run.htm" class="topiclink">RUN</a></span> command or by executing a command name that corresponds to the name of the program in the system catalogue.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal"><span style="font-weight: bold;">Variable Length Argument Lists and Default Values</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The number of arguments in calls to the subroutine must be the same as in the <span style="font-weight: bold;">SUBROUTINE</span> statement unless the subroutine is declared with the <span style="font-weight: bold;">VAR.ARGS</span> option. When <span style="font-weight: bold;">VAR.ARGS</span> is used, any arguments not passed by the caller will be unassigned. The <span style="font-weight: bold;"><a href="qmb_arg_count.htm" class="topiclink">ARG.COUNT()</a></span> function can be used to determine the actual number of arguments passed. The <span style="font-weight: bold;"><a href="qmb_arg_present.htm" class="topiclink">ARG.PRESENT()</a></span> function can be used to test for the presence of an optional argument by name. If the values of argument variables are changed by the subroutine, these changes are reflected in the variables used in the <span style="font-weight: bold;"><a href="qmb_call.htm" class="topiclink">CALL</a></span> statement that entered the subroutine.</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">SUBROUTINE CREDIT.RATING(CLIENT, CLASS, CODE) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS and CODE variables will be unassigned. If the calling program provides two arguments, the CODE variable will &nbsp;be unassigned.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">When using <span style="font-weight: bold;">VAR.ARGS</span>, default values may be provided for any arguments by following the argument name with an = sign and the required numeric or string value or the @FALSE or @TRUE constants. For example,</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">SUBROUTINE CREDIT.RATING(CLIENT, CLASS = 1, CODE = &quot;Standard&quot;) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS variable will default to 1 and the CODE variable will default to &quot;Standard&quot;. It the calling program provides two arguments, the default value for CLASS is ignored and the CODE variable defaults to &quot;Standard&quot;.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Default argument values can also be provided when the DEFAULT.UNASS.ARGS option of the <a href="qmbd_mode.htm" class="topiclink">$MODE</a> compiler directive is enabled. In this case, the default value will be applied if the argument variable passed from the calling program is unassigned.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Pass By Reference</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Subroutine arguments are normally passed by reference such that changes made to the argument variable inside a subroutine will be visible in the caller's variable referenced by that argument. The <span style="font-weight: bold;"><a href="qmb_call.htm" class="topiclink">CALL</a></span> statement allows arguments to be passed by value by enclosing them in brackets. The <span style="font-weight: bold;">SUBROUTINE</span> statement also supports this dereferencing syntax. For example</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">SUBROUTINE INVOICE(P, (Q))</span></p>
<p>If dereferencing is used with the default argument syntax described above, the default value is placed inside the parenthesis. For example,</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">SUBROUTINE INVOICE(P, (Q = 7)) VAR.ARGS</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Matrix Arguments</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">An argument may refer to a whole matrix. In this case the argument variable name must be preceded by the keyword <span style="font-weight: bold;">MAT </span>and there must be a <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span> statement following the subroutine declaration to indicate whether this is a one or two dimensional matrix. Alternatively, the dimensions may be given after the variable name in the <span style="font-weight: bold;">SUBROUTINE</span> statement. In either case, the actual dimension values are counted by the compiler to establish whether the matrix has one or two dimensions but are otherwise ignored. Developers frequently use of a dimension value of one to emphasise to readers of the program that the value is meaningless. A default style (not Pick style) matrix passed as an argument can be re-dimensioned in the subroutine by use of the <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">REDIMENSION</a></span> (or <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">REDIM</a></span>) statement. Used in any other context, this statement is identical to use of <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>For example</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">SUBROUTINE MATMAX(MAX, MAT A)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; DIM A(1)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; MAX = A(1)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; N = INMAT(A)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; FOR I = 2 TO N</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;IF A(I) &gt; MAX THEN MAX = A(I)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; NEXT I</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p> &nbsp; </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This subroutine scans a one dimensional matrix and passes back the value of the largest element via the MAX argument. The first two lines could alternatively be written as</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">SUBROUTINE MATMAX(MAX, A(1))</span></p>

</td></tr></table>

</body>
</html>
