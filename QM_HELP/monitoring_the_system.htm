<!DOCTYPE html>
<html>
<head>
   <title>Monitoring the System</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="Monitoring the system,RECOVER.USERS" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "monitoring_the_system.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">Monitoring the System</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="backup_and_restore.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="language.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QM provides several tools to aid System Administrators in monitoring the system and locating problems.</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="listu.htm" class="topiclink">LISTU</a></span></td><td style="border:none;padding:0">Displays a list of users currently logged in to QM</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="list_files.htm" class="topiclink">LIST.FILES</a></span></td><td style="border:none;padding:0">Shows the names of all files currently open in the system. This command can also help in determining the optimum value for the <a href="configparams.htm#numfiles" class="topiclink">NUMFILES</a> configuration parameter.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="list_locks.htm" class="topiclink">LIST.LOCKS</a></span></td><td style="border:none;padding:0">Lists process synchronisation (task) locks.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="list_readu.htm" class="topiclink">LIST.READU</a></span></td><td style="border:none;padding:0">Lists all active record and file locks. Includes a report of who is waiting for locks. The DETAIL option to this command can also help in determining the optimum value for the <a href="configparams.htm#numlocks" class="topiclink">NUMLOCKS</a> configuration parameter.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="fstat.htm" class="topiclink">FSTAT</a></span></td><td style="border:none;padding:0">Shows file system performance related data.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="pstat.htm" class="topiclink">PSTAT</a></span></td><td style="border:none;padding:0">Displays process status information including the command or program being executed.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-weight: bold;"><a href="hsm.htm" class="topiclink">HSM</a></span></td><td style="border:none;padding:0">More useful for programmers than administrators, the <span style="font-weight: bold;"><a href="hsm.htm" class="topiclink">HSM</a></span> (hot spot monitor) command shows the processing time spent in each module of an application.</td></tr></table></div><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Releasing Locks</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Sometimes a QM process may fail to release a lock. In most cases, QM will tidy up automatically if the program or process terminates but there may be times when it is necessary to release a lock manually.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Be careful to consider the implications before releasing a lock. The lock was taken to protect something from simultaneous update. Releasing a lock always carries the risk of data integrity problems.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Record locks, file locks and process synchronisation (task) locks can be released with the <span style="font-weight: bold;"><a href="unlock.htm" class="topiclink">UNLOCK</a></span> command. This command can only be executed from the QMSYS account and requires administrator rights.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Terminating QM Sessions</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">A System Administrator can terminate a QM session using the <span style="font-weight: bold;"><a href="logout.htm" class="topiclink">LOGOUT</a></span> command. Also, the qm command has a three special options that may be of use to System Administrators.</p>
<p class="p_Normal">&nbsp;</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:119px">qm -k <span style="font-style: italic;">uid</span></td><td style="border:none;padding:0">Kill process with QM user id <span style="font-style: italic;">uid</span>.</td></tr></table></div><p style="text-indent: -119px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:119px">qm -k all</td><td style="border:none;padding:0">Kill all QM processes.</td></tr></table></div><p style="text-indent: -119px; margin: 0 0 0 149px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:119px">qm -u</td><td style="border:none;padding:0">List all active QM processes</td></tr></table></div><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QM will attempt to tidy up, releasing any resources owned by the terminated process. Note that terminating a process carries the risk of data integrity problems if the termination occurs in the middle of an update that affects multiple files.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The Windows Task Manager or the kill command on other platforms with signal number 9 (kill -9) should only be used as a last resort if <span style="font-weight: bold;"><a href="logout.htm" class="topiclink">LOGOUT</a></span> fails to kill the process. QM cannot catch this event and hence cannot free resources assigned to the terminated process. If this style of process termination is used while a QM process is updating a file, loss of data could occur.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Lost Processes</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">QM periodically compares its internal user table with the processes that are running at the operating system level. If any process registered within QM is no longer running, it must have terminated abnormally. An automated clean up mechanism will remove the user from the internal table, where possible releasing any locks that were held by that process. This automated scan occurs at an interval set with the <a href="configparams.htm#cleanup" class="topiclink">CLEANUP</a> configuration parameter, defaulting to once every five minutes if this parameter is not used. Setting the interval to a very low value can impact performance.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The <span style="font-weight: bold;">RECOVER.USERS</span> command can be used from within the QMSYS account to perform a similar clean up manually. The same effect can be achieved using</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">qm -cleanup</span></p>
<p class="p_Normal">from the operating system command prompt.</p>

</td></tr></table>

</body>
</html>
