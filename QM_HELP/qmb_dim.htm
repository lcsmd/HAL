<!DOCTYPE html>
<html>
<head>
   <title>DIMENSION</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DIM,DIMENSION,REDIM,REDIMENSION" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_dim.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">DIMENSION, DIM, REDIMENSION, REDIM</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_digest.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_dir.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DIMENSION</span> statement is used to set the dimensions of a matrix. The short form <span style="font-weight: bold;">DIM</span> may be used in place of <span style="font-weight: bold;">DIMENSION</span>. The <span style="font-weight: bold;">REDIMENSION</span> or <span style="font-weight: bold;">REDIM</span> statement is identical except where the matrix is a subroutine argument.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">DIMENSION</span> <span style="font-style: italic;">mat</span><span style="font-weight: bold;">(</span><span style="font-style: italic;">rows</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">cols</span>}<span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">REDIMENSION</span> <span style="font-style: italic;">mat</span><span style="font-weight: bold;">(</span><span style="font-style: italic;">rows</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">cols</span>}<span style="font-weight: bold;">)</span></p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">DIMENSION </span><span style="font-style: italic;">var</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">mat</span></td><td style="border:none;padding:0">is the name of the matrix.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">rows</span></td><td style="border:none;padding:0">evaluates to the number of rows in the matrix.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">cols</span></td><td style="border:none;padding:0">evaluates to the number of columns in a two dimensional matrix.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px">var</td><td style="border:none;padding:0">is the name of a scalar variable.</td></tr></table></div><p class="p_Normal">&nbsp;</p>
<p class="p_Normal">In all cases, multiple comma separated items may be included in a single statement.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A matrix variable is a one or two dimensional array of values. Matrices must be declared by use of the <span style="font-weight: bold;">DIMENSION</span> statement and this statement must be executed at program run time before the variable is used in any other way.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A one dimensional matrix of ten elements is defined by a statement of the form</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIMENSION A(10)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>For a two dimensional matrix with 5 rows of 8 columns this becomes</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIMENSION B(5,8)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>By default, all matrices have an additional element, <span style="font-weight: bold;">the zero element</span>, which is used by some QMBasic statements. This is referred to as A(0) or B(0,0). </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The elements of a matrix may hold data of differing types (numeric, string, file variable, etc).</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A matrix may be re-dimensioned at any time by a further <span style="font-weight: bold;">DIMENSION</span> statement, including changing the number of dimensions. Existing values of matrix elements will be retained in the re-dimensioned matrix by effectively copying elements on a row by row basis. Thus, increasing the number of rows in a two dimensional matrix does not affect the previously existing items whereas increasing the number of columns will reorganise the existing data. When enlarging a matrix, the newly created elements will be unassigned. When decreasing the size of a matrix, any values in the excess elements are discarded.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A matrix passed into an external subroutine or function as an argument variable cannot be re-dimensioned using <span style="font-weight: bold;">DIMENSION</span>. Instead, the <span style="font-weight: bold;">REDIMENSION</span> statement must be used. See the <span style="font-weight: bold;"><a href="qmb_subroutine.htm" class="topiclink">SUBROUTINE</a></span> statement for more detail.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="qmbd_mode.htm" class="topiclink">$MODE</a></span> compiler directive can be used to select Pick style matrices which do not have a zero element and cannot be re-dimensioned.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="qmb_inmat.htm" class="topiclink">INMAT()</a></span> function may be used to check on the success of a <span style="font-weight: bold;">DIMENSION</span> statement. A sequence such as</p>
<p style="margin: 6px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIMENSION A(N)</span></p>
<p style="margin: 0 0 6px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">IF INMAT() THEN ABORT &quot;Insufficient memory&quot;</span></p>
<p>will cause the program to abort if there is insufficient memory to hold the matrix. The <span style="font-weight: bold;"><a href="qmb_inmat.htm" class="topiclink">INMAT()</a></span> function used in this way returns 0 if the <span style="font-weight: bold;">DIMENSION</span> statement was successful, 1 if it failed. With the memory sizes found on modern systems, this test is probably totally unnecessary and usually omitted.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;"><a href="qmb_inmat.htm" class="topiclink">INMAT()</a></span> function can also be used to find the current dimensions of a matrix. For a single dimensional matrix, this function returns the number of elements excluding the zero element. For a two dimensional matrix, the function returns the row and column dimensions separated by a value mark.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">If the <a href="qmbd_mode.htm" class="topiclink">$MODE EXPLICIT</a> compiler directive is in force, scalar variables must also be declared in a <span style="font-weight: bold;">DIMENSION</span> statement before any other reference to the variable name in the program. This mode allows improved error checking by trapping errors such as misspelled variable names that might otherwise simply appear to be a separate variable.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">N = DCOUNT(REC, @FM)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIM A(N)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">MATPARSE A FROM REC, @FM</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment creates an array with the correct number of elements to receive the result of a <span style="font-weight: bold;">MATPARSE</span> operation on dynamic array REC and then performs the <span style="font-weight: bold;">MATPARSE</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">DIM A(3), B(2,3)</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">DISPLAY INMAT(A)</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">DISPLAY CHANGE(INMAT(B), @VM, ',')</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment creates two matrices and reports their sizes. For the second use of <span style="font-weight: bold;">INMAT()</span>, the <span style="font-weight: bold;"><a href="qmb_change.htm" class="topiclink">CHANGE()</a></span> function has been use to replace the value mark in the returned data with a comma. The program output would be</p>
<p class="p_CodeBody"><span class="f_CodeBody">3</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">2,3</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">DIM CLIENT, DATA.REC</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">This statement declares two scalar variables. This is only needed in conjunction with the $MODE EXPLICIT compiler directive.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_inmat.htm" class="topiclink">INMAT()</a></span>, <span style="font-weight: bold;"><a href="qmb_mat.htm" class="topiclink">MAT</a></span>, <span style="font-weight: bold;"><a href="qmb_matbuild.htm" class="topiclink">MATBUILD</a></span>, <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span>, <span style="font-weight: bold;"><a href="qmb_matreadcsv.htm" class="topiclink">MATREADCSV</a></span>, <span style="font-weight: bold;"><a href="qmb_matparse.htm" class="topiclink">MATPARSE</a></span>, <span style="font-weight: bold;"><a href="qmb_matwrite.htm" class="topiclink">MATWRITE</a></span></p>

</td></tr></table>

</body>
</html>
