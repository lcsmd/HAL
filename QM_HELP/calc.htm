<!DOCTYPE html>
<html>
<head>
   <title>CALC</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="CALC,CALCULATE" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "calc.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">CALC, CALCULATE</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="by_exp_dsnd.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="col_hdg.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CALC</span> keyword prefixes an I-type field name or an evaluated expression and causes the calculation to be performed on the total lines, possibly using accumulated values from the detail lines.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">CALC</span> <span style="font-style: italic;">field</span> </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">field</span></td><td style="border:none;padding:0">is the I-type field or expression for which the calculation is to be performed.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CALC</span> keyword is normally used in conjunction with the I-type  <span style="font-weight: bold;"><a href="qmb_total.htm" class="topiclink">TOTAL()</a></span> function. During detail lines, the <span style="font-weight: bold;"><a href="qmb_total.htm" class="topiclink">TOTAL()</a></span> function accumulates values which are then used on the subtotal and grand total lines to calculate the value in the column to which the <span style="font-weight: bold;">CALC</span> keyword applies.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CALC</span> keyword can be used for any other expression to be evaluated at breakpoints and at the end of the report. See the <span style="font-weight: bold;">BREAK.SUP</span> keyword for an example of using this with the X breakpoint control option.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Example</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>We have a file which includes a calculated PROFIT item defined as</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">100 * (SELL - COST) / COST</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The command</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST PARTS AVG COST AVG SELL AVG PROFIT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This might produce a report such as that below</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST PARTS AVG COST AVG SELL AVG PROFIT</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">Part &nbsp; Cost. &nbsp; &nbsp;Sell. &nbsp;Profit%</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 101 &nbsp; 10.00 &nbsp; &nbsp;13.00 &nbsp; &nbsp;30.00</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 102 &nbsp; 15.00 &nbsp; &nbsp;18.00 &nbsp; &nbsp;20.00</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 103 &nbsp; 14.00 &nbsp; &nbsp;17.00 &nbsp; &nbsp;21.43</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; ===== &nbsp; &nbsp;===== &nbsp; &nbsp;=====</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; 13.00 &nbsp; &nbsp;16.00 &nbsp; &nbsp;23.81</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 3 records listed.</span></p>
<p> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; </p>
<p>The average profit figure (23.81) is the average of the figures in the column above it. Perhaps what we really want to show is the percentage profit selling for 16.00 something that cost us 13.00 (the average cost and selling prices). To do this, the PROFIT expression is changed to</p>
<p style="margin: 6px 0 6px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">100 * (TOTAL(SELL) - TOTAL(COST)) / TOTAL(COST)</span></p>
<p>or, more simply,</p>
<p style="margin: 6px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">100 * TOTAL(SELL - COST) / TOTAL(COST)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The command</p>
<p style="margin: 6px 0 6px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST PARTS AVG COST AVG SELL CALC PROFIT</span></p>
<p>now produces</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LIST PARTS AVG COST AVG SELL CALC PROFIT</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">Part &nbsp; Cost. &nbsp; &nbsp;Sell. &nbsp;Profit%</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 101 &nbsp; 10.00 &nbsp; &nbsp;13.00 &nbsp; &nbsp;30.00</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 102 &nbsp; 15.00 &nbsp; &nbsp;18.00 &nbsp; &nbsp;20.00</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> 103 &nbsp; 14.00 &nbsp; &nbsp;17.00 &nbsp; &nbsp;21.43</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; ===== &nbsp; &nbsp;===== &nbsp; &nbsp;=====</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; 13.00 &nbsp; &nbsp;16.00 &nbsp; &nbsp;23.08</span></p>
<p style="page-break-inside: avoid; margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">3 records listed.</span></p>

</td></tr></table>

</body>
</html>
