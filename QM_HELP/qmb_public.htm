<!DOCTYPE html>
<html>
<head>
   <title>PUBLIC</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="GET,PUBLIC,SET" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_public.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">PUBLIC</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_pterm.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_pwr.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">PUBLIC</span> statement defines public property variables, subroutines and functions in a class module.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">PUBLIC</span> <span style="font-style: italic;">var </span>{<span style="font-weight: bold;">READONLY</span>} {<span style="font-weight: bold;">=</span> <span style="font-style: italic;">value</span>}<span style="font-weight: bold;">, </span><span style="font-style: italic;">mat</span><span style="font-weight: bold;">(</span><span style="font-style: italic;">rows</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">cols</span><span style="font-weight: bold;">),</span> ...</p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">PUBLIC SUBROUTINE</span> <span style="font-style: italic;">name</span>{<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">arg2</span><span style="font-weight: bold;">)</span>} {<span style="font-weight: bold;">VAR.ARGS</span>}</p>
<p style="margin: 0 0 0 30px;">...<span style="font-style: italic;">statements</span>...</p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">END</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">PUBLIC FUNCTION</span> <span style="font-style: italic;">name</span>{<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">arg2</span><span style="font-weight: bold;">)</span>} {<span style="font-weight: bold;">VAR.ARGS</span>}</p>
<p style="margin: 0 0 0 30px;">...<span style="font-style: italic;">statements</span>...</p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">var</span></td><td style="border:none;padding:0">is a simple scalar variable. The variable name may be followed by <span style="font-weight: bold;">READONLY</span> to indicate that external references to the variable may not update it.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">mat</span><span style="font-weight: bold;">(</span><span style="font-style: italic;">rows</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">cols</span><span style="font-weight: bold;">)</span></td><td style="border:none;padding:0">is a dimensioned matrix name. The <span style="font-style: italic;">rows</span> and <span style="font-style: italic;">cols</span> values must be numeric constants. The dimension values may be followed by <span style="font-weight: bold;">READONLY</span> to indicate that external references to the variable may not update it.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">name</span><span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span><span style="font-weight: bold;">,</span> <span style="font-style: italic;">arg2</span><span style="font-weight: bold;">)</span></td><td style="border:none;padding:0">is the subroutine or function name and an optional list of arguments. See the <span style="font-weight: bold;"><a href="qmb_class.htm" class="topiclink">CLASS</a></span> statement for the maximum number of arguments allowed in this list. &nbsp;Specifying the final argument name as three periods (...) effectively extends the argument list to the maximum permissible length with unnamed scalar arguments that may be accessed using the <span style="font-weight: bold;"><a href="qmb_arg.htm" class="topiclink">ARG()</a></span> function. Use of this syntax automatically implies the VAR.ARGS option which must not also be present.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Note that the equivalence of a function to a subroutine with a hidden first argument as found with the <span style="font-weight: bold;"><a href="qmb_subroutine.htm" class="topiclink">SUBROUTINE</a></span> and <span style="font-weight: bold;"><a href="qmb_function.htm" class="topiclink">FUNCTION</a></span> statements does not apply to public subroutines and functions.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The first form of the <span style="font-weight: bold;">PUBLIC</span> statement defines persistent variables that may be visible from outside the object in which they appear. Public variables are initially unassigned unless an initialisation <span style="font-style: italic;">value</span> is present. If used, <span style="font-style: italic;">value</span> must be a numeric or string constant, a <span style="font-weight: bold;"><a href="qmb_char.htm" class="topiclink">CHAR()</a></span> or <span style="font-weight: bold;"><a href="qmb_echar.htm" class="topiclink">ECHAR()</a></span> function with a numeric constant argument, or a constant @-variable name. An initialisation value may be provided for a <span style="font-style: italic;">mat</span> declaration and is equivalent to use of the <span style="font-weight: bold;"><a href="qmb_mat.htm" class="topiclink">MAT</a></span> statement to set all elements to the given <span style="font-style: italic;">value</span>. The initialisation is applied prior to execution of the <span style="font-weight: bold;">CREATE.OBJECT</span> subroutine, if present.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The second and third forms of the PUBLIC statement define a subroutine or function that can be referenced from outside the object. The synonyms <span style="font-weight: bold;">GET</span> and <span style="font-weight: bold;">SET</span> may be used for <span style="font-weight: bold;">PUBLIC FUNCTION</span> and <span style="font-weight: bold;">PUBLIC SUBROUTINE</span> respectively.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Arguments to public subroutines and functions may reference a whole matrix by following the matrix name by its dimensions. The actual values given are ignored; the compiler simply counts them to determine whether the matrix has one or two dimensions. For example:</p>
<p style="margin: 6px 0 6px 29px;"><span style="font-family: 'Courier New',Courier,monospace;">PUBLIC SUBROUTINE CALC(CLIENT, CLI.REC(1), TOTVAL)</span></p>
<p>In this example, the dimension value has been shown as 1 to emphasise that the actual value is irrelevant. The compiler uses this purely to determine that CLI.REC is a single dimensional matrix, possibly representing a database record read using <span style="font-weight: bold;"><a href="qmb_matread.htm" class="topiclink">MATREAD</a></span>. The alternative syntax used with <span style="font-weight: bold;"><a href="qmb_subroutine.htm" class="topiclink">SUBROUTINE</a></span> statements by prefixing the matrix name with <span style="font-weight: bold;"><a href="qmb_mat.htm" class="topiclink">MAT</a></span> and using a  <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIMENSION</a></span> statement to set dimensionality is not available for public subroutines and functions.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The number of arguments in calls to the subroutine or function must be the same as in the declaration unless the <span style="font-weight: bold;">VAR.ARGS</span> option is used in which case any arguments not passed by the caller will be unassigned. The <span style="font-weight: bold;"><a href="qmb_arg_count.htm" class="topiclink">ARG.COUNT()</a></span> function can be used to determine the actual number of arguments passed, excluding the hidden return argument. The <span style="font-weight: bold;"><a href="qmb_arg_present.htm" class="topiclink">ARG.PRESENT()</a></span> function can be used to test for the presence of an optional argument by name.</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">PUBLIC FUNCTION CREDIT.RATING(CLIENT, CLASS, CODE) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS and CODE variables will be unassigned. If the calling program provides two arguments, the CODE variable will &nbsp;be unassigned.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When using <span style="font-weight: bold;">VAR.ARGS</span>, default values may be provided for any arguments by following the argument name with an = sign and the required numeric or string value or the @FALSE or @TRUE constants. For example,</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">PUBLIC FUNCTION CREDIT.RATING(CLIENT, CLASS = 1, CODE = &quot;Standard&quot;) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS variable will default to 1 and the CODE variable will default to &quot;Standard&quot;. If the calling program provides two arguments, the default value for CLASS is ignored and the CODE variable defaults to &quot;Standard&quot;.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">PUBLIC FUNCTION CONNECT(SERVER, PORT)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; SKT = OPEN.SOCKET(SERVER, PORT, SKT$BLOCKING)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; RETURN STATUS() = 0</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above function takes a fixed length list of two arguments and uses the supplied values to open a socket connection to a remote server. The SKT variable in this example would be a private variable within the class module.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">PUBLIC FUNCTION CONNECT(SERVER, PORT) VAR.ARGS</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; IF UNASSIGNED(PORT) THEN PORT = 4000</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; SKT = OPEN.SOCKET(SERVER, PORT, SKT$BLOCKING)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; RETURN STATUS() = 0</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This example extends the previous one by making the PORT argument optional and, if it is not supplied by the caller, defaulting it to 4000.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">PUBLIC SUBROUTINE INSERT.ITEMS(ID, ...)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; READU REC FROM FVAR, ID ELSE NULL</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; FOR I = 2 TO ARG.COUNT()</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;VALUE = ARG(I)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;LOCATE VALUE IN REC&lt;1&gt; BY 'AL' SETTING POS ELSE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp; &nbsp; INS VALUE BEFORE REC&lt;POS&gt;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;END</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; NEXT I</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; WRITE REC TO FVAR, ID</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This example uses the ... syntax to specify a variable length argument list of the maximum permissible length. It reads a record identified by the ID argument and then inserts all items from the remaining arguments that are not already in the record.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><a href="qmbasic_objects.htm" class="topiclink">Object oriented programming</a>, <span style="font-weight: bold;"><a href="qmb_class.htm" class="topiclink">CLASS</a></span>, <span style="font-weight: bold;"><a href="qmb_disinherit.htm" class="topiclink">DISINHERIT</a></span>, <span style="font-weight: bold;"><a href="qmb_inherit.htm" class="topiclink">INHERIT</a></span>, <span style="font-weight: bold;"><a href="qmb_object.htm" class="topiclink">OBJECT()</a></span>, <span style="font-weight: bold;"><a href="qmb_private.htm" class="topiclink">PRIVATE</a></span>, <span style="font-weight: bold;"><a href="qmb_restricted.htm" class="topiclink">RESTRICTED</a></span>, <span style="font-weight: bold;"><a href="qmb_shared.htm" class="topiclink">SHARED</a></span></p>

</td></tr></table>

</body>
</html>
