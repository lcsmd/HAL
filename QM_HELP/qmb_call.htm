<!DOCTYPE html>
<html>
<head>
   <title>CALL, ENTER</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="CALL,ENTER" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_call.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">CALL, ENTER</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_bscan.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_casing.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">CALL</span> statement calls a catalogued subroutine. The <span style="font-weight: bold;">ENTER</span> statement is a synonym for <span style="font-weight: bold;">CALL</span> unless the PICK.ENTER option of the <span style="font-weight: bold;">$MODE</span> directive is used.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">CALL</span> <span style="font-style: italic;">name</span> {(<span style="font-style: italic;">arg.list</span>)}</p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">CALL</span> <span style="font-weight: bold;">@</span><span style="font-style: italic;">var</span> {(<span style="font-style: italic;">arg.list</span>)}</p>
<p style="margin: 10px 0 0 30px;"><span style="font-weight: bold;">CALL</span> &quot;<span style="font-style: italic;">file name</span>&quot; {(<span style="font-style: italic;">arg.list</span>)}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of the subroutine to be called.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">@var</span></td><td style="border:none;padding:0">is the name of a variable holding the name of the subroutine to be called.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">arg.list</span></td><td style="border:none;padding:0">is the list of arguments to the subroutine.</td></tr></table></div><p style="text-indent: -90px; margin: 0 0 0 120px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:90px"><span style="font-style: italic;">file</span></td><td style="border:none;padding:0">is the name of the file containing the subroutine to be called.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A subroutine with no arguments is equivalent to a program. A whole matrix can be passed as an argument by prefixing it with <span style="font-weight: bold;">MAT</span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Direct Calls</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Placing the subroutine name in the <span style="font-weight: bold;">CALL</span> statement as in the first syntax shown above is referred to as a <span style="font-weight: bold;">direct call</span>. QM will search for the subroutine as described below when any <span style="font-weight: bold;">CALL</span> statement referencing the subroutine is first executed in the program or subroutine. For <span style="font-weight: bold;">CALL</span> statements which occur within catalogued subroutines the search will take place every time the calling subroutine itself is called. QM includes an object code caching mechanism to minimise the performance impact of this repeated search.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Indirect Calls</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The second syntax executes a <span style="font-weight: bold;">CALL</span> statement using a variable to hold the subroutine name and is referred to as an <span style="font-weight: bold;">indirect call</span>. In this case, QM will search for the subroutine as described below when the first <span style="font-weight: bold;">CALL</span> statement is executed. Indirect calls allow an application to call a subroutine where the name of the routine was not known at compile time. This might be of use, for example, in menu systems.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When an indirect call is executed, the variable containing the subroutine name is modified to become a subroutine reference. This can still be used as a string in the program but also contains a pointer to the memory resident copy of the subroutine. The subroutine will remain in memory so long as one or more subroutine references point to it. Overwriting the variable will destroy the subroutine link and may make the subroutine a candidate for removal from the object code cache.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>One advantage of indirect calls is that, by placing the variable in a common block where it is accessible by all modules of the application and will not be discarded, the catalogue search need only be performed once even when the <span style="font-weight: bold;">CALL</span> is in a subroutine which itself may be called many times. A direct call works in a similar way but the variable in which the subroutine reference is placed is local to the program containing the <span style="font-weight: bold;">CALL</span> and is thus lost when the program terminates.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the string stored in the variable used in an indirect call contains a space, this is taken as being a Pick style subroutine reference described below.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Searching for the Subroutine</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Subroutines to be executed using <span style="font-weight: bold;">CALL</span> must be placed in the catalogue using the <span style="font-weight: bold;"><a href="catalogue.htm" class="topiclink">CATALOGUE</a></span> command or the equivalent automated cataloguing from within the QMBasic compiler.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Subroutine names must conform to the QMBasic name formats except that two special prefix characters are allow. An exclamation mark prefix character is used on all standard globally catalogued subroutines provided as part of QM that are intended for user use. An asterisk prefix may be used on user written globally catalogued subroutines for compatibility with other products.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Unless the subroutine name commences with one of the global catalogue prefix characters, QM goes through a series of steps when a <span style="font-weight: bold;">CALL</span> statement searches for a subroutine:</p>
<p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:30px;margin-left:-30px">&#8226;</span>The local catalogue is checked. This consists of a VOC record of the form</p><p style="margin: 0 0 0 90px;">Field 1 &nbsp; &nbsp; &nbsp; &nbsp;V</p>
<p style="margin: 0 0 0 90px;">Field 2 &nbsp; &nbsp; &nbsp; &nbsp;CS</p>
<p style="margin: 0 0 0 90px;">Field 3 &nbsp; &nbsp; &nbsp; &nbsp;Runfile pathname</p>
<p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:30px;margin-left:-30px">&#8226;</span>The private catalogue file is checked.</p><p style="text-indent: 0; padding-left: 30px; margin: 10px 0 0 30px;"><span class="f_Normal" style="font-family: Arial,'Lucida Sans Unicode','Lucida Grande','Lucida Sans';display:inline-block;width:30px;margin-left:-30px">&#8226;</span>The global catalogue is checked. </p><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Note that subsequent calls to the same subroutine where the subroutine reference has not been reset will continue to use the original catalogued routine even if it has been deleted from the catalogue or replaced.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Pick Style Call with a File Name</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The third syntax of <span style="font-weight: bold;">CALL</span>,</p>
<p style="margin: 10px 0 10px 30px;"><span style="font-weight: bold;">CALL</span> &quot;<span style="font-style: italic;">file name</span>&quot; {(<span style="font-style: italic;">arg.list</span>)}</p>
<p>allows a program to specify subroutine to be called by its file and program name. The <span style="font-style: italic;">file</span> element of this syntax is the case sensitive name of the file containing the compiled program. A suffix of .OUT is added to this name automatically. Extended file name syntaxes are supported where permitted by the value of the <a href="configparams.htm#filerule" class="topiclink">FILERULE</a> configuration parameter. The <span style="font-style: italic;">name</span> element is the name of the program within the specified file. On platforms with case sensitive file systems, the casing of this name must match that of the stored program. The program is loaded directly from the specified location instead of following the catalogue search process described above.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Arguments</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The argument list may contain up to 255 items. If a subroutine has no arguments, the brackets may be omitted.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Each argument is</p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:331px">A constant</td><td style="border:none;padding:0"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUB(&quot;MY.FILE&quot;)</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:331px">An expression</td><td style="border:none;padding:0"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUB(X + 7)</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:331px">A variable name</td><td style="border:none;padding:0"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUB(X)</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:331px">An indexed matrix element name</td><td style="border:none;padding:0"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUB(A(5,2))</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:331px">A matrix name prefixed by MAT</td><td style="border:none;padding:0"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUB(MAT A)</span></td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Where the argument is a reference to a variable, a matrix element or a whole matrix, the subroutine may update the values in these variables. Except when passing a whole matrix, the calling program can effectively prevent this by forcing the argument to be passed by value rather than by reference by enclosing it in brackets, thus making the argument into an expression.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Forced Reload of Object Code</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Whenever a program is compiled or catalogued, an event is signalled to all QM processes to cause them to unload any inactive programs from the object code cache. In this context, an inactive program is one that is not the currently executing program, an earlier one in the hierarchy of subroutine calls, or one that has a subroutine reference variable pointing to it.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the FORCE.RELOAD mode of the <span style="font-weight: bold;"><a href="option.htm" class="topiclink">OPTION</a></span> command is in effect, this mechanism is extended such that all subroutine link variables are reset. The next call to the subroutine will reload the object code. This allows dynamic modification of an application in a production environment but carries the risk that a simple loop such as</p>
<p style="margin: 6px 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">FOR I = 1 TO 5</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; CALL MYSUB</span></p>
<p style="margin: 0 0 6px 30px;"><span style="font-family: 'Courier New',Courier,monospace;">NEXT I</span></p>
<p>might call a different version of MYSUB from one iteration of the loop to the next.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Note that the event causes all subroutine links to be reset, not just those for the program that has been compiled or catalogued, however, it does not apply to instantiated objects. Note also that the FORCE.RELOAD option must be set in the QM session that is to perform the reload, not necessarily in the session that compiles or catalogues the program.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 20px 0 5px 0;"><span style="font-weight: bold;">Pick Style ENTER</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>By default, the <span style="font-weight: bold;">ENTER</span> statement is a synonym for <span style="font-weight: bold;">CALL</span>. Use of the PICK.ENTER option of the <span style="font-weight: bold;"><a href="qmbd_mode.htm" class="topiclink">$MODE</a></span> compiler directive causes <span style="font-weight: bold;">ENTER</span> to behave in the same way as its equivalent in Pick style multivalue database products.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>In this mode, use of <span style="font-weight: bold;">ENTER</span> terminates the current program and replaces it with the named program. This new program may not take arguments. If the <span style="font-weight: bold;">ENTER</span> statement is performed in a program that was started using the <span style="font-weight: bold;"><a href="qmb_execute.htm" class="topiclink">EXECUTE</a></span> statement, or a subroutine called from such a program, the <span style="font-weight: bold;">ENTER</span> does not discard the program containing the <span style="font-weight: bold;"><a href="qmb_execute.htm" class="topiclink">EXECUTE</a></span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">COMMON /COM1/ INITIALISED, SUB1</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">IF NOT(INITIALISED) THEN</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;SUB1 = &quot;SUBR1&quot;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp;INITIALISED = @TRUE</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment declares a common block to hold subroutine call references. When the program is first executed, the conditional statements will be performed as common block variables are initially zero. This path sets the name of the subroutine SUBR1 into common variable SUB1.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Later in the program, perhaps in a different subroutine from that in which the common was initialised, a statement of the form</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">CALL @SUB1(ARG1, ARG2)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>will call the SUBR1, changing the common variable to be a subroutine reference for fast access on subsequent calls.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A statement of the form</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">CALL SUBR1(ARG1, ARG2)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>would call the same subroutine but does not use the common block variable. If this call was in a subroutine, the catalogue search would be performed for the first call each time the calling subroutine is entered.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="catalogue.htm" class="topiclink">CATALOGUE</a></span></p>

</td></tr></table>

</body>
</html>
