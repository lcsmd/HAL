<!DOCTYPE html>
<html>
<head>
   <title>COMPARE(), COMPARES()</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="COMPARE(),COMPARES()" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_compare.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">COMPARE(), COMPARES()</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_common.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_config.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="page-break-after: avoid;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">COMPARE()</span> function compares two strings using the same rules as the <span style="font-weight: bold;"><a href="qmb_locate.htm" class="topiclink">LOCATE</a></span> statement. The <span style="font-weight: bold;">COMPARES()</span> function is similar but operates on a multivalued list of strings.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">COMPARE(</span><span style="font-style: italic;">string1</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">string2</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">justification</span>}<span style="font-weight: bold;">)</span></p>
<p style="margin: 6px 0 0 30px;"><span style="font-weight: bold;">COMPARES(</span><span style="font-style: italic;">string1</span><span style="font-weight: bold;">, </span><span style="font-style: italic;">string2</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">justification</span>}<span style="font-weight: bold;">)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">string1</span>, <span style="font-style: italic;">string2</span></td><td style="border:none;padding:0">evaluate to the strings to be compared.</td></tr></table></div><p style="text-indent: -150px; margin: 0 0 0 180px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:150px"><span style="font-style: italic;">justification</span></td><td style="border:none;padding:0">evaluates to a string where the first character is &quot;L&quot; for left justified comparison or &quot;R&quot; for right justified comparison. If omitted or invalid, left justification is used. An optional second character of &quot;I&quot; causes the function to compare strings in a case insensitive manner.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">COMPARE()</span> function compares the two strings and returns </p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:60px">1</td><td style="border:none;padding:0"><span style="font-style: italic;">string1</span> is greater than <span style="font-style: italic;">string2</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:60px">0</td><td style="border:none;padding:0"><span style="font-style: italic;">string1</span> is equal to <span style="font-style: italic;">string2</span></td></tr></table></div><div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 10px 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:60px">-1</td><td style="border:none;padding:0"><span style="font-style: italic;">string1</span> is less than <span style="font-style: italic;">string2</span></td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>For a left justified comparison, characters are compared one by one and the function return value is determined by the relative ASCII character set positions of the characters at which the first mismatch occurs. If the strings are of different lengths and match up to the end of the shorter, the longer string is treated as the greater.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>For a right justified comparison, the <span style="font-weight: bold;">COMPARE()</span> function behaves as though sufficient spaces were inserted at the start of the shorter string to match the length of the longer string. Characters are then compared one by one and the function return value is determined by the relative ASCII character set positions of the characters at which the first mismatch occurs.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">COMPARE()</span> statement always compares the two items as character strings unlike a simple relational operator that will perform a numeric comparison if both items can be treated as numbers:</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">X = COMPARE(&quot;0&quot;, &quot;00&quot;)</span></p>
<p style="margin: 5px 0 0 0;">will indicate that the two items are not equal whereas</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">X = (&quot;0&quot; = &quot;00&quot;)</span></p>
<p style="margin: 5px 0 0 0;">will indicate that the two items are equal.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">COMPARE()</span> function is not affected by the setting of the  <span style="font-weight: bold;"><a href="qmbd_mode.htm" class="topiclink">$MODE NOCASE.STRINGS</a></span> compiler directive and can therefore be used to force a case sensitive comparison in otherwise case insensitive programs. The optional I code in the <span style="font-style: italic;">justification</span> argument causes case insensitive comparison.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">COMPARES()</span> function treats <span style="font-style: italic;">string1</span> as a dynamic array, comparing each element in turn with <span style="font-style: italic;">string2</span> and returning a similarly structured dynamic array of results.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">Use of the == operator</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">IF A == B THEN</span></p>
<p class="p_Normal">is equivalent to</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">IF COMPARE(A, B) = 0 THEN</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Examples</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIM ITEM(100)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">ITEMS = 0</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">LOOP</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; INPUT NEW.ITEM</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">WHILE LEN(NEW.ITEM)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; * Find position to insert new item</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; I = 1</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; LOOP</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; WHILE I &lt;= ITEMS</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;IF COMPARE(NEW.ITEM, ITEM(I)) &lt; 0 THEN EXIT</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;I += 1</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; REPEAT</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; * Insert item at position I</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; FOR J = ITEMS TO I STEP - 1</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;ITEM(J + 1) = ITEM(J)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; NEXT J</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; ITEM(I) = NEW.ITEM</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; ITEMS += 1</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">REPEAT</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>This program fragment creates a matrix, ITEMS, and then enters a loop to read NEW.ITEM values from the keyboard until a blank line is entered. Each item read is inserted into the matrix in its correct position to maintain the matrix in ascending collating sequence order. Additional statements to detect and handle matrix overflow would be useful in a full application.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">A = 'AAA':@VM:'BBB':@FM:'CCC'</span></p>
<p class="p_CodeBody"><span class="f_CodeBody">X = COMPARES(A, 'BBB')</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The above program fragment returns X as &quot;-1<span style="font-size: 6pt;">VM</span>0<span style="font-size: 6pt;">FM</span>1&quot;. Note how the mark characters used to delimit A have been replicated in X.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_sort_compare.htm" class="topiclink">SORT.COMPARE()</a></span><a href="qmb_sort_compare.htm" class="topiclink">,</a> <span style="font-weight: bold;"><a href="qmbasic_expressionsandoperators.htm" class="topiclink">==</a></span> and <span style="font-weight: bold;"><a href="qmbasic_expressionsandoperators.htm" class="topiclink">~=</a></span> operators.</p>

</td></tr></table>

</body>
</html>
