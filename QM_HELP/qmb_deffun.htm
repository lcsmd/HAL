<!DOCTYPE html>
<html>
<head>
   <title>DEFFUN</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="DEFFUN" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_deffun.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">DEFFUN</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_decrypt.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_del.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DEFFUN</span> statement defines a function.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">DEFFUN</span> <span style="font-style: italic;">name</span> {<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">arg2</span> ...}<span style="font-weight: bold;">)</span>} {<span style="font-weight: bold;">CALLING &quot;</span><span style="font-style: italic;">func</span><span style="font-weight: bold;">&quot;</span> | <span style="font-style: italic;">expr</span>} {<span style="font-weight: bold;">VAR.ARGS</span>} {<span style="font-weight: bold;">KEY</span> <span style="font-style: italic;">key</span>}</p>
<p style="line-height: 1.38; margin: 10px 0 0 30px;"><span style="font-weight: bold;">DEFFUN</span> <span style="font-style: italic;">name</span> {<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">arg2</span> ...}<span style="font-weight: bold;">)</span>}  <span style="font-weight: bold;">LOCAL</span></p>
<p style="line-height: 1.38; margin: 10px 0 0 30px;"><span style="font-weight: bold;">DEFFUN</span> <span style="font-style: italic;">name</span> {<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">arg2</span> ...}<span style="font-weight: bold;">)</span>}  <span style="font-weight: bold;">EXTERNAL</span> {<span style="font-weight: bold;">CALLING &quot;</span><span style="font-style: italic;">libname</span><span style="font-weight: bold;">&quot;</span>}</p>
<p style="line-height: 1.38; margin: 10px 0 0 30px;"><span style="font-weight: bold;">DEFFUN</span> <span style="font-style: italic;">name</span> {<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">, </span><span style="font-style: italic;">arg2</span> ...}<span style="font-weight: bold;">)</span>}  <span style="font-weight: bold;">EXTERNAL</span> {<span style="font-weight: bold;">CALLING &quot;</span><span style="font-style: italic;">libname</span><span style="font-weight: bold;">:</span><span style="font-style: italic;">funcname</span><span style="font-weight: bold;">&quot;</span>}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of the function.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">arg1, arg2...</span></td><td style="border:none;padding:0">are the function arguments. Up to 254 arguments can be supplied except for external functions where this limit is 31.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">func</span></td><td style="border:none;padding:0">is the catalogue name of the function if different from <span style="font-style: italic;">name</span>.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">expr</span></td><td style="border:none;padding:0">is an expression that evaluates to the catalogue name of the function to be called.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">key</span></td><td style="border:none;padding:0">is a key value to be passed into the subroutine as described below.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">libname</span></td><td style="border:none;padding:0">is the name of the program providing the function. This is case sensitive on Linux systems. The .exe suffix is provided automatically on Windows. If no <span style="font-weight: bold;">CALLING</span> clause is present, the default name &quot;qmextcall&quot; is used.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">funcname</span></td><td style="border:none;padding:0">is the case sensitive name of the function to be called from <span style="font-style: italic;">libname</span>. &nbsp;name of the program providing the function.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">DEFFUN</span> statement defines a function that may be called from within the program. The <span style="font-weight: bold;">DEFFUN</span> statement must appear before the first reference to the function. If the function <span style="font-style: italic;">name</span> matches the name of a built in function, any references to <span style="font-style: italic;">name</span> before the <span style="font-weight: bold;">DEFFUN</span> will call the intrinsic function and references after the <span style="font-weight: bold;">DEFFUN</span> will call the declared function.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If the <span style="font-weight: bold;">LOCAL</span> and <span style="font-weight: bold;">EXTERNAL</span> keywords are not present, the function must correspond to a catalogued item. A call to this function call is effectively translated to a call to a subroutine with an additional hidden first argument through which the result is returned. The optional <span style="font-weight: bold;">CALLING</span> component of the <span style="font-weight: bold;">DEFFUN</span> statement allows the catalogue name of the function to be different from the <span style="font-style: italic;">name</span> of the function itself. This may be specified as a literal string or as an expression that evaluates to the catalogue name. When using an expression, this is evaluated at the point where the function is used, not when the <span style="font-weight: bold;">DEFFUN</span> statement is processed.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">Use of the <span style="font-weight: bold;">LOCAL</span> keyword indicates that this function is internal to the program module and will be defined later in the source by use of the <span style="font-weight: bold;"><a href="qmb_local.htm" class="topiclink">LOCAL FUNCTION</a></span> statement.</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Use of the <span style="font-weight: bold;">EXTERNAL</span> keyword defines reference to a subroutine that is written in some other language such as C and is accessed via the External Call Interface. See <a href="external_functions.htm" class="topiclink">External Functions</a> for more details. When used without the <span style="font-weight: bold;">CALLING</span> clause, use of the QMBasic function will be passed to the qmextcall handler with the uppercase form of <span style="font-style: italic;">name</span> used as the function to be called. If the <span style="font-weight: bold;">CALLING</span> clause is present, the qualifying information may be either just an alternative handler name or it may be a handler name and case sensitive function name separated by a colon. In all cases, the <span style="font-style: italic;">name</span> used within the QMBasic program is case insensitive unless QMBasic case sensitivity has been enabled (see the CASE.SENSITIVE setting of the <a href="qmbd_mode.htm" class="topiclink">$MODE</a> compiler directive).</p>
<p class="p_Normal">&nbsp;</p>
<p>The argument names used in the <span style="font-weight: bold;">DEFFUN</span> statement are for documentation purposes only and have no significance within the program except that the compiler counts them to verify correct use of the function. The variables used in the actual call to the function are determined by the use of the function. Except when defining an external function, an argument may be defined to be a whole matrix in which case it should be prefixed by the keyword <span style="font-weight: bold;">MAT</span> in the <span style="font-weight: bold;">DEFFUN</span> argument list.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The function is used in the same way as the intrinsic functions described in this manual. Although it is not recommended, a function can update its argument variables.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">VAR.ARGS</span> option indicates that compiler should not check the number of arguments in calls to the function. It is of use with functions that take variable length argument lists. This option cannot be used with a local or external function.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">KEY</span> option passes the <span style="font-style: italic;">key</span> value as an additional argument before the first one named in calls to the function. This enables construction of multiple functions that call a single catalogued item with a mode key as the first argument. The <span style="font-weight: bold;"><a href="qmbs_pcl.htm" class="topiclink">!PCL()</a></span> function provided in the BP file of the QMSYS account uses this feature to implement the various PCL functions defined in the SYSCOM PCL.H include record.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Example</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DEFFUN MATMAX(MAT A)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">DIM VALUES(100)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">...</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">MAX = MATMAX(MAT VALUES)</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The program fragment above uses a user supplied MATMAX() function to find the maximum value of all the elements of matrix VALUES.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span><br />
<span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_function.htm" class="topiclink">FUNCTION</a></span>, <span style="font-weight: bold;"><a href="qmb_local.htm" class="topiclink">LOCAL</a></span></p>

</td></tr></table>

</body>
</html>
