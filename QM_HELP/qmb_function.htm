<!DOCTYPE html>
<html>
<head>
   <title>FUNCTION</title>
   <meta name="generator" content="Help &amp; Manual" />
   <meta name="keywords" content="FUNCTION" />
   <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
   <meta http-equiv="Content-Style-Type" content="text/css" />
   <link type="text/css" href="default.css" rel="stylesheet" />
   <script type="text/javascript" src="jquery.js"></script>
   <script type="text/javascript" src="helpman_settings.js"></script>
   <script type="text/javascript" src="helpman_topicinit.js"></script>

   <script type="text/javascript">
     HMSyncTOC("index.html", "qmb_function.htm");
   </script>
   <script type="text/javascript" src="highlight.js"></script>
   <script type="text/javascript">
     $(document).ready(function(){highlight();});
   </script>
</head>
<body style="margin: 0px 0px 0px 0px; background: #FFFFFF;">


<table width="100%" border="0" cellspacing="0" cellpadding="5" bgcolor="#649CCC">
  <tr valign="middle">
    <td align="left">
      <h1 class="p_Heading1"><span class="f_Heading1">FUNCTION</span></h1>

    </td>
    <td align="right">
     <span style="font-size: 9pt">
     <a href="titlepage.htm"><img src="top.gif" border=0 alt="Top"></a>&nbsp;
     <a href="qmb_formlist.htm"><img src="previous.gif" border=0 alt="Previous"></a>&nbsp;
     <a href="qmb_ges.htm"><img src="next.gif" border=0 alt="Next"></a>
     </span>
    </td>
  </tr>
</table>


<!-- Placeholder for topic body. -->
<table width="100%" border="0" cellspacing="0" cellpadding="5"><tr valign="top"><td align="left">
<p style="page-break-after: avoid; margin: 0 0 5px 0;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">FUNCTION</span> statement introduces a user written.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Format</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-weight: bold;">FUNCTION </span><span style="font-style: italic;">name</span>{<span style="font-weight: bold;">(</span><span style="font-style: italic;">arg1</span> {<span style="font-weight: bold;">,</span> <span style="font-style: italic;">arg2</span>...}<span style="font-weight: bold;">)</span> {<span style="font-weight: bold;">VAR.ARGS</span>}}</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>where</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">name</span></td><td style="border:none;padding:0">is the name of the function.</td></tr></table></div><p style="text-indent: -120px; margin: 0 0 0 150px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<div style="text-align: left; text-indent: 0; padding: 0 0 0 0; margin: 0 0 0 30px;"><table style="border:none;border-spacing:0;padding:0;line-height: normal;"><tr style="vertical-align:baseline"><td style="border:none;padding:0;width:120px"><span style="font-style: italic;">arg1</span>, etc</td><td style="border:none;padding:0">are the names of the arguments to the function.</td></tr></table></div><p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>QMBasic programs should commence with a <span style="font-weight: bold;"><a href="qmb_program.htm" class="topiclink">PROGRAM</a></span>, <span style="font-weight: bold;"><a href="qmb_subroutine.htm" class="topiclink">SUBROUTINE</a></span>, <span style="font-weight: bold;">FUNCTION</span> or <span style="font-weight: bold;"><a href="qmb_class.htm" class="topiclink">CLASS</a></span> statement. If none of these is present, the compiler behaves as though a <span style="font-weight: bold;"><a href="qmb_program.htm" class="topiclink">PROGRAM</a></span> statement had been used with <span style="font-style: italic;">name</span> as the name of the source record.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The <span style="font-weight: bold;">FUNCTION </span>statement must appear before any executable statements. The brackets are optional if there are no arguments. The <span style="font-weight: bold;">FUNCTION</span> statement may be split over multiple lines by breaking after a comma.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>The name used in a <span style="font-weight: bold;">FUNCTION</span> statement need not be related to the name of the source record though it is recommended that they are the same as this eases program maintenance. The name must comply with the QMBasic <a href="qmbasic_variablenamesandvalues.htm" class="topiclink">name format rules</a>. </p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>A function is a special form of subroutine. It returns a value to the calling program and can be referenced in a QMBasic statement in the same way as the intrinsic functions described in this manual, without the need for an explicit <span style="font-weight: bold;"><a href="qmb_call.htm" class="topiclink">CALL</a></span> statement. The <span style="font-weight: bold;">FUNCTION</span> statement is equivalent to a <span style="font-weight: bold;"><a href="qmb_subroutine.htm" class="topiclink">SUBROUTINE</a></span> statement with an additional hidden argument at the start which is used to return the result. </p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Variable Length Argument Lists and Default Values</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">The number of arguments in calls to the function must be the same as in the <span style="font-weight: bold;">FUNCTION</span> statement unless the function is declared with the <span style="font-weight: bold;">VAR.ARGS</span> option. When <span style="font-weight: bold;">VAR.ARGS</span> is used, any arguments not passed by the caller will be unassigned. The <span style="font-weight: bold;"><a href="qmb_arg_count.htm" class="topiclink">ARG.COUNT()</a></span> function can be used to determine the actual number of arguments passed, excluding the hidden return argument. The <span style="font-weight: bold;"><a href="qmb_arg_present.htm" class="topiclink">ARG.PRESENT()</a></span> function can be used to test for the presence of an optional argument by name.</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">FUNCTION CREDIT.RATING(CLIENT, CLASS, CODE) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS and CODE variables will be unassigned. If the calling program provides two arguments, the CODE variable will &nbsp;be unassigned.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>When using <span style="font-weight: bold;">VAR.ARGS</span>, default values may be provided for any arguments by following the argument name with an = sign and the required numeric or string value or the @FALSE or @TRUE constants. For example,</p>
<p class="p_CodeSingleLine"><span class="f_CodeSingleLine">FUNCTION CREDIT.RATING(CLIENT, CLASS = 1, CODE = &quot;Standard&quot;) VAR.ARGS</span></p>
<p>In this example, if the calling program supplies only one argument, the CLASS variable will default to 1 and the CODE variable will default to &quot;Standard&quot;. If the calling program provides two arguments, the default value for CLASS is ignored and the CODE variable defaults to &quot;Standard&quot;.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Default argument values can also be provided when the DEFAULT.UNASS.ARGS option of the <a href="qmbd_mode.htm" class="topiclink">$MODE</a> compiler directive is enabled. In this case, the default value will be applied if the argument variable passed from the calling program is unassigned.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal"><span style="font-weight: bold;">Pass By Reference</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">Function arguments are normally passed by reference such that changes made to the argument variable inside a subroutine will be visible in the caller's variable referenced by that argument. A function call allows arguments to be passed by value by enclosing them in brackets. The <span style="font-weight: bold;">FUNCTION</span> statement also supports this dereferencing syntax. For example</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">FUNCTION CREDIT(P, (Q))</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>If dereferencing is used with the default argument syntax described above, the default value is placed inside the parenthesis. For example,</p>
<p class="p_CodeTopLine"><span class="f_CodeTopLine">FUNCTION INVOICE(P, (Q = 7)) VAR.ARGS</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p class="p_Normal"><span style="font-weight: bold;">Matrix Arguments</span></p>
<p class="p_Normal">&nbsp;</p>
<p class="p_Normal">An argument may refer to a whole matrix. In this case the argument variable name must be preceded by the keyword <span style="font-weight: bold;">MAT </span>and there must be a <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span> statement following the function declaration to indicate whether this is a one or two dimensional matrix. Alternatively, the dimensions may be given after the variable name in the <span style="font-weight: bold;">FUNCTION</span> statement. In either case, the actual dimension values are counted by the compiler but otherwise ignored. Use of a dimension value of one emphasises to readers of the program that the value is meaningless. A default style (not Pick style) matrix passed as an argument can be re-dimensioned in the subroutine by use of the <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">REDIMENSION</a></span> (or <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">REDIM</a></span>) statement. Used in any other context, this statement is identical to use of <span style="font-weight: bold;"><a href="qmb_dim.htm" class="topiclink">DIM</a></span>.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p>Programs that use the function must include a <span style="font-weight: bold;"><a href="qmb_deffun.htm" class="topiclink">DEFFUN</a></span> statement to define the function template.</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">Example</span></p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">FUNCTION MATMAX(MAT A)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; DIM A(1)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; MAX = A(1)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; N = INMAT(A)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; FOR I = 1 TO N</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; &nbsp; &nbsp;IF A(I) &gt; MAX THEN MAX = A(I)</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; NEXT I</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;"> &nbsp; RETURN MAX</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">END</span></p>
<p> &nbsp; </p>
<p>This function scans a one dimensional matrix and passes back the value of the largest element. The first two lines could alternatively be written as</p>
<p><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-family: 'Courier New',Courier,monospace;">FUNCTION MATMAX(MAT A(1))</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p style="margin: 0 0 0 30px;"><span style="font-size: 10pt; font-family: Arial,Helvetica,sans-serif; color: #000000;">&nbsp;</span></p>
<p><span style="font-weight: bold;">See also:</span></p>
<p><span style="font-weight: bold;"><a href="qmb_deffun.htm" class="topiclink">DEFFUN</a></span></p>

</td></tr></table>

</body>
</html>
