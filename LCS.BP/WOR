      OPEN 'WORDS' TO F.WORDS ELSE PRINT 'WORDS';STOP
      OPEN 'LCS.TXT' TO F.LCS.TXT ELSE PRINT 'LCS.TXT';STOP
      OPEN 'ROOTS' TO F.ROOTS ELSE PRINT 'ROOTS';STOP
      OPEN 'STUBS' TO F.STUBS ELSE PRINT 'STUBS';STOP
      open 'WORDS.LCS' TO F.WORDS.LCS ELSE PRINT 'WORDS.LCS';STOP

      EXECUTE "CLEAR-FILE DATA ROOTS"
      EXECUTE "CLEAR-FILE DATA WORDS"
      EXECUTE "CLEAR-FILE DATA STUBS"

      READ W.B FROM F.LCS.TXT,"WORDS.TXT" ELSE PRINT "WORDS.TXT";STOP
      CT = DCOUNT(W.B,@FM)
      FOR X = 1 TO CT
         STUB = ""
         W = W.B<X>
         L=LEN(W)
         IF L>3 THEN
            ROOT.ID =  W[1,3]
            READ ROOT.SEQ FROM F.ROOTS,ROOT.ID THEN
               IF NOT(ROOT.SEQ) THEN
                  ROOT.SEQ = 1
               END ELSE
                  ROOT.SEQ += 1
               END
               IF ROOT.SEQ < 100 THEN ROOT.SEQ.F = "0":ROOT.SEQ ELSE ROOT.SEQ.F = ROOT.SEQ
               STUB = ROOT.ID:ROOT.SEQ.F
               WRITE STUB ON F.WORDS,W
               WRITE W ON F.STUBS,STUB
               WRITE ROOT.SEQ ON F.ROOTS,ROOT.ID
            END ELSE
               STUB = W
               WRITE STUB ON F.WORDS,W
               WRITE W ON F.STUBS,STUB
               READ F from F.WORDS.LCS,w then
                  writev F on F.words,w,2
                  writev f on f.stubs,stub,2
               end
            END
            ROOT.SEQ+= 1
            STUB = ROOT.ID
            WRITE ROOT.SEQ ON F.ROOTS,ROOT.ID
            WRITE W ON F.STUBS,STUB
         END ELSE
            STUB = W
            WRITE STUB ON F.STUBS,W
            WRITE W ON F.STUBS,STUB
         END
         IF NOT(MOD(X,100)) THEN PRINT X
      NEXT X
      CLOSE F.ROOTS
      CLOSE F.WORDS
      CLOSE F.LCS.TXT
      END
