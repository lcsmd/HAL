      OPEN 'RULES' TO RULES ELSE PRINT 'RULES' ; STOP
      OPEN 'LCS.CONTROL' TO LCS.CONTROL ELSE PRINT 'LCS.CONTROL' ; STOP
      OPEN "LCS.CSV" TO CSV ELSE PRINT "LCS.CSV" ; STOP
      OPEN "ACCOUNTS" TO ACCOUNTS ELSE PRINT "ACCOUNTS";STOP
      EQU KEYWORD TO RULE.B<1>, PAYEE.NAME TO RULE.B<2>
      EQU ACCT.ID TO RULE.B<3>
      EQU CLASS.NAME TO RULE.B<4>, DEPT.NAME TO RULE.B<5>
      EQU ACCT.NAME  TO ACCT.B<1>
      QBRULES.B = ""
      RULE.CT = 0
     *Housing works   {"ruleConditions":[{"ruleType":10,"value":"-1"},{"ruleType":1,"value":"Housing"}],"isAndRule":true}   {"ruleActions":[{"actionType":5,"value":"HOUSING WORKS       1 (888) 955"},{"actionType":0,"value":"Charity"},{"actionType":2,"value":"Personal"},{"actionType":3,"value":"LCS"},{"actionType":8,"value":true}]}
      *[RuleName] {"ruleConditions":[{"ruleType":10,"value":"-1"},{"ruleType":1,"value":"[RuleKeyword]"}],"isAndRule":true}   {"ruleActions":[{"actionType":5,"value":"[RulePayeeName]       1 (888) 955"},{"actionType":0,"value":"[RuleAccountName]"},{"actionType":2,"value":"[RuleClass]"},{"actionType":3,"value":"[RuleDept]"},{"actionType":8,"value":true}]}

      *     EXECUTE "CLEAR-FILE DATA RULES"
      *     GOSUB UPDATE.RULES1:
      READ RULE.TEMP FROM LCS.CONTROL,"RULE.TEMP" ELSE PRINT 'RULE.TEMP' ; STOP
      PROMPT ""
      *LABELS="RULE.ID RULE.NAME KEYWORD PAYEE.NAME ACCT.NAME CLASS DEPT"
      *LABELS = CHANGE(LABELS," ",@FM)
      SELECT RULES
      CT=0
      *PARM = FIELD(@SENTENCE," ",2)
      LOOP
         *     WHILE READSEQ RULE.B FROM RULES.CSV DO
         *          RULE.B = CHANGE(RULE.B,",",@FM)
      WHILE READNEXT RULE.ID DO
         READ RULE.B FROM RULES,RULE.ID THEN
            *          RULE.NAME = PAYEE.NAME:":":ACCT.NAME
            READ ACCT.B FROM ACCOUNTS,ACCT.ID ELSE ACCT.B = ""
            RULE.NAME = RULE.ID
            NR = RULE.TEMP<1>
            NR = CHANGE(NR,"[RuleName]",RULE.NAME)
            NR = CHANGE(NR,"[RuleKeyword]",KEYWORD)
            NR = CHANGE(NR,"[RulePayeeName]",PAYEE.NAME)
            NR = CHANGE(NR,"[RuleAccountName]",ACCT.NAME)
            IF CLASS.NAME = "" THEN CLASS.NAME = "Practice"
            NR = CHANGE(NR,"[RuleClass]",CLASS.NAME)
            NR = CHANGE(NR,"[RuleDept]",DEPT.NAME)
            *          WRITE RULE.B ON RULES,RULE.NAME
            RULE.CT += 1
            QBRULES.B<RULE.CT> = NR
         END
      REPEAT
      WRITE QBRULES.B ON CSV,"QBRULES.CSV"
      PRINT "FINISHED"
      STOP




