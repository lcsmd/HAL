      function formcsv(darray,options)

      result = ""

      equ comma to ','
      equ tab to char(9)

      equ q to "'"
      equ dq to '"'
      equ ddq to '""'

      if options<1> = 'tab' then
         delim = tab
      end else
         delim = comma
      end

      e.ct = dcount(darray,@fm)
      for e.x = 1 to e.ct
         e =  darray<e.x>
         if delim = comma then
            e = change(e,dq,ddq)
            e = dq:e:dq
         end
         if result="" then
            result = e
         end else
            result = result:delim:e
         end
      next e.x

      return(result)
      end

