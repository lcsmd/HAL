      INCLUDE FILE.EQU FACTS.EQ
      INCLUDE FILE.EQU EXHIBITS.EQ
      INCLUDE FILE.EQU AFF.EQ
      INCLUDE FILE.EQU SECTIONS.EQ
      INCLUDE FILE.EQU POT.EXH.EQ

MAIN:
      GOSUB INIT:
      GOSUB OPEN.FILES:
      *PRINTER ON
      AFF.ID = FIELD(@SENTENCE," ",2)
      READ AFF.B FROM F.AFF,AFF.ID THEN
      GOSUB PRINT.FACT.LIST:
         GOSUB PRINT.AFF.PAGE:
         SECTION.CT = DCOUNT(AFF.SEC.IDS,@VM)
         FOR SEC.X = 1 TO SECTION.CT
            SEC.ID = AFF.SEC.IDS<1,SEC.X>
            READ SEC.B FROM F.SECTIONS,SEC.ID THEN
               GOSUB PRINT.SECTION:
            END
         NEXT SEC.X
      END
      GOSUB PRINT.FACT.LIST:
      GOSUB PRINT.EXHIBIT.LIST:
      STOP

PRINT.SECTION:

      GOSUB NEW.PAGE:
      SECTION.TITLE = "**** ":SEC.NAME:" ****"
      PRINT  SECTION.TITLE "80C"
      PRINT
      LN+=2
      FACT.CT = DCOUNT(SEC.FAC.ID,@VM)
      FOR FACT.X = 1 TO FACT.CT
         FAC.ID = SEC.FAC.ID<1,FACT.X>
         GOSUB PRINT.FACT:
      NEXT FACT.X
      RETURN
      PRINTER OFF
      STOP

PRINT.FACT:
      DATE.OUT=''
      EDATE.OUT = ""
      ENAME.OUT = ""
      enum.out = ""
      READ FAC.B FROM F.FACTS,FAC.ID THEN
         IF FAC.DATE.DESC THEN DATE.OUT = FAC.DATE.DESC ELSE
            IF FAC.DATE THEN DATE.OUT = OCONV(FAC.DATE,"D4-")
         END
         IF FAC.EXH.ID THEN
            EXH.ID = FAC.EXH.ID
            ENUM.OUT = EXH.ID
            READ EXH.B FROM F.EXHIBITS,EXH.ID ELSE EXH.B = ""
            IF EXH.FILE.NAME THEN READ PEX.B FROM F.POT.EXH,EXH.FILE.NAME THEN
               IF PEX.NAME THEN ENAME.OUT = PEX.NAME ELSE ENAME.OUT = EXH.NAME
               IF PEX.DATE.DESC THEN EDATE.OUT = PEX.DATE.DESC ELSE
                  IF PEX.DATE THEN EDATE.OUT = OCONV(PEX.DATE,"D4-") ELSE
                     IF EXH.DATE.DESC THEN EDATE.OUT = EXH.DATE.DESC ELSE
                        IF EXH.DATE THEN EDATE.OUT = OCONV(EXH.DATE,"D4-")
                     END
                  END
               END
            END
         END
      END ELSE FAC.B = ""
      IF (EDATE.OUT AND NOT(DATE.OUT)) THEN DATE.OUT = EDATE.OUT
      GOSUB FORMAT.BODY:
      ECT = DCOUNT(FAC.EXH.ID,@VM)
      IF LN+BOD.LN + ECT > PAGE.MAX THEN GOSUB NEW.PAGE
      FACT.LIST<FACT.X> = FAC.NUM:")  " "7L":BOD2<1>
      PRINT FACT.LIST<FACT.X>
      FOR BOD.X = 2 TO BOD.LN
         PRINT " " "9R":BOD2<BOD.X>
         LN+=1
      NEXT BOD.X
      PRINT
      LN+=1
      FAC.PAGE.NUM = PAGE.NUM
      WRITE FAC.B ON F.FACTS,FAC.ID
      RETURN
      *
      *PRINT.FACT:
      **fac.num.o = fac
      *PRINT    FAC.NUM "5R":".":FAC.DATE.DESC "R#10"
      *PRINT    FAC.BODY
      *RETURN

PRINT.EXHIBIT:
      PRINT
      EXH.CT = DCOUNT(FAC.EXH.ID,@VM)
      FOR EXH.X = 1 TO EXH.CT
         EXH.ID = FAC.EXH.ID<1,EXH.X>
         READ EXH.B FROM F.EXHIBITS,EXH.ID ELSE EXH.B = ""
         PRINT TAB:"*** SEE EXHIBIT ATTACHED: ":EXH.ID:" ":EXH.DATE.DESC
         PRINT TAB:TAB:EXH.NAME
      NEXT EXH.X
      PRINT
      RETURN
      *
      *
NEW.PAGE:
      PRINT@(-1):
      LN=0
      PAGE.NUM +=1
      PRINT PAGE.NUM "80R"
      LN+=1
      PRINT "AFFIDAVIT OF LAWRENCE C. SULLIVAN" "80C"
      PRINT;LN+=1
      PRINT;LN+=1

      RETURN

FORMAT.BODY:
      IF FAC.DATE.DESC THEN
         DATE.OUT = FAC.DATE.DESC
      END ELSE
         IF FAC.DATE THEN
            DATE.OUT = OCONV(FAC.DATE,"D4-")
         END
      END
      BOD1 = FAC.BODY
      BOD2 = ""
      BOD.LN = 1
      LINE.LEN = 0
      IF DATE.OUT THEN
         BOD2<1> = DATE.OUT
         BOD.LN+=1
      END
      WORD.CT = DCOUNT(BOD1," ")
      FOR WX = 1 TO WORD.CT
         NEXT.WORD = FIELD(BOD1," ",WX):" "
         IF LINE.LEN + LEN(NEXT.WORD) > LINE.MAX THEN
            BOD.LN+=1
            LINE.LEN=0
         END
         BOD2<BOD.LN> := NEXT.WORD
         LINE.LEN += LEN(NEXT.WORD)
      NEXT WX
      IF ENUM.OUT THEN
         BOD.LN+=2
         LINE.LEN = 0
         BOD2<BOD.LN> = "*** SEE ATTACHED EXHIBIT:":ENUM.OUT:" ":EDATE.OUT:" : ":ENAME.OUT
      END
      RETURN


      *PRINT.EXHIBITS:
      *FOR EX = 1 TO ECT
      *EXH.ID = FAC.EXH.ID<EX>
      *READ EXH.B FROM F.EXHIBITS,EXH.ID THEN
      *IF EXH.FILE.NAME THEN PEX.ID = EXH.FILE.NAME
      *READ PEX.B FROM F.POT.EXH,PEX.ID THEN
      *IF PEX.DATE THEN EDATE.OUT = OCONV(PEX.DATE,'D4-') ELSE
      *IF PEX.DATE.DESC THEN EDATE.OUT = PEX.DATE.DESC ELSE EDATE.OUT = ""
      *END
      *ENUM.OUT = PEX.ID[1,5]
      *ENAME.OUT = PEX.NAME
      *END
      *IF NOT(EDATE.OUT) THEN
      *IF EXH.DATE THEN EDATE.OUT = OCONV(EXH.DATE,'D4-') ELSE
      *IF EXH.DATE.DESC THEN EDATE.OUT = EXH.DATE.DESC
      *END
      *END
      *EXHIBIT.LINE = SPACE(15):"**** SEE RELATED EXHIBIT :":ENUM.OUT:" ":EDATE.OUT:"  ":ENAME.OUT "80L"
      *PRINT EXHIBIT.LINE
      *EXHIBIT.LIST<EX> = EXHIBIT.LINE
      *LN+=1
      *END
      *NEXT EX
      *PRINT
      *LN+=1
      *RETURN



PRINT.FACT.LIST:
      str = "SORT FACTS WITH AFF.ID = ":AFF.ID:" @S50"
      EXECUTE STR
     
      RETURN

PRINT.EXHIBIT.LIST:
      gosub new.page:
      TITLE = "E X H I B I T   L I S T"
      HEADERS = "EXHIBIT#,DATE,NAME,FACT#,PAGES,PAGE #"
      FOR EXH.X = 1 TO ECT
         PRINT EXHIBIT.LIST<EXH.X>
      NEXT EXH.X
      RETURN
      
 PRINT.MEETINGS:
 
 
 PRINT.GOV.DOCS:


PRINT.AFF.PAGE:
      PRINT @(-1):
      FOR PL = 1 TO 5;PRINT;NEXT PL
      COP =  " A F F I D A V I T  :":AFF.ID
      PRINT COP "80C"
      PRINT
      PRINT
      COP = "Case #:":AFF.CASE.NUM
      PRINT COP "80C"
      print AFF.PLAINTIFS "80C"
      PRINT  "VS" "80C"
      print AFF.DEFENDENTS "80C"
      PRINT
      PRINT "City of "AFF.CITY "80C"
      PRINT "in  County "AFF.COUNTY "80C"
      PRINT AFF.STATE"80C"
      PRINT
      PRINT
      PRINT "COUNSEL FOR PLAINTIFF" "50R"
      PRINT AFF.ATTORNEYS<1> "50R"
      PRINT AFF.ATTORNEYS<2> "50R"

      RETURN

OPEN.FILES:
      OPEN 'LCS.TEXT' TO F.LCS.TEXT ELSE PRINT 'LCS.TEXT';STOP
      OPEN 'AFF' TO F.AFF ELSE PRINT 'AFF';STOP
      OPEN 'SECTIONS' TO F.SECTIONS ELSE PRINT 'SECTIONS';STOP
      OPEN "FACTS" TO F.FACTS ELSE PRINT 'FACTS';STOP
      OPEN "EXHIBITS" TO F.EXHIBITS ELSE PRINT 'EXHIBITS';STOP
      OPEN "POT.EXH" TO F.POT.EXH ELSE PRINT 'POT.EXH';STOP
      RETURN

INIT:
      LABELS = "FACT NUM,DATE,STATED FACT"
      LENGTHS = "8,25,50"
      LABELS = CHANGE(LABELS,",",@FM)
      LENGTHS = CHANGE(LENGTHS,",",@FM)
      LAB.CT = DCOUNT(LABELS,@FM)
      PAGE.LEN = 60
      IND = 10
      TOP.SPACE= 6
      LINE.MAX = 80
      PAGE.MAX = 55
      FORMAT.DATE = "L#25 "
      FORMAT.NUM = "R#8 "
      FORMAT.BODY ="L#80"
      TAB = CHAR(9)
      PG =0
      FACT.R = 0
      EXHIBIT.R = 0
      EXH.B = ""
      FAC.B = ""
      SEC.B= ""
      FACT.LIST = ""
      EXHIBIT.LIST =""
      PAGE.NUM =0
      report=""
      RETURN
      END

