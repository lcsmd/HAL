     PROGRAM ANALYZE.FILE
     FILE.NAME = FIELD(@SENTENCE," ",2)
     IF FILE.NAME THEN
          OPEN "DICT",FILE.NAME TO D.FILE ELSE PRINT "DICT ":FILE.NAME;STOP
          OPEN FILE.NAME TO FILE ELSE PRINT FILE.NAME;STOP
          LABEL.CT = 0
          GOSUB CREATE.ARRAY:
          GOSUB PROCESS.FILE:
          GOSUB SHOW.RESULTS:
     END
     STOP

CREATE.ARRAY:
     EXECUTE "SELECT DICT":FILE.NAME CAPTURING CAP
     READLIST D1 THEN
          D1.CT = DCOUNT(D1,@FM)
          FOR D1.X = 1 TO D1.CT
               AA=D1<D1.X>
               READ D1B FROM D.FILE,AA THEN
                    IF D1B<1> = "D" AND NUM(D1B<2>) THEN
                         LABELS<-1> = AA
                         ATTS<-1> = D1B<2>
                         LABEL.CT += 1
                    END
               END
          NEXT DI.X
     END
     RETURN

PROCESS.FILE:
     SELECT FILE
     CT=0
     LOOP WHILE READNEXT KEY DO
          READ BUFF FROM FILE,KEY THEN
               FOR LX = 1 TO LABEL.CT
                    VALUE = BUFF<LX>
                    IF VALUE <> "" THEN
                         EXISTS<LX> += 1
                         IF NUM(VALUE) THEN NUMS<LX> += 1
                         IF LEN(VALUE) > LONGEST<LX> THEN LONGEST<LX> = LEN(VALUE)
                         IF LEN(VALUE) < SHORTEST<LX> THEN SHORTEST<LX> = LEN(VALUE)
                         IF VALUE > HIGHEST<LX> THEN HIGHEST<LX> = VALUE
                         IF VALUE < LOWEST<LX> THEN LOWEST = VALUE
                    END
               NEXT LX
          END
     REPEAT
     RETURN

SHOW.RESULTS:
     PRINT "ATT" "L#5 ":"EXISTS" "L#10 ":"NUMERIC" "L#10 ":"SHORTEST" "L#5 ":"LONGEST" "L#5 ":"HIGHEST" "L#10 ":"LOWEST" "L#10 "

     FOR LX = 1 TO LABEL.CT
          PRINT ATTS<LX> "L#5 ":EXISTS<LX> "L#10 ":NUMS<LX> "L#10 ":SHORTEST<LX> "L#5 ":LONGEST<LX> "L#5 ":HIGHEST<LX> "L#10 ":LOWEST<LX> "L#10 "
     NEXT LX
     RETURN
