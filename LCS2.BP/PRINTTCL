     ! LCS.BP LISTP
     !
     LM=1
     !
     !
     !-------------------------------------------------------------------------
     *INCLUDE UTLSBP ASSIGN.VAR
      TERM.TYPE = "WYSE"
      CLS = @(-1)
      EOS = @(-3)
      EOL = @(-4)
      PRON = @(-7) ; PROFF = @(-8)
      PREXE = @(-11):@(-102):@(-12)
      IF TERM.TYPE<1> # 'WYSE' THEN PREXE = ''
      C21 = @(0,21):EOL
      C22 = @(0,22):EOL
      C23 = @(0,23):EOL
     STATUS.LINE = @(33,0)
      LON = @(-13) ; LOFF = @(-14) ; DLON = LON ; DLOFF = LOFF
      LULON = LON ; LULOFF = LOFF ; DLULON = LON ; DLULOFF = LOFF
      DMON = '' ; DMOFF = '' ; FON = '' ; FOFF = ''
      FLON = '' ; FLOFF = '' ; ULON = '' ; ULOFF = '' ; VAOFF = ''
      WIDE = '' ; DHSWTOP = '' ; DHSWBOT = '' ; DHDWTOP = '' ; DHDWBOT = ''
      ULA = '+' ; DULA = '+' ; LLA = '+' ; DLLA = '+' ; URA = '+'
      LRA = '+' ; DURA = '+' ; DLRA = '+' ; DVERTLN = '|' ; VERTLN = '|'
      HORZLN = '-' ; DHORZLN = '-' ; UPT = '+' ; DNT = '+' ; CINT = '+'
      RINT = '+' ; LINT = '+' ; DCINT = '+' ; DRINT = '+' ; DLINT = '+'
      DUPT = '+' ; DDNT = '+'
      SDRINT = '+' ; DSRINT = '+' ; SDURA = '+' ; DSURA = '+'
      SDLRA = '+' ; DSLRA = '+' ; SDLINT= '+' ; DSLINT= '+'
      SDUPT = '+' ; DSUPT = '+' ; DSDNT = '+' ; SDDNT = '+'
      DSLLA = '+' ; SDLLA = '+' ; SDULA = '+' ; DSULA = '+'
      DSINT = '+' ; SDINT = '+' ; DSCINT = '+' ; SDCINT = '+'
      FILL1 = LON:' ':LOFF
      FILL2 = LON:'x':LOFF
      FILL3 = LON:'.':LOFF
!

     ! OPEN FILES
     !
     F = ''
     IL = ''
     CMND = ''
     OPEN 'CONTROL'         TO CTRL.F ELSE F=F:', CONTROL'
     OPEN 'MD' TO MD ELSE PRINT 'MD';STOP
     !
     *IF TRIM(F) # '' THEN PRINT FILE.ERRORS:F:BCK:; INPUT NL,1_; STOP
     !
     *READ COMP.B FROM CTRL.F, 'COMPANY' ELSE
          *MSG = 'CONTROL COMPANY Record Missing !'
          *CALL ERRORS.SUB (MSG)
          *STOP
     *END
     !
     *SYNTAX:
     *PRINTTCL {-OPTION} {COMMAND(|COMMAND...)}
     *
     *MULTIPLE TCL COMMANDS CAN BE EXECUTED SEPARATED BY PIPE
     *
     *WITHOUT OPTIONS AND COMMANDS RESULTS IN INTERACTIVE MODE
     *
     *Accepts options:
     *-EMAIL {EMAILADDRESS (EMAILNAME)}
     *-FAX {FAXNUMBER (FAXNAME)}
     *-HOLD
     *-PRINT {PRINTERNAME}
     *-FILE FILENAME (FILETYPE)
     * FILETYPE CAN BE "PDF" WITH FILEPATH REQUIRED (I.E. -FILE PDF filepath)
     * or can be CSV with optional delimiter name.  default is TAB
     * if FILETYPE FILE  is specified or if no filetype is specified then the output is dumped into the file FILENAME.  THE FILE IS CREATED IF IT DOES NOT EXIST
     *
     *
     *
     OPTION = ""
     DEVICE = ""
     PRINTER.NAME = ""
     EMAIL.ADDRESS = ""
     EMAIL.NAME = ""
     FAX.NUM = ""
     FAX.NAME = ""
     FILE.NAME = ""
     FILE.TYPE = ""
     DELIM.NAME = ""
     PDF.PATH = ""
     COMMAND.LINE = ""
     COMMANDS = ""

     COMMAND.LINE = CHANGE(TRIM(@SENTENCE)," ",@FM)
     REMOVE PROG.NAME FROM COMMAND.LINE SETTING SYS.DEL
     IF SYS.DEL THEN
          IF COMMAND.LINE[1,1] = "-" THEN
               REMOVE OPTION FROM COMMAND.LINE SETTING SYS.DEL
               IF OPTION THEN
                    BEGIN CASE
                         CASE OPTION = "-HOLD"
                              DEVICE = "HOLD"
                         CASE OPTION = "-PRINTER"
                              REMOVE PRINTER.NAME FROM COMMAND.LINE SETTING SYS.DEL
                              IF PRINTER.NAME THEN DEVICE = PRINTER.NAME
                         CASE OPTION = "-EMAIL"
                              DEVICE = "EMAIL"
                              REMOVE EMAIL.ADDRESS FROM COMMAND.LINE SETTING SYS.DEL
                              IF SYS.DEL THEN
                                   REMOVE EMAIL.NAME FROM COMMAND.LINE SETTING SYS.DEL
                              END
                         CASE OPTION = "-FAX"
                              DEVICE = "FAX"
                              REMOVE FAX.NUM FROM COMMAND.LINE SETTING SYS.DEL
                              IF SYS.DEL THEN
                                   REMOVE FAX.NAME FROM COMMAND.LINE SETTING SYS.DEL
                              END
                         CASE OPTION = "-FILE"
                              DEVICEB = "FILE"
                              REMOVE FILE.NAME FROM COMMAND.LINE SETTING SYS.DEL
                              IF SYS.DEL THEN REMOVE FILE.TYPE FROM COMMAND.LINE SETTING SYS.DEL
                              IF FILE.TYPE = "" THEN FILE.TYPE = "FILE"
                              IF FILE.TYPE = "CSV" THEN REMOVE DELIM.NAME FROM COMMAND.LINE SETTING SYS.DEL
                              IF FILE.TYPE = "PDF" THEN REMOVE PDF.PATH FROM COMMAND.LINE SETTING SYS.DEL
                    END CASE
               END
          END
     END
     IF COMMAND.LINE THEN IBUFF = COMMAND.LINE
     IF LM THEN
          IF OPTION = "" AND IBUFF = "" THEN PRINT "COMPLETE INTERACTIVE MODE"
          IF OPTION THEN
               PRINT "OPTION: ":OPTION
               IF DEVICE THEN PRINT "DEVICE:":DEVICE
               IF PRINTER.NAME THEN PRINT "PRINTER NAME:":PRINTER.NAME
               IF EMAIL.ADDRESS THEN PRINT "EMAIL ADDRESS:":EMAIL.ADDRESS
               IF EMAIL.NAME THEN PRINT "EMAIL NAME:":EMAIL.NAME
               IF FAX.NUM THEN PRINT "FAX NUM:":FAX.NUM
               IF FAX.NAME THEN PRINT "FAX NAME:":FAX.NAME
               IF FILE.NAME THEN PRINT "FILE NAME:":FILE.NAME
               IF FILE.TYPE THEN PRINT "FILE TYPE:":FILE.TYPE
               IF DELIM.NAME THEN PRINT "DELIM NAME:":DELIM.NAME
               IF PDF.PATH THEN PRINT "PDF PATH:":PDF.PATH
          END
          IF IBUFF THEN
               IBUFF.CT = DCOUNT(IBUFF,@FM)
               IF IBUFF.CT  THEN
                    PRINT "TCL COMMANDS TO BE EXECUTED:"

                    FOR IBUFF.X = 1 TO IBUFF.CT
                         PRINT SPACE(5):IBUFF<IBUFF.X>
                    NEXT IBUFF.X
               END
          END ELSE PRINT "NO TCL COMMANDS SENT"
     END





     ! USER INFORMATION
     !
    
    
  
     *CALL USERINFO (CTRL.F, ONAME, UCODE, ULEVEL, INTLS, '')
     !
     ! CHECK FOR VALID ACCESS LEVEL
     !
     PATH = 'PRINT PROGRAM SOURCE'
     *      CALL ACCESS.SUB (CTRL.F, PATH, VALID, REDISPLAY)
     *      IF NOT(VALID) THEN STOP
     !
     TITLE = 'PRINT TCL OUTPUT'
     SCR = CLS
     *CALL SCREENTITLE (TITLE, NEWTITLE, COL)
     *SCR = SCR:@(COL,0):WIDE:NEWTITLE
100  PRINT SCR
     PRINT @(5,3):"ENTER TCL COMMANDS -- TYPE 'DONE' WHEN FINISHED :"
     LN = 0
     IF COMMANDS = "" THEN
          LOOP
               LN = LN + 1
               CALL CIP(1,LN+3,79,'',IBUFF,ESCFLG,'')
               IF ESCFLG THEN GOTO 900
               IF IBUFF # "DONE" THEN IL<-1> = IBUFF
          UNTIL IBUFF = "DONE" REPEAT
     END ELSE IBUFF = COMMANDS
     !
     ! OK TO CONTINUE
     !
     *LOOP
     *PRINT C22:@(20):'OK to CONTNUE ? (Y)es/(N)o   [ ]'
     *XMISC='';CALL CIP(50,22,1,'',RESP,ESCFLG,XMISC)
     *IF ESCFLG THEN STOP
     *UNTIL RESP = 'Y' ! RESP = 'N' DO REPEAT
     *IF RESP = 'N' THEN STOP
     !
     !
     ! PRINTER CONTROL
     !
     XMISC = 'O'; XMISC<2> = 'N'; XMISC<3> = 'Y'
     CALL PRINTER.CONTROL (CTRL.F, DEVICE, ESCFLG, XMISC)
     IF ESCFLG THEN STOP
     PRINT C22:@(27):FON:'Selecting, Please Wait...':FOFF:
     !
     ! EXECUTE COMMAND
     !
     *
     LOOP
     WHILE IL # "" DO
          CURLIN = IL<1>
          IF CURLIN > "" THEN
               IF IL<1>[LEN(IL<1>)-1,1] = "_" THEN
                    IL<1> = IL<1>[1,LEN(IL<1>)-1]:IL<2>
                    DEL IL<2>
               END ELSE
                    CMND<-1> = IL<1>
                    PRINT IL<1>
                    DEL IL<1>
               END
          END ELSE DEL IL<1>
     REPEAT
     *CMND='LIST DICT ':FN
     *CNAME = COMP.B<1>
     * CMND = CMND:' HEADING "':"'T' ":SPACE(7):"USER: ":ONAME
     *      CMND = CMND:SPACE(7):"PAGE 'PLL'"
     *      CMND = CMND:CNAME:"'LL'"
     *      NHDR = 'SALES REPORT BY DATE'
     *      CMND = CMND:NHDR:"'LL'"
     *      CMND = CMND:'"'
     *      CMND = CMND:' (P'
     !
     EXECUTE CMND
     CALL PRINTER.CONTROL (CTRL.F, DEVICE, ESCFLG, 'C')
900  END
