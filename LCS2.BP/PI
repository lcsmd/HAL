     OPEN 'INVENT' TO INVENT ELSE PRINT 'INVENT'
     OPEN 'INVENT2' TO INVENT2 ELSE PRINT 'INVENT2'
     OPEN 'VEND.ABB' TO VEND.ABB ELSE PRINT 'VEND.ABB';STOP

     SELECT.STR = 'SSELECT VEND.ABB BY-DSND LEN'

     PRINT SELECT.STR
     EXECUTE SELECT.STR CAPTURING CAP
     READLIST VA.KEYS THEN
          KC =  DCOUNT(VA.KEYS,@FM)
          FOR X = 1 TO KC
               KEY = VA.KEYS<X>
               EXECUTE 'SELECT INVENT WITH DESC = ':KEY:'] AND WITH DESC1 = ""'
               READLIST IKEYS THEN
                    IKC = DCOUNT(IKEYS,@FM)
                    FOR X2 = 1 TO IKC
                         IK = IKEYS<X2>
                         READ IBUFF FROM INVENT,IK THEN
                              IBUFF<28> = KEY
                              CATNUM = CHANGE(IBUFF<3>,IK,"")
                              IBUFF<9> = CATNUM
                              WRITE IBUFF ON INVENT2,IK
                         END
                    NEXT X2
               END
          NEXT X
     END
     STOP
