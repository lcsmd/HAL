{
    "Y0dLgtF4IHM": {
        "title": "Python Face Recognition (Beginner Tutorial)",
        "thumbnail": "https://i.ytimg.com/vi/Y0dLgtF4IHM/hqdefault.jpg",
        "author": "Matthew Berman",
        "date_of_release": "2024-01-22T16:36:25Z",
        "duration": "PT12M36S",
        "view_count": "43418",
        "like_count": "982",
        "comment_count": "46",
        "description": "Let's walk through building facial recognition from completely scratch! We will learn about Python facial recognition libraries, embeddings and vectors, and more! All the code is in Google Colab so it'll be easy for you to recreate. \n\nAiven is the trusted open-source data platform.\nGet $400 in free credits for Aiven using this link: https://bit.ly/48jMVZ6\n\nEnjoy :)\n\nJoin My Newsletter for Regular AI Updates üëáüèº\nhttps://www.matthewberman.com\n\nNeed AI Consulting? ‚úÖ \nhttps://forwardfuture.ai/\n\nRent a GPU (MassedCompute) üöÄ\nhttps://bit.ly/matthew-berman-youtube \nUSE CODE \"MatthewBerman\" for 50% discount\n\nMy Links üîó\nüëâüèª Subscribe: https://www.youtube.com/@matthew_berman\nüëâüèª Twitter:  https://twitter.com/matthewberman\nüëâüèª Discord: https://discord.gg/xxysSXBxFW\nüëâüèª Patreon: https://patreon.com/MatthewBerman\n\nMedia/Sponsorship Inquiries üìà\nhttps://bit.ly/44TC45V\n\nLinks:\nGoogle Colab Code - https://colab.research.google.com/drive/19ulJqMQqk4PfcTx1v3C3cxjvzokrKgZS?usp=sharing\nAiven Tutorial - https://bit.ly/428UyQ8\nFace Recognition Dataset - https://github.com/kipr/opencv/blob/master/data/haarcascades/haarcascade_frontalface_default.xml",
        "transcript": "I'm going to show you how to build your very own facial recognition ml script first I'm going to teach you a little bit about how this stuff works and then we're going to dive right into the code and you can follow along step by step and by the end of this video you will have your very own script that can identify any face within a photo and it turns out it's actually super easy I'm going to give you all the code for it also and we're going to be following along through this tutorial provided by Ivan and Ivan is also the sponsor of today's video so thank you very much and I'll talk a little bit more about what Ivan does as we actually use their service for free in this video so Ivan put together this incredible blog post and tutorial about writing your own image recognition and from the highest level here's what we're going to be doing we're going to have a starting picture like this we're going to detect the faces from this starting picture then we're going to be calculating the embeddings on those faces we're going to store those in postgress squl in a vector column then we're going to take another image of someone from that photo but not the actual photo itself we're going to calculate the embeddings of that new photo then we're going to use that to actually find this person's face within the original photo and it's going to work really well and so for those of you who are wondering what an embedding is it is essentially a vector representation of text and Vector representations are really good at calculating the similarity of two things so let's look at an example so let's start with we have a sentence I love part and if you can imagine for every one of these words we're going to mark it as one or true and then if we look at another sentence that is really similar we can actually do that same calculation again so let's look down here the first one again I love parks and the second sentence we're going to be comparing it against is I love croissants now both have the word I love and now where they differ is Parks and croissants so Parks we have true for I love parks and false for I love croissants and the inverse for croissants false for I love parks and true for I love croissants and this is the simplest way to explain how embeddings work now once we have these two vectors the 1 one 1 0 and 1 1 01 we can compare those two vectors together to see how similar they are now they are similar because they both say I love but they differ in what they love so here it is we calculate something called the distance now as we can see here the distance between love croissant and love Parks is represented with red right here and the closer the entire sentence is the more relevant they are to each other so that's a very basic overview of how embeddings and similarity search works now there are much deeper Dives on it on YouTube I recommend if you want to learn more please go find it but what we're going to focus on today is actually writing code to do facial recognition and it works the same way instead of sentences and text we're taking images and we're converting the images into embeddings and seeing how similar those images are so the first step we need to do is have a source image that we're going to retrieve all the faces for now here's a sample image I'm going to be using a different one and I'll show you that in a minute but what it is looking for are all the faces in this image so it has one two and three perfect now I created this Google collab which you can use I'll drop the link to this in the description below so we're going to need a few libraries to work with and I'll tell you what they are as we go through them and the first one we're going to need is this open CV python library and that is an image recognition library but we're going to install all three of these things I'll explain what the other two libraries are later so go ahead click play and then run so next we're on step one we're going to recognize all the faces from our source image and to do that we're going to import this CV2 Library which is what we just installed and then we have an algorithm now this algorithm right here is already written for us and we actually have to download it and import it into Google collab and it just gives us the tool necessary to recognize faces from an image so to download it and again I'll drop this in the description below we're going to download this hard Cascade frontal face default.xml and we just click this little download button right there next we're going to come back to collab and we're going to upload it to our collab files so you're simply going to take that downloaded XML file and drag it right into this window right there then you're going to rightclick on it and you're going to say copy path and then where it says Al equal you're going to replace this with the actual path of the file there we go now it knows where to find it right here next it's loading up the algorithm right there we don't need to do anything and then right here is where we have our source image and for this one I'm going to be using an image of the Always Sunny from Philadelphia cast one of my favorite shows so I'm going to take that and I'm going to drag it over here as well okay then we right click again copy path and we paste it in right there all right so now we have that source file and again what we're going to be doing right here is just extracting all the faces it can find and in fact let me show you that image real quick so here we go here's the cast photo hopefully it grabs every single face from here sometimes it grabs most of them not all of them but even if it grabs most of them that's okay all right next we're going to load up the image that's what's happening here then we create black and white versions of the image cuz honestly the color doesn't really matter when doing facial recognition so that's what's happening here and then here's where the magic is happening we're actually detecting the faces from the image now there are a few settings here gray image is the actual image scale factor is the compression amount and we don't need to mess with that at all Min neighbors is how many neighboring faces to find when it does find one and we're going to update this to be five and then the minimum size in pixels of a face and we'll leave that as 100 by 100 then it's going to detect all the faces it's going to cycle through it that's what we're seeing here and then it's going to create a JPEG of each face and that's it it's ready ready to go so let's see it work so we click play ah I missed one step before we do that we actually have to create a folder called stored faces just like it is right here so let's copy that and then we'll come over here rightclick new folder stored faces hit enter now we'll run it again and it should work and it'll output the images to this stored faces folder and there it is now let's take a look let's make sure it worked right so we'll double click on it and there it is and again and again and again and again so it only grabbed five faces so it's not perfect but it's good enough and if you adjust these settings here you could get better results but we don't need to for now it'll be enough for me to show you how all this works so now that we have each face extracted from that source file what do we do with it now we need to convert those faces into embeddings now to do that we actually need a vector database and this is where Ivan comes in we're going to provision a vector database through Ivan it's super simple I'm going to show it to you and it is completely free so sign up for Ivan and Ivan is a platform that can host all of your data and really adds an incredibly simple abstraction layer on top of all of these other Cloud database providers and they're especially good at AI data it's ivan. and once you do that you're going to be greeted with this dashboard click on projects and you're going to create a project and let's do it faces my organization everything else looks good I'm just going to say create project then you click create service we're going to select the postgress SQL service and we're going to use the Google Cloud trial account and it gives us a bunch of trial credits so we'll just use those for now and everything else can be the same then you just click create service now this does take a little while maybe 5 minutes but we can track its progress pretty easily okay so we have all this information the thing that we're going to need most of all is this service URI and we can just copy a clipboard just like that and then we click next we don't need that we could just keep clicking Skip Skip and then finish setup and if you look right here it says rebuilding I believe it says online when it's done but it turns to green when it's done I forget exactly what it says and so again this might take a little while so what we're going to be doing when it's done and we can get it ready now is click this little quick connect button and then we're going to copy this from the terminal run the following code we're going to click copy right there and what we're doing is we're connecting to the database through PS ql through our terminal now if we switch over to our terminal here it is and I try doing that right now it's going to say could not translate host name and that's because it's not spun up yet so again it takes a little bit but when it's ready we will be able to connect and then I'll show you the next step of actually creating the vector database okay it's done it says running right there so now let's switch back to our terminal and then we're going to paste in that command that we copied psql and then the postgress endpoint that we copied hit enter once you do that it should say default DB right there perfect the first thing we need to do is create the extension Vector so let's do that so here we go create extension Vector colon hit enter and then that's it next we need to create the table called pictures and that's what we'll be doing here so create table and this is just SQL create table pictures and here are the columns it's going to have including the embedding Vector column hit enter and now we're done so now our database is all set up for us I just switched back to Google collab now what we're going to be doing is creating the embedding so converting those images into vectors so here we're going to import our libraries that we need to do those embeddings conversions and here's the IMG beddings which is what we installed earlier now right here where we need to actually connect to our service URI and to grab that switch back to Ivan and right here service URI we're just going to click the copy button right there and then we paste it in so then it's going to look for all of the files in stored fa it's going to open each of those files we're going to convert it into embeddings and then right here we're going to insert we're going to store those embeddings versions of the images in our Vector database and that should be it we should be good to go so let's do that click play Hey you could see all of the images are being converted perfect and now they're stored in our database and it's done that did not take long at all okay now we need a new picture so we have the source picture we have all the faces from the Source picture now we want to get a new picture of someone from that original photo and see if we can match it now to do that I grabbed this photo of Charlie day and we're going to upload that to collab and then we're going to convert it and then we're going to look for matches so let's do that so I'm just going to take it and I'm going to copy it over here by dragging and dropping and we have charlie. jpg I'm going to rightclick on it and say copy path and then right here where it says file name I'm going to highlight that and replace it with charlie. JPG and here it loads the file it gets it ready for converting and then it converts it into an embedding so let's do that okay done now here's where the magic happens what we're going to do is we're going to take that new photo and we're going to look in our old photo for any faces that look like that new photo and we're doing that through embeddings similarity search and the line that really does all the magic is right here so it says select all from pictures and we're going to order by the embeddings similarity so it's it's going to basically say find all the pictures that we stored that are similar to the one that we're uploading right now and then it's going to tell us which one it is so we don't actually have to change anything let's run it and there we go it worked perfectly so here's the image from the original Source photo here's the image that we just compared it to and yep that is the same person different photos but it did a similarity search and it found the right person so that's it now you know how to do facial recognition yourself and write it from scrp scratch how incredible is that and of course you can extend this code and get so much more sophisticated with it I want to hear what you're thinking about building with this let me know in the comments below so thank you again to Ivan for sponsoring this video and making it so easy to provision a database for embeddings use and I'm going to drop a referral Link in the description below to Ivan where you can get an additional $100 of free credits on top of the 300 that they already give you so I really recommend checking them out thanks and if you enjoyed this video please consider giving a like And subscribe and I'll see you in the next one"
    }
}