{
    "cUZ6kkum1pc": {
        "title": "Boost Performance and Security with Traefik Middlewares and Chains",
        "thumbnail": "https://i.ytimg.com/vi/cUZ6kkum1pc/hqdefault.jpg",
        "author": "SmartHomeBeginner",
        "date_of_release": "2024-06-03T13:45:17Z",
        "duration": "PT19M48S",
        "view_count": "742",
        "like_count": "59",
        "comment_count": "9",
        "description": "Traefik proxy is the best dynamic reverse proxy for both Docker and Docker services. Essentially, it allows you to expose your services securely with a proper Let's Encrypt SSL certificate. \n\nBut exposing your services to the internet without proper performance and security measures in place is a mistake. \n\nIn this video, we will see how to use Traefik middlewares to improve performance and security of your Traefik reverse proxy. I will also show you how to simplify your setup using middleware chains.\n\n#traefik #reverseproxy #letsencrypt #cloudflare #homelab #homeserver #docker #dockercompose #dockertutorial \n\nTIMESTAMPS\n0:00 Introduction to Middlewares\n2:07 Recapping Current Setup\n3:25 Improving Traefik Configuration\n4:29 Rate Limit Middleware\n10:55 Secure Headers Middleware\n14:44 Middleware Chains\n18:50 Wrapping up and Next Steps\n\nULTIMATE DOCKER SERVER SERIES:\nPlaylist: https://www.youtube.com/watch?v=GfzgNJAM19o&list=PL1Hno7tIbSWV-c1E87BqTzPMgfGxM08nf\n\nRELEVANT LINKS (in the order of appearance):\nüîó Ultimate Docker Media Server: https://youtu.be/THuLgGwq0vg\nüîó Traefik v3 Setup and Configuration: https://youtu.be/KMZIyoZ3jWM\nüîó Docker Traefik Guide: https://www.smarthomebeginner.com/traefik-docker-compose-guide-2024/\nüîó https://www.smarthomebeginner.com/authelia-docker-compose-guide-2024/\nüîó https://www.smarthomebeginner.com/google-oauth-traefik-forward-auth-2024/\n\nAUTO-TRAEFIK:\nüì∞ https://www.smarthomebeginner.com/go/auto-traefik-ytd/\nüéûÔ∏è https://www.youtube.com/playlist?list=PL1Hno7tIbSWViTyCXl9xNdXXU-1bVxIFD\n\nGITHUB REPOSITORIES:\nüìú https://github.com/htpcbeginner/docker-traefik\n\nMY PROXMOX HOST:\nüñ•Ô∏è Topton V700 Intel i7-13800H Mini PC with 64 GB RAM: https://www.smarthomebeginner.com/go/topton-v700-yt (Affiliate Link)\n\nSUPPORT MY WORK:\nü§ù https://www.smarthomebeginner.com/go/memberships-ytd/\n\nJOIN THE COMMUNITY:\nüëã https://www.smarthomebeginner.com/go/discord-ytd/\nüåê https://www.smarthomebeginner.com/\n\nFOLLOW US ON SOCIAL\nGet updates or reach out to Get updates on our Social Media Profiles!\n\nüë• Twitter: https://twitter.com/anandslab\nüë• Facebook: https://facebook.com/anandslab\nüë• Instagram: https://www.instagram.com/smarthomebeginr\n\nMARKETING PARTNER: https://www.intisarmediaandmarketing.com/",
        "transcript": "so you have traffic and traffic dashboard running but can we make it a bit better and more secure using middlewares and middleware chains let's find out welcome back geek car me an here once again in my last video we did a lot of heavy lifting we had our beautiful traffic version 3 dashboard running and we gave ourselves a big Pat in the back but we didn't put any apps behind traffic it was like I took you to a very nice dinner and right before the desert I chickened out and I sneaked out it was my fault I was getting worried about the length of the video but in my defense it was already 1:15 a.m. and I was getting very tired don't worry let's fix it today well at least partially before we get started just a quick note it is very hard to explain in words the amount of effort I'm putting into making these videos plus here on the left so far what I have spent in making these videos and here's what YouTube ads have made so far as you can imagine it's very hard to sustain without your support so please consider signing up for a membership on my website be a friend like And subscribe while you are here okay back to the topic we're going step by step in building an ultimate Docker media server the link to the playlist is in the description below and if you're lost at any point that link will be your friend in this video we're going to see how to use middlewares and middleware chains to improve your traffic configuration ation just a little bit more and make it more secure and then the stage is set for the climax which is to put apps behind traffic both Docker and non Docker apps so watch out for that video next as always we're going to continue from where we left off a few videos back we had Docker media server up and running with few different apps then I showed you how to use bash adioses to simplify the management and usage of Docker and Docker compost commands this came in very handy with the very very long traffic video and today too you will find we're going to use some of those bash aliases okay here I am on my ultimate traffic version 3 Docker compost guide which is what we used in my traffic video we're going to continue with this guide we have traffic up and running so let's just make sure if that is indeed the case so I am sshed into my ultimate Docker media server if you don't know how we got here watch my previous video let's check what containers are running on the server right now so pseudo Docker PS or the fancy way with the bash aliases DPS and it gives us the same result so here you can see we have traffic version 3 running we also have socket proxy running which is a more secure way of exposing Docker socket so we have traffic up and running let's also make sure if the traffic dashboard is a available so traffic. simple homelab dcom simple homelab do.com is the domain that I used for my videos so here's our fancy basic C popup I have my super secret password which is the same as my username and here we are so traffic is running we have two different routers right there and few different things we're going to be using the dashboard today as we go along first I said let's improve the traffic configuration a little bit and by that I mean we're going to add few more middlewares you can see there's already two that are here one Docker provider which says that all HTTP traffic should be redirected to https traffic which is this one and then we have the basic authentication middleware that was the popup that you guys just saw where I logged in that's what is going to protect our services at least for now keep in mind also I mentioned this in my previous video basic a is an okay protection but it's really easy to break it by Brute Force so I strongly suggest either you implement aelia or Google oat both of these I have guides on my website I will put the link in the description below maybe one day I will cover authentic as well obviously all of these things are also possible with the automation from the autot trffic script if you haven't checked it out a part of it is also free so you can automate a lot of different things without having to pay anything back to the video we're going to continue where we left off as I said we have traffic up and running I said we're going to improve our configuration by that what I meant is we're going to add additional middlewares and middleware chains right first thing we want to do is create a middleware for rate limiting rate limiting what does it do it's a form of protection it basically limits the number of requests that the server receives or can handle in a certain amount of time typically if the server is being attacked let's say by a doos attack there's going to be a lot of requests that take up the resources from your server thereby causing denial of service errors for others who are trying to reach your server so rate limit can come in handy but keep in mind this is not the only protection there are many many higher levels of protection that you can go after I do not claim to be an expert on this topic we are just going to implement a basic rate limit protection so here you can see the middleware we are going to use so we're going to copy paste it's very simple so we're going to copy paste we are not going to make major changes this has worked well for me for years so I'm just going to keep it as is I'm using MOA term as my SSH client as I've explained 10 times probably already I like the SFTP browser that's on the left so I will use that to browse over to the traffic rules folder again all of this was explained in my previous video if you don't want to feel lost check out my previous video so into the app data folder traffic 3 folder Roots folder and udm which is the host name of this device so just like basic o right here that you see we are going to create a new file this is going to be called middlewares rate limit right so as I said I like to prefix all my file providers if you notice these are all file providers in my last video I explained the concept of static and dynamic configuration for traffic these are Dynamic configuration what does that mean anything inside this rules folder will be picked up by traffic automatically without having to restart the service so right now this is empty so we're going to edit this like so and when it opens I'm going to paste what I just copied all you have to do is hit save and we're done now as I said this is a dynamic configuration which means it should take effect immediately which means means if I go into the traffic dashboard and refresh it actually I don't even have to refresh it you see it's already right here so middle Well's rate limit is already active Okay so we're done with this one but we haven't really added it to any of the services yet right as you can see in the guide here's the line that you want to add so how do we do that right now only the traffic dashboard is behind basic authentication now after the basic authentication is done we want to at the rate limit layer right so we are going to do that so how do we do it let's go back to mox's term I am going to open up my Docker compost file for traffic which is inside the compost folder if you're lost once again watch my previous videos I am taking you through a story you will not regret it it's really hard to find such coherent series of videos on how to set up a home lab so check it out now let's edit our traffic our traffic. gaml it's open right here if I scroll down the last line right here unfortunately I can zoom but I will make sure that this is zoomed in when I edit the video right here you can see middle weare's basic uh last line right there so right after this one we are going to add the rate limit middleware how do we do it is just like that in Middle wees rate limit which is what we called it at file why at file is because this middleware is in a file or a file provider which is inside the rules folder so that's why we are doing that now actually you know what um you know what I'm not going to save it right now because I want to show you guys something so going to hit no and it didn't save let's go over to my traffic dashboard right there I have only one service which is traffic so right here is that service so if I go into that I'm going to see all the different things that this service is is using so here is the users file the middleware right now you can see only middleware that is active right now is this one right here basic o so let's go back to my file and we are going to change we already changed it but we'll just have to save it now I can't save it without a change I will save it I'll make a change again save it now so we added the middleware to traffic. yaml which is the compost file now this change that we just made in the compost file it's not Dynamic which means traffic will not pick this up so if I refresh it it's going to be the same page and we're not going to see the middleware right so we will have to restart traffic of course you can use pseudo Docker compost DF and P to the docker compost file and up- D traffic Force recre so this is going to recreate the service with a new middleware long command I just typed it this time so you guys know what it looks like and then from next time on I'm going to use my bash alas cuz I don't want to be typing forever so let's hit that and let's let traffic recreate now it's always always a good idea when you make changes to traffic configuration to check the logs how do we do that tail-f SL home and Docker logs keep going all the way this is how you check the log in real time we should be able to see traffic logs so far I don't see any issues there I don't see any middleware problems and all of that stuff so I think we're good so if I go back to my traffic dashboard I and refresh it maybe in this case I have to refresh it and here I can see already there are two middlewares one basic o and then the rate limit one that we just added so we got two middlewares going already let's do the third one the next one is a big one it's called security headers these offer some sort of protection with the browser so um we're going to do that I do not claim to be a security expert a lot of these things I learned by reading and research over the years so I would be the wrong person to go and explain but what I can tell you is that they have worked really well for me for years I would trust them so and I have a huge community on my Discord server nobody has raised any issues in fact many people people are already using it and so I think it's it's okay to use it but if you guys know more than I do feel free to comment on what I am adding here or if there's a way to make it better I would be interested I am learning from you guys as much as you are trying to learn from me as well so let's go back to my rules folder udm and create a new middleware middle Wares and this time I'm going to call it what was it secure I think it's called secure header I just want to be sure I'm going to go head over to my GitHub repository which if you guys are not familiar with everything that I run on my home and web server is right here there are many different hosts many different Docker compost files scripts whatever you want to call it it's it's it's here for you to get started so let's check it out I am going to go to the app data folder and the traffic and rules I am calling it middleware secure headers here so so we're going to do the same way why am I doing it this way interesting question you can call it whatever you want in fact you can call this file anything that you want traffic is still going to pick up the file it doesn't really matter what matters is how you call the middleware inside the file which I will show you in just a minute secure headers yml okay so we created that I'm going to right click this one and edit it and it's open here let's paste it here so we pasted it the name of the middleware actually just comes from right there so that's what is more important it does not really matter how you call the file once again there are lots of different things here some performance some security related things if you need explanation on these these things please refer to many different documentation that might be on the internet just select that and do a search and you will find out or as sgpd what it means and maybe you will you'll get a good answer as well who knows okay going back we're going to save save this yes I want to save it so if I go back to my dashboard and I go to the middle Wares here I should see another one secure headers so we're good we have all the secure headers let's go back to my guide I think that's all we have but oh wait we didn't add the middleware to my service right the traffic dashboard so we go to traffic and we're going to do exactly the same thing middleware and secure headers add file now we save this and of course we'll have to restart traffic for this change to take effect so we're going to do DC Rec my BH Alias for Docker compros recreate and traffics right so we recreated traffic let's once that restarts let's head over to traffic dashboard and check if that middleware is taken so if I go to my routers I go to traffic I see it here and now we can see headers middleware right there and it has a lot of different information you can go through the whole thing it's basically coming from the settings that we had right and then we have the basic o and we have the break limit so we are good next thing I'm going to share with you is that as your setup grows more and more let's say you add Google o or you add ailia if you want guides on how to do it once again if you go at top of my traffic guide you're going to find this ultimate Docker server series and I go through step by step right here you would find aelia and then Google o those are detailed guides that will get you started if you don't have the patience of course I'm going to be making videos on this as well so stay tuned and hit the notification Bell so you know when those videos come out okay so let's go back to my guide wherever I was I think I was right here okay so the last thing I want to say is that when we start adding more and more middle west it becomes too lengthy to add those two different Services we can simplify that with the usage of chains which is what we're going to do right now we're going to create a chain called chain no o as I said I like to prefix things I want to identify a chain as a chain it's my preference it's not a requirement by traffic so let's head over here and we're going to create a new chain so chain no Au so what does this mean no authentic ation that's it basically so what is this chain going to have let's edit and we are going to paste what we just copied from my guide and I'll explain what that means so chain noat is the name of the middleware and it's a chain of middle Wares basically and what middle Wares are in this chain the rate limit M middleware and secure headers middleware notice that we're not putting basic o middleware in here because this chain is for services that do not need authentication and there might be some that do not need any authentication at all in those cases you would use this middle bear maybe Plex if you're making your Plex instance available outside your home internet a home network then you may not want to have uh an authentication layer on on top who knows because Flex already has built-in authentication so if you trust flex's authentication then you can leave it out and say no OD so this is the chain for that then we're going to we're going to save it yes I want to save it so and then we're going to create another chain you can see here we're going to create a new one called chain basic o so obviously the only difference here is that this one has authentication middleware added to it so chain Das uh basic. yml okay so let's edit this and we're going to add what we copied over okay great so we created the change but that does not mean that our services are using the chain so we have to go back and edit traffic once again so let's go over to our traffic Docker compost it's right here now traffic dashboard we still want it behind authentication so what we want is the chain basic o That's the chain that we want so what we're going to do right now we I have to zoom in I can't hear so let me see if there's an option to zoom in I don't see it but here right here all the middlewares we're going to remove them right now cuz we don't want any of those things right there so we are going to add a chain instead but the chain basically represents what we have here so going to be chain basic art at file that's it simple now we have all of our middle Wares added now this comes in handy when you start adding more more middlewares like I said Google ailia and then maybe you decide to add crowd sack which is it's an awesome intrustion prevention system so if you want to do that all of those become middle Wares and it makes it easy to add those middle Wares okay so we did the chains everything is done so far let's just make sure that our middlewares are in effect so if I go in here to the middleware stab you do see that our chains are active right now so we are good to go with the chains okay that was it for today's video everyone I hope it give you an idea of how traffic middleware and middleware chains work and how they can make our setup simpler this topic is very important as we follow this ultimate Docker media server series and that's why I decided to make a dedicated video on this topic please like subscribe and hit that notification Bell because the next video is going to be the end of all of our hard work which is to put apps both Docker and non- doer apps behind traffic so watch out for that video that's it for today thank you for staying this long Go Geek Army [Music]"
    }
}