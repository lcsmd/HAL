{
    "yDkc3D3BFhM": {
        "title": "Homelab Setup Guide - Proxmox / TrueNAS / Docker Services",
        "thumbnail": "https://i.ytimg.com/vi/yDkc3D3BFhM/hqdefault.jpg",
        "author": "Matthias Benaets",
        "date_of_release": "2022-09-28T17:00:27Z",
        "duration": "PT2H44M39S",
        "view_count": "128756",
        "like_count": "1822",
        "comment_count": "102",
        "description": "!!!Resources, Timestamps, Extra Useful Notes and other thing I forgot to mention Below!!!\n--------------------\nIn this mini-course I try to demystify the whole process of setting up a server at home, set it up as a NAS and run local services on it.\nThis course covers:\n- Recommended hardware\n- Installation Proxmox and TrueNAS\n- Running services with Docker and Portainer Stacks (docker-compose)\n\nThis video is for entertainment purposes only.\nSome aspects/topics might change in future updates.\nNot everything is 100% correctly explained or information is left out. This is done to get the point across and keep everything accessible for newcomers.\n--------------------\nPrerequisites:\n  - you have a device able to run proxmox\n  - you have an other device to access web-interfaces\n  - you know your public IP-address. It is recommended that this is static.\n  - you know how to open ports\n  - recommended: have a domain name.\n--------------------\nExtra Notes:\n  -- will be added if I forgot something --\n  1. When setting up TrueNAS, for safety, it might be useful to have a look at Data Protection. I recommend to run a scrub test, snapshot and do a long smart test once a month for all drives/datapools.\n  2. Portainer agent is used to connect to a docker socket on another vm/lxc. This means you will only need to install portainer once to manage all virtual environments. \n  3. Latest Ryzen processors now come with integrated graphics.\n  4. Since OnlyOffice 7.2 JWT is enabled by default. It is recommended to use this for safety. Surf to the website link of onlyoffice and run the command in the vm shell. This secret key can than be used when connection to OnlyOffice in nextcloud. Or set a environment variable like in my updated boilerplate.\n--------------------\nResources:\n  My docker boilerplates: https://github.com/MatthiasBenaets/boilerplates/tree/master/docker\n  My personal notes for my home network: https://github.com/MatthiasBenaets/boilerplates/blob/master/notes/nassetup.org\n--------------------\nTimestamps:\n0:00:00 Introduction\n0:03:48 Hardware\n0:16:00 Software overview\n0:19:36 Proxmox installation\n0:37:00 TrueNAS installation / Virtual Machine creation\n0:52:55 Passthrough to VM\n1:05:33 TrueNAS setup\n1:24:30 Container creation\n1:30:55 Docker\n1:34:40 Portainer\n1:37:50 Docker compose services\n1:38:30 Pi-hole\n1:49:19 Wireguard\n2:02:15 Nginx Proxy Manager\n2:08:58 Nextcloud and OnlyOffice\n2:28:18 Nginx Website\n--------------------\nEnjoyed the course and want to tip? https://www.paypal.com/donate/?hosted_button_id=VXJ2AVMJRQUBY",
        "transcript": "hello everyone my name is Matthias so last weekend I had a conversation with a buddy of mine and we were pretty much discussing setting up a server at home so using it as an ass or running a few services like cloud storage or hosting a website the only issue this person was facing at the moment was that they didn't really know where to start so they had a bit of information they add a bit of knowledge about the hardware side how to set everything up but they didn't really know how to get started how to make these things work with each other so that was a bit of a a block for them to get actually started with this so I thought to myself well why not make a quick mini course about this because I think many people at the moment rely on big tech companies when it comes to their data personal files and of course other services and I'm not really a big fan of that so I'm I don't really like third parties I don't want to rely on on any of them actually if I can I would like to host these things myself and have full control over it so I pretty much recommend any tech savvy individual to have a look at at home living so what is home loving well as I mentioned pretty much a server for your home of course the topic itself is a bit wider than that but for now I'm just going to have a look at at just running a server at home now when people think about servers they often imagine like a huge supercomputer or a server rack filled with multiple devices but the truth of course is that you can pretty much start with something as little as a Raspberry Pi or an old laptop now for this mini course I am going to use a general desktop tower computer as an example the reason being well it is a lot more flexible than just running things on Raspberry Pi so an old laptop of course okay so before we get started a small disclaimer of course I am just an Enthusiast so please don't quote me too much if I make any obvious mistakes or I say something wrong of course I haven't really made too much note so I've made this presentation that's about it but after the these three slides we will just get right into it and set everything up my main aim pretty much is to explain this to the general public so to everyone that's maybe also why I might omit some information about things just to keep everyone on track and well so that everyone actually understand if I may use too many different terms that people don't understand well I don't think that uh that will be useful for for the the General Public Okay so what are we going to look at well first of all the desktop Hardware that we're going to use things that I recommend so if you don't already have a device or you're still shopping for something we'll have a look at the hardware that I recommend then what software we're going to use so the operating system as you can see from the logos maybe you already know these we are going to use proxmox and trueness primarily and then also we're going to have a quick look at the service that we can run so these are services that I recommend that you use you of course don't need to but for the general public these are already pretty useful so let's get started with the hot weather there we go so full Hardware well if you don't already have a device and you're still shopping have a look at the processor that you're going to use if you are planning on running multiple service services at the same time so let's say a gaming computer an instance of like your Cloud own cloud storage website and maybe other things as well you might need a few calls to actually run these things reason being well we are going to use a operating system called proxmox which creates virtual machines so that means that we are going we are able to create multiple computers within our one server or or one computer itself and because these computers also need like specific a processor you need to actually provision specific goals to these multiple virtual computers and the more you have the better of course because the more course processor course you have the more virtual machines we can create another thing is the ram so the work memory again the more you have the better with the processor course we can actually over provision what we have so that means that if let's say I have a processor with eight cores and I have two virtual machines I can give each virtual machine let's say Focus if I don't have an I need an extra virtual machine I can give it more than these eight cores that are that exist so we can use specific course for multiple virtual machines the problem with ram that is that this is not possible so if I have let's say eight gigabytes of RAM and I've already given four to one virtual machine and four gigabytes to another I pretty much used all my Ram and if you're then going to over provision that is only going to cause issues so that's something that you need to keep in mind that you still have enough RAM for that then for the ram itself if you're going to Shopify go shopping for that well one thing to maybe keep in mind and maybe something that is very useful is ECC Ram so error correction code Ram reason being well they can actually fix issues when accessing files so let's say you have a lot of photos that are very important to you or documents that are very important to you if you are going to access these files often they will be loaded into RAM to actually use it but whilst it is in Ram there can be some issues so corruption or a bit flip so these things don't often happen like I think once a year or so is the is the general consensus and often you don't even notice that these errors occur but of course over the years this can add up and we don't really want to lose any data so that's where ECC Ram comes in they can actually detect these errors and they can fix it of course not every motherboard supports ECC Ram so if you're going to purchase a motherboard check that it supports it you will also need to enable this no I'm not sure I don't think you need to enable this within the BIOS but it might be possible for some manufacturers but do check that they they are compatible of course if your motherboard is not compatible um your ECC Ram will be just normal Ram so you've spent maybe more money for the same um stick as non-ecc RAM now which type do you need to purchase because when you're going to look for these sticks there are specific categories for them and there are two types that are often used one is um Buffet RAM and the other is registered now if you're just purchasing or going to purchase like consumer Hardware often it is the unbuffered ram that you need to purchase if you are going to actually purchase like Enterprise Hardware like a super micro computer or anything from from the servers from Dell or something they pretty much all I believe only support registered Ram so that's something to keep in mind and have a look at now an extra layer of protection is that your CPU also can work in conjunction with the ram of course to make it extra safe of course so there's no data corruption or data loss now for the CPU itself well for AMD it is the ryzen and epic process that support this and I believe for ryzen it is not official but it should still work so even though it's not in any manuals from Verizon it the ECC should work without any issues now for Intel at the moment I believe only the Xeon Processor support ECC and maybe also now the latest generation of Intel process so gen 12 I believe it is at the moment that should also now support this but of course do check for yourself in the in the specs of the of the processor itself if it is supported then a few other things to maybe keep in mind if you are planning on using your Home Server as a Nas so network attached storage you might need multiple hard drives or multiple ssds to keep all your data stored so do check when you're purchasing like a power supply or a motherboard that it has enough connectors for these specific devices so for the power supply so the PSU it is a SATA 12 or is it 15 I'm not sure 12 or 15 power connect 15 pin power connector so have a look at that pretty much all of them come like with like at least three or four connectors but if you have more hard drives do check that you have enough Slots of course or a lot of connectors and for the motherboard do check that you have enough slots so SATA connectors to actually plug these in so you can actually access them now for the storage itself I recommend that you purchase hard drives that are made for being well there are Nas specific so that they are made to run 24 7. they are a bit more robust they are made to run 24 7 and also to run very close to other hard drives so spinning discs they often like have a little vibration and this can over the long term cause issues but when Nas specific drives they are a bit better built so that shouldn't be an issue then now if your motherboard doesn't have enough SATA connectors an alternative is to get an A SAS HBA card flash to it mode I'm not really going to go in too much detail so if you are interested do your own research for that another option is of course to just purchase like an expansion card for within your pcie slot for with SATA connectors on them that's also an alternative then for the motherboard itself there are a few things that you need to look for and also a few things that we might need to enable within the bios of the motherboard itself so one thing that the motherboard needs to support and something that pretty much I believe every processor should now support is virtualization so since we are going to use proxmox as our Os or operating system we are going to create virtual machines and to create them we of course need to enable virtualization within the model mode bios we need to enable for Intel processes Intel vtd and if it's an older processor I believe it's vti or VTX and then for a for AMD it is either called svm for the new ones I believe and for the older chips all the processors it's AMD VI so do check that your motherboard allows you to change this within the BIOS and that your processor of course has this virtualization feature now to get into the BIOS I think most of you will already know but if you don't when you boot up your computer and there isn't an OS installed or at the start at the very start it will like show you a logo from a manufacturer this is the logo of your motherboard manufacturer and it will then tell you to press a specific key on your keyboard to get either in the Bios or in the boot menu I believe so you need to then press what is it like F12 or delete or F9 depending on your manufacturer press that and then in the settings from your bios you can enable this another thing or another feature that your motherboard needs to have and that you need to enable within the BIOS is a i o mmu group passed through option so what this does well it allows you to actually pass through specific parts from your motherboard to a virtual machine now why is this useful well let's say we want a virtual gaming computer so we want to pass through a video card we can because this because with iom you group pass through these things can then be um well assigned to a virtual machine and that's pretty useful of course also for well our our Nas we are going to use the trueness I'll come to that in a minute if you well the most reliable option is to pass through the SATA controller on the motherboard to uh trueness so something to keep in mind and to have on your motherboard as a feature a few other quality of life settings you might want to change the first one is power on AC so let's say the power goes out at your home of course all the electric devices shut off with power on AC the computer will detect when the electricity electricity is back and it will boot itself up again which is pretty useful because if you want to run a server it's of course pretty important important that they run well always 24 7. so if you don't want to check every time the power goes out if it is running or not just enable power on IC and every time the electricity comes back it will boot up on its own now if you are purchasing Hardware from like a company which is like second hand or something do check also that the built-in SATA controller of your motherboard is not set to RAID Mode because we don't really want Hardware rates we are going to set up true nest for our storage or data storage and that is well software rate which means we don't really need it in within Hardware it will only cause issues I believe it won't even work so disable any rate like for example rate 1 or rate 2 or rate 10 or rate Five these things disable that so we can actually set up trueness in this case okay so for the storage the software first of all we are going to as I mentioned install proxmox which is a hypervisor to install the virtual machines on one of these virtual machines will be a network attached storage OS so a Nas OS which is called trunes in this mini course I'm going to install Tunas scale and this is for our hard drives so we can create like a pool where we can store all our data on and then share it on our local network at home so any computer can actually use it and then a few services that we are going to actually have a look at and maybe also set up uh portana pertainer is pretty much used for Docker so if you don't know what Docker is well Docker is pretty useful it like runs services within a container so it won't affect anything on the computer itself so it doesn't have any interference so there's a little well less likely chance that something goes wrong and well Docker is pretty much only run via the command line but with patina we actually have a useful web interface and I'll show an example of it when we come to this specific thing these Services it's a very useful well web interface to actually manage all our Docker containers and all these services will all be run will be running in a Docker container so the next one is pile pile will be used for ad blocking so having an ad blocker on your network at home is pretty useful and we're also going to use it as a local DNS so what is a local DNS let's say you want to serve to google.com of course that is just the name of the web link there's an IP address behind this and so we don't really need to remember these IP addresses this is all done for us and when we are going to run these Services let's say portena or nginx proxy manager they will all have their own IP address and if we don't want to remember these we can actually set up a local DNS and give them a URL that we can easily serve to why I got is a VPN so that's pretty useful so we can actually access our home network from anywhere within the world so it's then also very useful to manage our server from anywhere around the world nginx proxy manager will also be used for our local DNS so it's very easy to navigate to specific bolts also if you want to make things available on the internet so let's say a website or something it's a lot safer to only have to open two ports on our modem and our router so yeah that's a pretty useful one then I also would like to see nexcloud with either collabora or only office so that's an alternative to let's say OneDrive or Google Drive so here we are going to store our documents and we can then also manage these with only office so we can edit them on a via the weapon via a website so that's very useful of course and then also just nginx which we are going to use as a normal well to set up a normal website and make it available on the internet okay let's get started then shall we so the first thing you might want to do is go to proxmox so you can just go to Google and search for proxmox and in proxmox.com we can go to download and here we have the iso for proxmox ve so the virtual environment I believe it stands for and you will need to actually well burn I believe is a term I'm not sure or just install this ISO on a bootable hard drive or a thumb drive like a USB stick and what you can use for this as well something like Rufus if you're on windows so Rufus yes so that's pretty straightforward so you just download the iso and then start it from here well I'm not running on windows at the moment so yeah this is not really something that will work for another option is etcher bellina I guess it is called yes so that's another option to actually use and well if you're running Linux or something you can always just use DD but I guess people who use that will know what I'm talking about okay then after we've of course installed it on your bootable disk you can just plug this in to any USB port on your computer boot it up and then when you get again the logo from the motherboard manufacturer instead of going to the BIOS we go start the the boot menu will also be one of the F keys or delete or something and then we boot into the USB or like a uh what is it called like a portable hard drive or something you can use these as well and if you have a monitor installed or connected to the the desktop itself you should see something like this popping up now do keep in mind if you're using a processor that I mentioned here so like a horizon processor or epic or Xeon these three will not have like integrated Graphics so if you like connected your display cable or your HDMI cable to the motherboard and then to your monitor you might not get any input or output in this case reason being of course they they can't show any any video so you might want to template temporarily then also install a video card and connect it like that to the the display itself afterwards if you don't want to use that video card after the installation you can always unplug it and run run the server headless that's no problem we're going to manage it via a website so it's just something we need to do for now during the installation so once you've done that we can actually press enter and start the installation and this shouldn't take too long there we go so of course the user license agreement we agree now proxmox does a great job with explaining everything what we need to do I'm not going to go into too much detail I'm just going to show you what I select here so here it will detect all the hard drives that are connected to the desktop I want to choose vda1 in this case but I also have a few other hard drives here as you can see and these will be used for our data storage and that we are going to use within trueness but for now I'm going to use this 64 gigabyte vda next to choose my country time zone is correct keyboard also let's set a password so this will also be the passport that is used in the web interface to actually manage proxmox so do remember this and then the email I'm just going to use a demi email in this case because I'm not planning on using it because it's of course on a virtual machine for me oh.com now this email address as it mentions here it is just used for sending important alerts and notifications um so I guess it won't be useful like marketing and next then to have a look that the correct network interface so the ethernet port here is a correct one that is being used of course select the one that is now connected to the internet at the moment now for the hostname the note from proxmox itself so you can have multiple hosts notes within proxmox but the host name in this case will be the first word so in this case PVE and then we have like a domain name so if I call this PVE dot my domain which is idle me there we go then our note will be called PVE if you want to name this something else or if you have multiple nodes you can call it like PVE [Music] one or if you already have one two and so on I'll just keep it at PVE and then we set the IP address this will also be the IP address from the web interface so just something easy to remember for me is two and then the Gateway and DNS is fine so let's click next this looks good there we go and then the installation will start this will pretty much depend on how quick your network speed is um how if you are using like USB 3 or USB 2 to install this so that pretty much all depends but it shouldn't take too long I guess like five to ten minutes for me it should be a bit quicker since everything is local here now while we wait on this you can already open a new tab and go to https and then we can go to let's have a look 192.168.122.2 and here it is already we are going to use port 8006. press enter it doesn't load anything but that's of course normal because the installation is still going on so we're at 73 percent so we'll just have to wait a bit longer and once this is done our web interface should load now that's for creating virtual machines one of the virtual machines that we are going to of course create is true Nas and for trueness you can just serve to jonas.com and this is pretty much used for or storage so to actually get the iso so we can install it you can go to get throughness and well here you can choose which one you prefer have if you don't know which does what have a look at yourself or on the Internet what what each one does core is like an older version it should still be supported but there are less features in my opinion scale can also be used like Standalone so you don't really need proxmox you can also just install trueness bare metal and it should also like support creating virtual machines and running Services themselves but that's not I don't really like the well the flexibility that is available within trueness to create these services and and these virtual machines I personally believe that proxbox has a lot more features in in that case they they you can change a lot more but it is a nice interface to actually manage your your data so that's why you just use trueness so we'll just go for between a scale and then at the bottom I have already signed up and then here we have of course the download button to get the iso itself okay so you can already get that of course do it on on your your own computer so not the one that is now being well the installation is being done on so that's this one apparently it already Rebooted there we go so after the installation is done it will automatically of course reboot and in this case it already has done so and it tells us that proxmox is at the moment running on 192.168.122.2 and on Port 8006 so that's the link that I already had given here so let's just refresh and now we just get a warning and it tells us okay this an issue let's see we'll learn more well it doesn't really matter if I go Advanced here there's also a bit more information so it tells us a unknown issuer that's fine we are using like https to have an encrypted connection but since it's a known issue from the certificate I guess it will give this issue we can just accept and continue we are hosting this on our own so we can actually trust this for anyone who is using like Chromium browser I believe you can press on something like learn more or another link and then it will also give like this pop-up and you can just enter the website so yeah here we have the web interface from proxmox I can already give my password because I use that or set that up during the installation now for the username this is always the same you can always if you want to create a new user for this but by default it is root so let's log in and the first thing we get is a message about a no valid subscription so proxbox itself provides like a repository for Enterprise but since we are just going to use this for a home we don't really need this so I can just safely say okay and I do want to actually update this Enterprise repository that we don't want to use it if we don't do this it might cause issues and we won't get any updates so how can I check if I can get updates or not so I can go here at the top so left top we are now in the data center so here we can see a lot of information about our setup if I go to the node so PVE we get even more information so this is for this node specific if you have multiple nodes like pve1 pve2 these will populate here as well and if I go to the Shell I can actually check if I can get updates so proxmox uses Debian um well it is pretty much built on Debian so we use the APT package manager so if I do apt update it might error out because we don't have the Enterprise so there it is so at the moment it says fail to fetch from Enterprise meaning we won't be able to actually get any updates so I believe proxmox itself has like a Cron job or something that runs in the background that updates every so often but because we still have this Enterprise repository we need to remove this to actually receive updates so let's do that so within a note we go to repositories and here we can see the Enterprise Repository so let's disable that one the only issue now is that we still do not receive any updates from proxmox because we just removed this one we will get like the security updates at the moment but nothing for box marks we need to add a new Repository that's fine and a set of prox marks we are going to use the no subscription Repository let's add this there we go and now everything should be fine let's quickly check let's do another apt update and now it shouldn't error out so as you can see it uses now the repository for the PVE node subscriptions and we got no error and it tells me that there are any updates so let's upgrade 400 megabytes so that is going to take a while so we'll just leave this in the in the background for now and I'll just explain a bit more about all these these available settings here so if we go to disks here we can see all the disks that are connected to the server at the moment so I have vda this is the one I chose to actually install proxmox on as you can see here we have a few partitions and maybe the most important one is this lvm the lvm petition is 68 gigabytes and it is split in two you can't see it here but we actually use this as two separate storage options and when I click on this drop down here for next to PVE as you can see we have a local and a local lvm so that's both these are within vda3 but they are split up the reason being well if we have a look at local this is pretty much used so the content of local are backup files ISO images and container templates so if we're going to backup a virtual machine they will be stored here the iso images are of course used to install a virtual machine and a container templates are to install containers now what are the difference between both I'll come to that in a minute now for local lvm it's pretty much in the name it is for VMS so the content for local lvm is disk images and containers so these will be stored separately in this case okay hopefully the update is done in the background so we can actually get started with creating a VM before we do maybe a few other things to note let's quickly have a look at what's something else that might be useful to know nothing at the moment actually maybe I'll come back to the the Acme certificate if I have enough time okay so to creative yam at the top here you can see create VM but we also have an option to create a CT so a container now what's the difference well if you have like a very strong and powerful computer you can pretty much always use just a VM and of course with a VM it has its own kernel its own systems everything is within that VM to run the computer itself with a container it's a bit different so containers are more used if you have less space or if you want to make efficient use of your space so what a container will do it will also contain rice like your applications that you will run but it will actually share the kernel with proxmox or the host system in this case and this means that you will need less space it will also use less resources like your processor power or your RAM so that's something very useful to do in my opinion even with a strong computer only like use VMS if you really need to so for example which true Nas of course we can't really use a container for that I believe at least it doesn't exist but if you can contain rice it is recommended that you do so for example like a Linux distribution often they have like templates for these I'll show them also in a few minutes and it it's a bit a lot more efficient in my opinion so to actually create one so if I press create VM I can of course give it a name and an ID and if I have multiple nodes I can of course select the note that's just give the this is a temporal name at the moment and then it here asks me to actually give an ISO now we can't really upload an ISO here we first need to do this in storage so let's just exit out of this first let's go to local because this is where we store isos so here we have a tab ISO images and I can actually upload one from here I can select a file and let's pick trueness okay and just press upload and depending on how good your internal network is um it will actually uh either quick or a bit slower but I guess most home networks will have like a gigabit speeds task okay so that's uploaded and now we can actually create a VM now for the containers I'll just also quickly show that here if you already have a template you can upload it or you can well use if you have a URL for template you can also just do it like that but there are also already available templates within proximox here as you can see as I mentioned let's say you want something like Debian we have Debian 10 I think that should be yeah here's a Debian 11. so there are also a lot of templates here these are not all the templates so let me just quickly go back to PVE shell and what was it I guess it was PVE am update I believe I'm not really sure yes okay and then we go back and if I now go to templates and scroll down as you can see now there are also chunky templates here so these are specifically made as containerized applications set up by by TurnKey so if you wanted to set something up like gitlab and host it yourself this will pretty much come with everything set up out of the box so as I mentioned in the in the start of the the mini course with with the slides we're going to host all these things within docker if you don't want to like use all these things these are these come pretty much set up from the get-go with a specific service themselves so there are a lot of things here so on cloud Moodle so there's a lot like a WordPress even so very easy to then create a website uh wireguard which we will also set up so yeah so you can also download these as well let's quickly already download like a Debian one or I believe I can't I do have to check first I do believe I need to show these containers on my own personal instance of boxmox that I'm actually running at home because I don't think that these containers work within my virtual machine for this mini course but we'll just download it full for the sake of it okay let's create that VM then shall we create VM VM ID is fine let's call it trunes and then I also have these Advanced options if you don't see these do select here Advanced at the bottom and I do want trueness to actually boot up at the start let's say the power goes out and we have set up in the Bios of our computer to boot a power on AC that's all fine the problem is all the virtual machines won't put up on their own so you need to actually set that up here to actually boot at the start when the computer boots up so the server I can give it a order so in this case one so the first thing to actually start up now if you have if you have more um so let's say a startup order 2 or 3 and so on if I start this up as number one and I have a virtual machine that for example depends on trueness I can tell trueness to actually wait let's say 60 seconds after this one starts before boot ordered to actually starts up so let's say I have a a Ubuntu virtual machine that needs to start 60 seconds after trueness this is pretty much how you set it up but since we're not going to do that I'm going to remove it next I have uploaded the iso now there we go and the guest always of course is Linux if you are like planning on using Windows or something do select the correct one here this is all fine next I don't really need to change anything here maybe enable qemu agent this is pretty useful it is pretty much a helper for virtual machines I believe a lot of distros actually come with this already enabled so if you have like a Linux VM it probably already has it but just to make sure just enable it and this will also cause less issues if you plan on actually like shutting down the virtual machines within this web interface instead of actually having to go into the virtual machine and manually shutting everything down so that's pretty useful in my opinion next so from here we are going to create a virtual disk to actually save everything on so we had for the 64 gigabyte hard drive where we installed proxmox it gave was it like 58 gigabytes as normal storage and from for local ldm like 40 gigabytes I believe so we have space for that here if you have of course additional drives that you want to use you can of course add them as I have shown uh like a minute ago with storage but I'll show it in a minute again so 32 is fine if you don't have enough not enough not a lot of space you can always enable Discord so if we don't have discard enabled it will actually create like a cucao image which is like a a file with everything from VM within it and it will provision that 32 gigabytes now if you don't have that that much space we can always click Discord and then it will grow the file along with how much we actually use so if we don't use 32 gigabytes at the get-go let's say only 16 gigabytes file only be 16 gigabytes instead of 32. so that's pretty useful in my opinion but for now I'll just leave it as default if it's an SSD that we're using very useful to actually enable SSD emulation and that's pretty much it for here if you're planning on running this virtual machine not within like local lvm but in a another storage location that is let's say an SMB share so a local network storage location it is maybe recommended to set async i o from i o urine to Native all threads I believe this is a bug but I'm not sure but it can actually cause errors all the system to actually fully hang or shut down the virtual machine I believe so do change it then to Native all threads we'll see how to actually use like an SMB during this this many equals as well to store your local virtual machines okay next CPU I only have one CPU but you can of course like give it a specific type here to actually simulate a specific CPU within the virtual machine I only have one CPU but if you want to like if you have like two CPUs you can always give it two CPUs here with one core each but I only have one and I am going to give this 4 cores next for trunes I recommend at least eight gigabytes the reason being well it uses a lot of ram Tunes it will actually store specific files within Ram that you access often so that's pretty useful because Ram is very quick even quicker than most of the the ssds so if you like access specific files very often it will be very Snappy from any computer on on the local network actually so that's pretty useful in my opinion ballooning will be set to off so that won't make it so that it can use more than eight gigabytes next Network this should all be fine I'm not really going to go into networking because this is more advanced next and that's all fine so let's confirm it is now a lock here so there we go and it's done so it can take a while depending on what you're actually using but once you get the ID like Gray display or yeah a great display and then the name behind it it should be done from here we get also like a new menu where we can manage everything so with Hardware we can have a look what is all here with options we can change a few things as well and there are of course a few other options here if we go to console we can actually start the virtual machine but at the top here you can see we have start and we have console so that's maybe more useful in my opinion so if we click on Console here it will open like a new window where we can start the virtual machine so we don't really need to run it like very tiny within the web interface so that's start us up press enter and this shouldn't take too long there we go so enter and this is our virtual disk that we just created enter and here it tells us okay it's going to fully erase everything and create new partitions so and so on yes we want to do this let's create a password so this installation is even more straightforward than proxmox because we only need to allow one thing and then set a password and then it will start doing all these things on their own so we'll just have to wait for this this is going to do what it needs to do so let's move this over now if you like wanted to use another storage location other than local lvm what we could do is actually go to Data Center storage no I'm wrong I believe it was the note PVE discs and here we could like initialize a disk with GPT and now we can actually use this as a storage uh location as well if we don't want to actually use trunes there is also an option within proxmox to set up like ZFS so that's to create like this data pool to actually be able to access it on the network that's also an option within proxmox so with ZFS here we can create CFS and then select all the disks and select rate level here so I'm not going to go into too much detail at the moment because I'll explain this when we're setting up trueness but just know that you don't need trueness to set this up and all your data but personally this is something that proxbox is not really good for in my opinion to an access a lot of features in this case okay something else maybe no that's pretty much everything let's have a look at the installation yeah it's at 90 so it shouldn't take too much longer and we can actually have a look at that so it true Nest works pretty much the same as proxmox so if I go to 192.168.122 dots and then it should give me an IP after the installation is done because trueness also uses like a web interface to manage everything which is pretty useful because we don't really need to access or sit down next to the server to actually manage all these things we can do it from any computer within the local networks which is of course pretty pretty useful so let's wait a bit longer and we should get an IP in a minute there is so it asks us to reboot so let's do that and the first time I believed that your startup tune as it takes a bit longer I guess because it needs to set a few things up before we can actually use everything so let's wait for that now while we wait on this it's maybe useful to actually have a look at how we're going to pass through all these disks to our virtual machine itself because I'll show that in a sec it will not actually detect the drives that are connected to our computer because the disks are not passed through so as I mentioned during at the start of the of the mini course with the the iommu group passed through that's something very useful because if we go to our virtual machine and then Hardware we could actually just add a new PCI device and then we could go down here and add a SATA controller so that would be very useful to do but as you can see it tells me this is not possible so we can't really do that but if you have this enabled you can just select SATA controller enable all functions and that should all work but one more thing that we need to do for that is actually change a few settings within proxbox itself to actually allow the the iommu grouping actually now before we do that let's quickly go to our web interface so that's at 85 it gives us again a warning so we can now move this over because we don't longer need this we only just need a dip we go and then from here again a warning probably the same warning with a a known issuer or a self a signed certificate so yeah that's pretty much the same so we'll just accept and then here it is pretty much the same as with proxmox we already gave the best watch during installation and the default username is root login and here we have everything so the CPU the text for cost so that's working it also sees the eight gigabytes and if you have ECC memory it will also tell you here that it is active and actually working so that's pretty neat and for now it is only using a very little actual Ram but the more you will use this will probably like fill up to almost 70 percent 80 percent at times with the cash actually so yeah just keep that in mind don't be alarmed if you see like a high RAM usage this is all just files that are within Ram trueness will know that if you need this Ram it will just all get rid of it very quickly so you won't even see any performance issues actually so if I go to storage now because we want to actually use trueness to set up our storage or data pool for our home so let's go to storage and create a pool it doesn't actually see the disks here so we need to pass these through so to do so let's go back to PVE so proxmox let's go to the shell and we first want to actually I'll show it here I can't really do this with the with the PCI device but I'll just set it up here so for the people who are able to do this you can follow along here the first thing we are going to actually do is have a look at the what is it called it's um yeah let me quickly first now I think about it actually get oops what am I thinking first get a text editor there we go now I can actually edit a specific file to allow this iomu group passed through so we do that in Etsy default and then group so that's the crop configuration file here we go and we are going to edit this one so Grub command line Linux default it is now set to quiet and we need to add one more argument and it is not like that it's like this yeah so AMD underscored iommu not IM O mu equals um of course this is for the people that have a processor from AMD if you have a process from Intel change this to Intel underscored iommu equals on so that's pretty much needed to actually enable this within grup that's not the only thing so this is just that grub knows that this needs to be on we also need to enable these kernel modules within proxmox to actually be able to do this so let's write and quit we are going to update to group configuration so the image so this will generate a new image and will be used on the next boot so we do need to restart the virtual machine before we can actually do this but before we actually do let's also add a few uh kernel modules so that's an Etsy modules and then from here we are going to add vfio and I need to think that I don't make any mistakes IO I'm a mu vfio underscore IO mmu no this one is type 1 I believe and then we have PCI and the vfio underscore verb qfd so these are the four that you need to add so vfio VF IO underscore iomu underscore type 1. vfio underscore PCI and vfio for Q f t right in quit we don't need to update anything here this will all change whenever we reboot and then one more thing this is for the people that actually want to pass through a video card so if you don't have a video card you don't need to do this for but for those that do we need to actually Blacklist the drivers for these within proxmox so when proxmox Boots up boot boots up it doesn't want to grab these devices and actually use them so to do that we go to mob probe so Etsy mob probe D PVE Dash blacklist.com and at the moment there's already one in here which is NVIDIA FD but we also want to Blacklist just a normal M video we want to Blacklist Red Deon which is from AMD for the AMD [Music] video cards but if you're using AMD or Nvidia it doesn't really matter just Blacklist all of them and then we have one more and that's the open source drivers for NVIDIA which is Nuvo so these all need to be added here and right quit that as well so now for all of you that have changed these things and want to pass through like a SATA controller or video cards it is recommended that you now reboot and then we'll go on and actually pass everything through so for for True nests you can then go to add PCI device select your SATA controller where all the hard drives are connected to and we can give it all functions that's pretty much it I can't really do it as you can see here so I'm not going to do it this way for people who can't this is how you will do it is not recommended I personally recommend to like use a what's it called a SATA PCI controller or something like that PCI SATA controller or like the the SAS HPA got that I mentioned before that is Flash to it mode but if you can't do all these things we need to do manually it can sometimes cause issues but well I've never experienced anything but it is not recommended way but I'll just show it how you can do this so the first thing we need to do is actually have a look at what's it called again it is Ellen L I believe death disc by ID I'm not 100 sure oh no of course Dallas so LSL Dev disk by ID and here we can see all the disks that are actually connected to the server at the moment so the first one here is a DVD ROM not the one we're looking for PVE root also not PVE Swap this is all where proxbox is installed on not these partitions either this is our virtual machine Tunas also not the one these also not but as you can see here we have four disks and these are the four that we are looking for so you have to have a look as well yourself which disks you are actually wanting to pass through to trueness so in this case I've gave them a very easy name to remember and to write down if you have actual hard drives of course these are just virtual hard drives for the for the mini course if you have actual hard drives they might have a longer string or longer name that you need to remember do write them down correct or copy paste them it doesn't really matter but do write them down correctly when we're going to pause them through because if the name is not correct it will just give an error so how can we pause these through well there's a bit of information that we first need so if we go to trueness and go to hotweb as you can see there is already one hard disk connected which is the virtual one the one where everything is running on from 2ns and this one is called scuzzy zero so the first one is called zero so if we're going to add extra disks they will need to be ID scuzzy one because E2 because E3 and so on so that's something to keep in mind another thing that we need to know is the ID of the VM as you can see it's vm100 also you can tell it from here at the top so these are the two things that we need to know so let's go back to the Shell from PVE and we need to set or say qm set and then a virtual machine ID so in this case it's 100 Dash scuzzy and well zero already exists so scuzzy1 next one and then slash def slash disk slash buy ID and then the name of the disk itself so if I remember correctly it was verdio disk one in my case and if I press enter it will update the VM and will actually pass through the disk so if we go to tune s and on the hardware we now have a scuzzy1 which is disk one and it also detects the size so we are sure that it is actually passed through so we need to do that three more times in my app in my case so photo disk 2. and we also need to change the ID from because you want to Z2 disc 3. it's because E3 and disk 4 C4 if we now go back to hardware they're all here so this should all be detected so let's go back to the web interface for Tunes let's go reload storage and create a pool and now as you can see here all the four disks are connected or are detected so let's give this pool a name so this is the the whole data pool that we're going to set up I'll just call it fault that's my default name and then from here we can select these disks move them over to datavs and now we can choose how we want to set these up so at the moment it is while suggesting raid C2 and we'll say rate C2 it estimates a raw capacity of 36 gigabytes so that's about 40 gigabytes so that means that we have two disks worth of data and the other two disks will be used as redundancy if we need more we can always change this to rate C so in this case we have 54 gigabytes so around 60 gigabytes so now we are using three disks and one disk for redundancy and by redundancy I mean let's say we are using these disks for multiple years and one of them is having some issues and it fails we can be sure that our data is still safe because it is either all here or all on sdb CD it doesn't really matter if one fails all our data is still here if two disks fails well pretty much all our data is gone or corrupted so we don't really want that so if you want to this is personal preference how you want to set it up and how safe you want to be for me I always recommend rate C if you have like three to four disks if you have more it may be more useful to have more redundancy of course another option to actually keep these things separate is to use something like a mirror so with mirror that's for full disks in this case very safe because we only have 18 gigabytes so one disk worth of capacity but it will be stored four times so a copy on every single disk meaning we can lose well three of them before we actually lose something the very useful thing about the mirror is that we can actually read from this disk four times as fast because we are if we load something up all these four disks can spin up and read the same thing at the same time which of course will be a lot quicker writing of course will be just the same speaker speed because we need to write it to all of them at the same time if we want some more space let's say I am very intrigued with the mirror but I don't want to lose this much data we can always create multiple V devs so in this case we only have 18 gigabytes if I move two of these back over I still have one disk of redundancy because while it's just a mirror and if I press repeat repeat the drive we now have two V devs each with its own mirror of course which with a backup actually so we'll just we will still be able to like read from these disks at Double the speed because there are of course two copies but we of course now have more capacity so we have now as you can see here 36 gigabytes available so actually double so that's also something to think about but in my opinion something like raid C1 is fine especially for four discs so let's create this confirm create pool and this shouldn't take too long now if you are very interested in how all these things work with raid C1 and so on and I do recommend that you read up on it on your own I'm not going to go into too much more detail or waste time on that too much if you're not sure something like raid C1 or Raid C2 or maybe even rate C3 if you have a very a lot of disks is also an option of course there we go and now our storage is created so it tells me around 50 gigabytes so that will be around 55 60 gigabytes in total that we can actually use now this is just our pool so our pool is called fault but we still can't really use it at the moment so how can we make this useful well we need to actually create a data set so this is actually a folder within our file system where we can actually store our data so let's create that data set let's call it data and we don't really need to change anything here I'm also not going to go into the advanced options there we go and now we have actually a file where we can save all our data now at the moment if we view the permissions this data set is owned by root which we don't really want because well I think most of you will run your computer not as a super user so we do need to change this to a new new owner so by how can we do this well we can go to credentials local users and we can just create a new user so let's close this at let's give it a name let's set a password okay that all looks fine we don't really need to set a group because well it will always create a group with the same name as our username you also don't really need to set up a directory or a home directory for this user it's not really needed if we're just going to store data on it and we'll just allow sudo so we can actually run some commands as this user if we are going to use it as a login as well looks good save so we now have our user here and that's all looking good let's go back to storage and our data set here on the three dots a few permissions and press the pen icon and here we can use a drop down to go all the way down to the new user which is me and then for the group itself we can also go all the way down to me of course if you have multiple users and you want to give this a like a general group name you can always do that you can also under credentials like create new groups if you want to so that's pretty useful I want to apply these and maybe also allow write for the group we'll set this to recursive so if you already have like data or folders in there and you want to quickly change the owner from all this data you can actually do this recursively with all the existing data as well continue and then also if you have like child data sets created you can also apply the ownership on these as well to the new owners so that's pretty useful that's safe so what is like a child data set so as you can maybe remember here in Vault I created a data set but we can actually do the same with this data set as well so we can actually Nest this into each other okay so this should be now owned by me so if I now own my own computer here so my home computer open my file browser and actually try to access this so before we can actually do this let's move this over we might actually need to be make it available to the the network so to do this we can go to shares and in general I recommend most people to just use the SMB shares it is like Universal it can be used on Linux Mac OS windows so that's something recommended for NFS that's more for Unix so Linux and and something and the rest you don't really need if you don't that that knowledgeable about it so just use the windows SMB let's select the path in this case data SMB share now as the name data that's fine by default if you want to change it you can do that here and that's all looking good so let's save we do still need to enable the service there we go and now if I go to my file browser and actually go to this location this will depend of course on your computer and how to connect to SMB shares I'm not going to explain this just look it up if you don't know but if I now give the IP of trueness so 192.168.122. 85 and then the name of the SMB that we set up so in this case data I am able to actually log in so my user is already correct and the password is in this case what I set up for this user connect and there we have it so we are now connected I can create a folder so a new folder is in here just to check and make sure that it actually works let's go to the Shell with Intruders let's go to what was it MNT volt data and I do an LS here we can see new so it is actually in here so that works without any issues okay next up so let's remove this now quickly delete yes let's unmount okay if you want to use this SMB share actually within proxmox we can so let's go back to proxmox and if I go to Data Center we're already on storage so go to storage press add and from here we can use an SMB slash Sif the ID doesn't really matter it is called Data the SMB so I'll keep it with data server is 192.168.0. no 122.85 my username and password whoops that's wrong there we go and it should Now search on its own and it finds the data share so we can actually add it and once this is done and initialized we can actually use it to set things up now at the moment it only allows for disk images now if I press edit I can actually select a few other things so if I want to also store ISO images or container templates or backups or containers we can pretty much select all of these and it will create the correct folders within the SMB share so we can actually save all these things so that should all be fine so here it is I also have all the options so I can actually upload an ISO and such now as I mentioned before if you want to use like an SMB and you're running a virtual machine I just give this a dummy quickly and you let's say so in here I don't have any isos on data so it selects this by default but we don't have it so let's quickly go to local and then next next here we go so if you are planning on actually storing or data or a virtual machine on data that is fine but I do recommend that you then actually change here async IO from i o urine to Native or to threads so that's what I mentioned before I think it's a book I'm not really sure but it might cause issues for you so if you experience like errors or your virtual machine hanging maybe change these things of course have a look you don't really need to create a new virtual machine for this you can just go to where is it like Hardware then select like the hard drive and then you can change it here as well so you don't need to then delete everything again if you if you notice halfway through an installation for example okay then for ah maybe something something useful for trueness before I forget so you can actually also create virtual machines and services that you want to run with Intruder so you don't really need to use proxmox so if you're now if you're not following along we're just having a look at this mini course and thinking about what you can actually do on your own you can also just install tunes on bare metal so you don't need proxmox and then from here you can go to virtualization and create virtual machines if you actually need to do this if you're not planning on doing so you can also go to apps if you catalog in this case I need to create actually a pool for this so we'll select Vault and we and it will create a data set where everything will be stored so during a scale not trueness score so if you've chosen two and a score won't I believe have this but tuna scale also allows you to very quickly and easily set up these Services we are going to use Docker and I'll show that in a few minutes but if you're not that handy with these things it is something that Tunas can do as well so it will create the data set so if I go to storage again there's now an IX application data set where everything will be stored for the applications that's these now they're all in this case like four eight 12 16 so 16 apps but there are a lot more I have written this down somewhere uh let me have a quick look yeah so if you want more than these there is something called true shots here we go and here it actually tells you okay how can we how can I set this up and then you'll have a lot more options so let's do this quickly so during a scale I don't know this by half my own so what do I need to do go to the apps that's what I've done catalogs no manage catalogs add catalog continue let's call it two shots and the repository is apparently this it needs to be stable in main so let's save that and that should pretty much be everything apparently so I guess in the end it will actually add these in in the background we'll come back to this in a minute now if we go back to proxmox one thing maybe also of note is if you want to change these things so options can pretty much all be changed on the Fly whilst the VM is running hot wire you really can't so if I now change this to let's say 10 gigabytes of RAM I can't change it but it will be orange meaning well it will only take effect after we reboot the virtual machine so keep these things in mind when while you set everything up I'll just set it back to normal if you want to back up virtual machines there is an option of course with backup you can click backup now and then here we have where we want to save this so data either or local skip it data and we can set the mode so by default it's snapshot this means that you won't have any downtime so so the virtual machine can keep running while the snapshot is being made you can use that and to recover everything a another option is to suspend and stop these are a more safe way of actually backing everything up without any issues but I believe there is some time some downtime with these two okay and then you can just when this one is created you can select that one and then press restore and everything's set everything up again if you made any mistakes during a virtual machine installation for example so is this done already no it is still taking a bit we'll come back to this in uh in a minute oh it's done apparently okay that's close I know it's not done yet so I I thought so so normally after this thing at the top here so this is what I'm I'm waiting for actually this notification to be gone and then it should populate these as well now while we wait I might give an example of creating a a container now for the container I'm actually going to move to my own instance so this is my own instance of broxbox so that's actually running on on a device at home here with me I am not going to set a container up here because apparently containers don't work when I'm running proxmox within word manager so yeah I'll do it just here so let's create a container now by the way again if you can't remember local CT templates templates you can actually select a template that you want to use at the moment I already have a Debian 11 template here so I don't really need to do anything here and as I mentioned containers are very lightweight so if we compare actually a template versus a ISO image well the iso for Debian here is 397 megabytes which is very light because I believe Debian pulls everything from the internet but the container itself here from Debian 11 is only a 123 megabytes so it's a lot less and it will also take no time to actually create containers so let's create one here so create container PVE is fine let's give it an ID so I give my containers an ID of at least 200 so 205 let's just say tutorial and then a password so this is the password that will be used to actually log into the the container itself the login is again the same as you use for proxmox so in this case I'm still using just the root login I'm not sure if it's too too safe to do so but I don't really care honestly uh so it will be then root and then this password that you give over here then there's the option of either a privileged or a unprivileged container so the thing is as I mentioned these containers these lxc containers run on the Kernel of the host system so proxmox that works all fine but of course due to security and everything they are by default set up as unprivileged meaning that not everything will work out of the box now if you have like if you're using these containers and you're getting like these weird errors that it can't access a specific file or specific directory it is often just because it's not a privileged container so by default I will also I would always keep this as unprivileged but but when I'm like doing things for example like trying to connect an SMB share like the one we set up on trueness we might need actually a privileged container so now we need to go back and actually make it a privileged one and I'll show that in a minute how you need to do that afterwards well I'll keep it unprivileged and then nesting is pretty much the option to use a container within a container so what I mean by that is well we are creating a container the container is in this case Debian and within Debian we are also creating a container will which will be like our services so Docker with pothana so the things that I explained here so these things pertain up by all why I got we will use these within a container so let's go here let's keep nesting on next do keep in mind if you by default deselect unprivileged as you can see nesting will be grayed out but it will be checked but it won't be actually when you boot up the system so if you're like installing a container unprivileged and you're trying to install Docker on it well it might give issues and you think well why nesting is enabled well it will not be when you deselect this so we'll just keep it selected for now next and let's select Debian next I'll keep it at local lvm these containers don't really need a lot of gigabytes of storage this will of course depend on what services you want to run on them but for the services that I use or I use here most of them won't use this that much maybe like next Cloud will use a bit more than eight gigabytes but pretty much no more than than 16 gigabytes I believe with only office let me quickly check here with my setup can I copy this link yes so that's clouds yeah so my next Cloud instance here is running with 16 gigabytes and it's only using like 10 gigabytes and it has a lot more actually on it so yeah this one so let's keep it at eight next one call for this example is fine 500 megabytes is also fine so as you can see these numbers are a lot lower than a virtual machine because they share a lot with proxbox itself with the host next we'll keep it at DHCP if you want to set a static IP address don't forget of course the the subnet mask so 192.168.0. let's say 60. it will not allow this we still need to say slash 24 let's say and then we need to give the Gateway so 192.168.0.1 for example but for now we'll remove this and actually just use DHCP because that's a bit easier than next DNS is fine same as host and that's also fine so let's finish and now the installation 4 can a container is done that's it so that's the difference between a virtual machine and a container our installation for the container is actually done I can go to 205 tutorial console start it up and there we are done so root my password that I set up and I'm in so from here I can actually start installing docker before we do this actually because while Docker will be needed to install our services let's quickly go back to trueness is this done already so it's still valid so apparently these true charts can charts can take a while if it doesn't have a lot of resources apparently but it is it is taking a while I'm not sure why it should be the correct link so yeah yeah it's not here not yet that's a bummer we'll come back to this okay so for installing Docker what I recommend because we are now using what's it called Debian we can just say apt update just to be sure that everything is up to date fine app upgrades that's just a small update not too much and I believe the APT package manager itself if you of course choose another another distribution template that's all fine by me I I I I don't really care what you use but if you are planning on using Docker of course use the commands that are relevant to your distribution so for me I can probably say apt install Docker or Docker t or Docker compose I'm not sure that's one option personally I prefer actually going through the true adding a x at the official repository from Docker and to do so let's see Docker engine install Debian I guess yeah so I pretty much follow these steps and the useful thing about actually using a container compared to a VM is that we can actually just copy paste in the terminal so that's so much easier to actually run commands and this is not installed yet so that's fine we can actually go and install these packages yes so that's pretty much what you can do as well just look for the same address and then just follow along I'm not really reading this because I've done this multiple times but you can follow along since we are locked in as root it is Maybe a recommended room of sudo because we don't have it and we don't need it let's copy this one let's remove tree or sudo and then just two let's just do this apt update and now that the repository is added I can just install Docker yes that's pretty much all we need to do actually and there we go then the next thing is to actually install what's it called potena so patina is the first thing that we're going to actually install maybe also the potato agent all these things are again just on a on a you cannot easily find these things just on on the Internet it's not you don't need to be a genius to just find this actually so let's say potato installation docker so first link probably correct one yes so how do we deploy Docker pertainer within docker we first need to create a volume so just copy paste so I'm not going to do this because I already put in a setup and because probably all we can we'll do this we'll do this doesn't really matter let's copy paste and add a d and then this one copy paste enter and this will pull the latest image or in this case image 2.9.3 as a version and this is done so since it's a Docker run it will probably already be running in the background so how can we now know where this is running well let's just do an IP a and I'm in here it will tell us the IP address of the virtual machine in this case it is this one so 192.168.0.203 and Docker is running within either Port 8000 or for 9443 and I'm pretty sure for the web interface they use 9443 8000 is I believe for the agent so let's try 9443 that's correct one but it tells us that we need to use https to be safe so let's do that https again the warning but since we're hosting this on our own should all be fun and here we have portena we can actually now go ahead and pick a password so what password are we going to pick doesn't really matter let's change the username as well just if we need to actually log in during this whole process looks fine no thank you there we go and let's get started so we'll just start fresh and this one will be called local so if I open this at the moment one thing running and as you can see it is portana itself so we are now going to actually use this to set up all or all our services so let me just move this over to this one let's shut this down there we go now primarily I prefer using a stack reason being well it's it's a lot easier to set everything up and we can actually use Docker compose which is very useful for the future if you want to always set things up the same way now for that I have created a few boilerplates on my GitHub and I will also link all these in the description docker yeah so here they are in this case we are going to install a few things so where am I looking so for now um well we'll do this over here okay okay never mind so let's go to portena add stack let's give the stack a name so we'll just call this one pile because that's the first thing that we will set up as a service so this will be used for ad blocking and for your local DNS so what we do is go to my boilerplate for pile and these are called like Docker compose files so as you can see here this is what I've set up and this here is what we're going to copy so we're just going to copy and paste and what this actually tells us well first of all is how is this setup in this case it uses Docker compose version 3. we will create a service called pile and for that we are going to pull an image from Docker hub and that will be called pie hole and we are going to use the latest tag so that's the version in this case we'll just always want the latest version the container is also just called pie hole and we set it up as restart until unless stopped so it will even when there are errors it will always try to restart unless we actually manually stop it in this example we are also setting up a network and this network will be used for wireguards so this is pretty useful wiregot will be our VPN that's the next thing that will set up and um by actually created this creating this network what we can do is actually like install wiregot on our smartphone and connect to or local home network using like wiregot and then through pile meaning we'll also get like an ad blocker for our phone which is pretty useful in my opinion sort of ports that will need to be opened these are all for for local use so you don't need to open these on your modem that's not needed this is purely all for your local computer and then for the volumes this is persistent data that you want to store so in here we need to actually change this to the location within the virtual machine so if I go back to here let's close this one out actually because we don't really no longer needed so in here we can actually like make a directory called docker and then pile for example so if you go to docker and then inside pie hole and then the parent worker work directory is slash root slash Docker slash pile so that's what we're going to use you can of course choose whatever you want here where you want to store it on the virtual machine so root docker buy a hole and let's then call it Etsy for example since it's at sea pie hole so when you do by default it will create these directories as well but then the owner will be well Docker and if you want to keep this your own file you it's recommended they create these on your own so let's create it and say Etsy and create that and what else DNS mask so let's call this just um DNS there we go so these are also created so back to Patina the the and DNS and I can also here set the time zone this is purely for logging for logs and then the web password that will be used to actually log into the service itself we are also then going to create the network as long as it doesn't exist already from pile and we are going to give it a subnet and everything so it can actually be used so here we set the IP of this container so which this will be 172.2 20.0.2 and I believe like why I got in the boil plate is set up as three and then the network itself so the subnet and uh whole network is just 172.20.00 okay so I'm not going to create this actually here because while this network will probably be detected already because it already exists because I'm running it um with the same IP so I'll just move over to my own pertainer instance in this case so let's quickly go there potato yes and for me it's on a network stacks file editor so as you can see here it is for me I've set all everything up here I've given it also like a location for everything to save so we can then just create or in this case for me update you can just create the stack this should build without any issues and then under containers you can see them running over here and we can actually go to these interfaces so if you remember the IP address you can just go there so what was the IP address here for us it was 192.168.0.2 to 203 it uses a lot of ports here but well this won't be used by piles so to actually get to this website you will actually have to say like 192.168.0. what was it like 180 whatever and then the slash admin and that will be the admin panel that we can actually use to log in so if I log out here quickly how do I log out there we go you will pretty much see something like this um and then you can just log in and we'll be in here so this is pretty much used for blocking ads and using as a DNS now a few things maybe to set up let me quickly check because there are maybe a few things that you want to do yeah first of all you can use your DNS here as well so we use file as a local DNS but of course by all needs to connect to the internet to actually serve your websites if you like enter Google or or YouTube or something and then you can here choose which DNS you want to use so cloudflare is like 1.1.1.1 I believe so these are a few things that you can set up here um is that something else not really at the moment I believe no so that's pretty much it the useful thing now is that you can actually use this IP so well for me it's now not no longer an IP but let's say where is it yeah so this IP so 192.168.0.203 we can actually use this at our DNS now so Within uh your settings of your machine you can go to your network well I'm using like Linux so if I go to host desktop let's see uh okay so here at the bottom these are my in my settings for my computer but what I've done is I've set up the name server as the IP of my pie hole so if you're setting a pie hole and the IP from the virtual machine was like something like well was it let's scroll down 192.168.0.203 you'll just enter that here within your name server for Windows I guess it's just the DNS location itself um and that's how you set it up actually and then it will every time it runs it will use the pile as your local DNS okay you know the default gateway of course is pretty much always the same so you don't really need to change that um but that's pretty much everything okay we're going to also use bile as a local DNS so once you've connected to bio as your name server we can actually go to the local DNS and DNS records and here we can actually go set up where everything needs to go so I've set up now a buy Dot LAN domain that I can can search for so if I go to Pi dot Lan and presenter it goes to the dashboard so I don't really need to remember the IP where it's hosted or which virtual machine it is actually hosts so that's pretty useful so we can just give the domain here and then the IP address now if your service like the potato service if you can remember where is it was it no Maybe let's go back to that website again here we go so as you can see portena itself the dashboard runs on Port 9443 so we can't really do that within pile we can't really give an IP so let's say 192.168.0.5 we can't set like 9443 it won't allow us to do this so an example is like this and like press add something is wrong this is not a correct or a valid IP address so we can't really do that and for that we actually need something like the nginx proxy manager so that's the full thing that we will see actually okay so let's close this and this and from Docker let's go to wire guards there we go so I've also set something up like this for wireguard which is also just a Docker compose file and in here we also have something that we can just copy paste actually and place within portena so we can just go to stack again add a stack call it wireguard in this case I already have it here and just enter all the information that you need at the bottom here so there are a few things that you will need to change so if I zoom in again the persistent data this data is pretty much as I mentioned before used for when you are going to actually move all these files to another virtual machine or you want to get all these backed up locally these are all the settings that you actually use so if you have this file you can always spin up a new container in Docker with let's say why I got and it will always be set up the same with this persistent data so that's pretty useful some things you need to change is first of all the puid so you can find that by actually going to the virtual machine yeah and I believe what was the command again so ID you for the user and idg probably for the group in this case both is uh well are zero because well it's the root user if it's like a username that you already have created it will probably like a thousand or a thousand one but for me it's just zero that you will enter the time zone again and then we also need actually to add a server URL so in this case it will probably be your either your domain that you already own or like your um your IP address so your actual public IP address so what you can do is like soft to something like um ipchicken.com I believe it is yes presenter I'm not going to do it because I'm not going to leak my IP address of course but that will be a public IP address and I believe it should work with here just entering your public IP address and then just creating this port so this is the port that is used by wireguard itself do remember that you need to open this pool so how do we open this port well just go to your modem or your router depending on where you open your ports to well the general public to the the internet itself in this case I have like a weapon to face for my provider and what I did was well I created a link to my local IP address well it's another in another language but I guess you can configure this out actually so this will send all the requests that come from Port 51820 this is the the start port and the end port this is external so I can change this I'm not sure if you can do this on every uh on every modem but keep this pretty much the same you can of course open like more ports here to the same end port internally for me it's just sending all the requests from Port 51820 to 192.168.0.4 and of course did this is the IP address where God is running so the virtual machine where wire got this running and if you can also select it you only need to do this for UDP so not for TCP or both just UDP so that's also quickly how you pull forward of course I can't tell you where you can find this uh this is sometimes a IP address that you need to search for like your your default gateway or something um but of course this is something that either your modem or your internet service provider can tell you where to find actually okay is there something else maybe I need to tell about this let's go back to the boil plate yes so with why I got the the neat thing in my opinion is that you can actually only generate certificates for specific devices so not everyone can actually access so this port that we've just set up you might think oh now I'm exposed to the whole wide world not really the case the only way we can actually access the sport and actually use the network the internal network is with these peers so if I only generate one pair and this pair is used on a specific computer then no one else can actually connect as long as they don't get the the key itself that is generated you well nobody will be actually able to access this port so yeah you can either give it a number or you can actually give it a name in my opinion names are pretty useful just to remember which certificate or which configuration file is for which device so that's pretty useful the DNS you don't really need to change this is what we've set up with with the network already um the peer DNS you can keep this at Auto but because I've noticed that there are some issues with um with everything it it I do not recommend it you can just keep it at this because then we are sure that by all is being used actually the internal subnet this is pretty straightforward you can choose whatever you want there I believe but I kept it to the default that wiregot recommends the allowed IPS you can always set up like a range for specific IP addresses to be used one when you set it to this pretty much every device can be connected and accessed so for me I know it is pretty safe if you don't share anything with anyone so I'll just allow everything in my opinion and that's pretty much all there is to do then I do need to check quickly because once you've run once you've set this up and given the correct variables in it will you can create the stack again go to containers and then from here you can view the logs and within the logs it should generate also like a what's it called like a QR code in this case I can't see it unfortunately um but I call you QR code is for example used if you want to use it with the app from why I got you can then scan it and that's very easy then to set everything up but if you want to actually access these things we can go to like this icon which is like the the terminal or the console I believe they use Bash Maybe not maybe sh then just okay that might be an issue then if we can't exit this axis like this let me quickly check because I can't remember all these things on my own actually that's why I've created like these uh these boilerplates so Within These boil plates I also have like a read me with the specific things so let me check this is for installation check that seven copy and it is relevant yes okay we can just copy it then in this case um okay so let's then go here let's go to my virtual machine that is running wiregot which is a network and if I do an LS as you can see here I have a directory which is called wiregot let's go in there and this is where my actual persistent data comes in pretty useful because if you can see over here in my stack why I got editor I have stored my configs under root why I got config so if I go back and I go into config and do another LS here are my pairs so I have a pair for my MacBook one for my phone and one for my ThinkPad so what I can now do let's say I've generated one config in here what is it so here you can see that's these three I can now actually go in and to do I'm going to let's say pay a phone LS and then we have here a pair underscore phone.com and this one can then be shared over the network with other with your with your phone or if you have like a laptop with a ThinkPad you can use this config and you can actually use that to actually connect to your local network so that's pretty useful in my opinion now I did write some other things down and so you can actually move these so if you need a bit more information I'm going to going to go into too much detail and not waste too much time because not everyone will be interested in this but um how to actually access access these files how to generate the QR code will probably also be in here yeah yeah so that's pretty much this command that you can run so I'm not going to do it because otherwise I'll make my own uh via a VPN available to everyone on the internet but you can actually run these commands one thing to note as you can see there are a few notes which are quite important and I'll show that as well one thing is actually to enable ipv forwarding via CTL so you can just copy this go to PVE enter this press enter and you're pretty much done of course this is in the container we also need to do this within proxmox so we go to the node to Shell and do the same as well here enter and then pretty much you will have no issues connecting to your local network maybe one more thing let's have a look here um I think if you want to make this persistent yeah so to make this persistent you actually need to enable this within the within this file so let's go down so CD oh no that's the file itself so there's one thing here that is uncommented net.ipv4 ipv4 winning equals one so this will then always enable this feature even when the computer or the server reboots so with the command that I've written down here well it will work but after you restart a virtual machine or the or proxmox itself well you will need to re-enable this so that's something that we don't want to do so maybe to make this persistent enable this within the config file of course with all my boilerplates have a look at readme because I pretty much just explain everything what's in here what it needs to be changed and then also the usage and the notes so I'm not going to go in too much more detail about this now next up what else are we going to have a look at is the nginx proxy manager which is very useful so with that again there's a boilerplate full Docker nginx proxy manager and this one is probably very easy yes so you don't really need to do anything here again there's a bit of persistent data as you can see here again just create these within a virtual machine or within a container and then we can go to that website I believe that the network well the the interface for this will be on Port 81 so H1 for me adds this one and I might need to blur a bit here but we'll see so once you're logged in so you'll probably need to like create an account in this case I'm already logged in you will pretty much come here and we can actually set up like a local DNS so that's pretty useful so the first thing we want to do so let's say with portena what we can do is add a proxy so from here we can like give the IP address that we went to to go to portena let's say let's say we want to add nginx proxy manager to portena and portena in this case let me quickly check here so container here is on this IP for me copy that's quickly paste we can remove this so that's what pretty useful if we don't want to actually remember the the IP address to actually serve to this to these web interfaces so the domain name in this case will be anything you want whoops so let's paste the IP address here where it actually belongs there and then we need to give the the port number in this case I am using port 9000. if you're now alarmed that we just set it up with 9443 um don't be this is because I'm using potena like the Enterprise version or the business version for you if you're using the community edition of course you don't need to do this you can change this to 443 but just to make everything work I'll keep it like this by default it uses https I believe let me quickly check let's before we do let's quickly check here apparently for the Enterprise version it doesn't but if I remember correctly we did receive an error just a minute ago that we weren't accessing https so maybe for you it needs to be https by default but I'll keep it for me for this example with HTTP and we can give it a name so let's give this a name of tutorial dot Lan so that will be the the domain name in this case that we want to access this you can then also set up a few extra things here so let's say block common exploit this one or um yeah these all don't really pretty much for me I only enable this one you can also create an access list if you want to but since we are just going to access this locally you can keep it up publicly accessible this looks good we don't really need a custom location I'm also not going to go into too much detail here and the SSL we can do that but I'll show that when we are hosting like an nginx website actually so I'm not going to go into too much in detail now for that so this looks good so tutorial that Lan will bring us to or pertain a dashboard unfortunately that this will not work at the moment so let's go to tutorial .lan and nothing happens so I might want to actually for the first time do a slash and this will not find actually the the domain itself because it doesn't exist there isn't like a DOT Lan that doesn't exist so to actually use this we can now go here within pile or pile and actually add tutorial dot LAN and we're not going to use the IP of portena so potena was on 192.168.0.4 no we're actually going to forward this to the location of our nginx proxy manager so then afterwards nginx proxy match you can actually send us to the correct IP address and correct Port we need to access so nginx for me now runs on 5 ip5 so that looks good add and it should be in here somewhere at the end there we go so now it should work without any issues hopefully it might take a while before it populates but of course this should work do keep in mind that you can't really just just use any web address of course it tells you here okay this is the the the order it actually picks the correct address so if you're like going to use a.com website that already exists this won't of course work it will just send you to the the correct online Network um website in this case but for DOT Lan it won't give any issues so if I now reload try again it actually loads us into the website and we can now log in and it doesn't remember my login so I can't really log in but that's how we actually do our local DNS so that's pretty straightforward in my opinion um nothing fancy actually for this many people struggle with this but this is in my opinion one of the easier things to set up especially with bile of course okay what's the next thing next thing next Cloud okay so again to the boilerplates docker and next cloud is here so next cloud is pretty much used for um or storage so we've set up storage of course as you can see here we have created a data folder where we can store all our data on and we are going to use this data from trueness within nextcloud maybe now we're here let's quickly check of all true charts actually work because that took a while yes so as you can see if you're still here since the true nest installation it actually populated all the other services here so if you don't want to actually follow along no longer or you think it's a bit too hard for you you can always just set all these things up within here as well so I I think they probably also have an X cloud in here let's see next Cloud ah yes it's even one that is official so yeah so yeah I'll keep you with it depending if you want to choose it from here and install it but we'll keep going with the boilerplates so for now I am actually going to use the official one I believe it's a bit more straightforward Docker compose will copy everything here and in this example I'm actually also using a few labels for traffic these can pretty much be removed so these are if you're actually going to use something like traffic as a reverse proxy if you see one of my boilerplates with labels do check and make sure it's not anything for for traffic if you're not using it of course but I pretty much explained this as well in the readme I think yeah as you can see here so these are all for traffic so you can safely remove these and within this Docker container for next cloud we run a few servers so we run first of all next cloud but we also run redis and mariadb this is pretty useful as a database but do check that you fill in all these variables and that they actually are correct so here with mySQL or MySQL how you want to pronounce it it doesn't really matter these are need to be pretty much the same as here so the root password the normal password and the database that you set here should be the same otherwise of course there will be a lot of issues and for this if you want to run it of course as a on your local network do not forget to actually open the sports if you're actually going to use something like your own domain that you own you don't really need to open these ports I believe um or maybe you do I think with theft with traffic you don't really need to it will find Esports but with um engine Xbox manager it can't hurt of course to enable this Okay so next up once you've copied this over of course we can go to Patina let's go to my instance wooden cloud stack next clouds editor so as you can see this is the one that I've set up um yeah the password very hard but of course no one accesses this but if you set everything up correctly here it should all work as one thing you don't need to set anything up with settings within redis or Maria DB these are pretty much all set up so they should work in conjunction with each other so you don't need to do anything special here actually uh once this is set up you can go to containers and it will actually create a separate container for all of these so one for next Cloud one for my ADB and one for redis so these are all running without any issues and then again if you want to you can set up like a local domain name for this so I'll just quickly go to mine there we go so this is pretty much where you we will just solve to the IP address and then port what was it if you set up a port well it depends you can keep it 80 so you can just go to the the IP address or set it up as 8080 and then just visit that website so for people who don't really understand this if we have a port enabled for the the docker compose file the left side is actually the outside so what is running in your virtual machine and the port on the right side is what is running inside the docker compose the docker container so here we have slash four slash www slash HDML that's inside the docker and then on the left that's our persistent data that we can of course access within the virtual machine and this is just the same for ports so left is the port in a virtual machine and on the right is the port on Docker so you can actually change the spot to whatever you want here on the on the left actually okay so once you've filled everything in created your database and and registered your user maybe we'll just now quickly enable how you can actually use the the data or the data pool that is available with the hard drives that we've connected with trueness so that's data how do we do this well we go to apps I believe and then from here we can click the search or the the foreign it's slipping out of my mind the name of it the magnifying glass and we can search for external storage I believe it is called and this will for you be not enabled so you can just enable this and then from here we can go at the top again to settings and if your user is a administrator we can go to external storage and from here we can actually add the the storage itself so how do we do this well we are going to of course use the local and then give here the path to the data now if you have a look at my what is it next cloud my slash data is mounted to MNT storage so this is something that doesn't exist so m t storage is a map is a directory that did not exist within my virtual machine so what does that mean I have a look here clouds let's go to CD m t storage I do an LS here are all my files that are actually on my server on my trueness data pool now how do I get them on here because well this this shouldn't be on there this should be on my virtual machine from from tune as well I'll explain that in a minute but do create already a location where the where you plan on adding these files to uh well the virtual machine that is running next cloud of course so just create this directory already before setting everything up let's say we have like a date up to or something we can give it a specific owner in this case and then we can just press save and it will actually load all the files in here now to actually access the files from trueness what we will need to do is go to the virtual machine and we need to edit Etsy slash f-step so this is where we are going to mount our storage locations so in this case we had like a 192.168.122.85 so that's the IP address from trunes and our SMB share was called Data so slash data in my example here it is another IP but it's pretty much the same so it's slash slash 192.168.0.3 if we were following the same example it would be 1 to 2.85 slash the name of the SMB share that is available and then we actually do a space and then the location where everything will be mounted to automatically so in this case the map that we created so MNT storage and this mnd storage then is used here within potato within our stack M D Storage to actually link to Insight or dock a container to slash data now slash data also didn't exist in the beginning with next Cloud but it all creates this by default without you having to interfere with anything with this stack or this Docker compose file in this case now a few things that you need to add here of course within the Etsy f-step file is of course it's a Sif or sifs also known as an SMB share then we need to give the username and the password and this password I might have to blow actually and for the uid we need to actually find the uid from Docker in this case because well if we are going to set this to a uid from ourselves so if either a thousand or zero there is a possibility that Docker won't be able to see this this um this directory just because of the permissions issues and then a few other things here is of course underscore net Dev and no fail this is just a few other parameters that we need to enable just so that everything can boot even when the SMB share is not available and then space 0 space 0 I'm not going to go into too much detail about this but just keep that the same as well okay and once you've done this you can always just right quit and say Mount Dash a or just restart the virtual machine and then everything should be mounted and you will be able to actually add files to this next up so once you've added that here so in my example I just called the folder a specific name so files for example we can keep this to local and then use data here depending on what depending on on which version you use of next cloud or if you're using it within like trueness or something there might be also another option here called SMB sifs and then you don't have to do everything within the virtual machine you can just enter like the IP address of the SMB with with the name of the SMB of course okay so that's pretty fun so here it mentions there as well so that it is not possible for for this version and mine in in my situation actually so once this is done you can just go to files and then here will then be a folder created in this case called files and in here are all my documents that actually are stored on my on my trueness installation with my data pool and everything so that can be accessed here okay oh yeah one more thing before I forget because of course now you can actually store all your data on here but you can't edit them uh yeah so with my PowerPoint so the the home lab Dot pptx I won't be able to actually access them uh access this by default so if I click on this it will actually open only office which is pretty useful in my opinion to actually edit these things within well a browser so it's pretty much the same as OneDrive or Google Drive so that's very neat in my opinion now how do we do this well quickly go to boil Blaze again docker and you can either choose in this case to use collabora or only office this is what you prefer on your own I do also believe where is it let's go here to apps and if I search for next Cloud office yeah so that's an option here that we can enable or disable or download I think if we go to apps and then to office and text yeah so in this case it's it's not a collaborative office but it's called collabora online so this is pretty much used for um if you don't want to actually install like a container so this will all run within uh next Cloud now do keep in mind this is not something that works very well in my opinion so I've tried to do to use this but every time I do it everything becomes very slow and and isn't very responsive so I personally do not recommend that you actually set this up but you always can try and have a look maybe for you it does but recently it just didn't really work for me so but if you enable these Collabera online uh built-in code server I do also believe that you need to enable next Cloud office yeah so that's this one so it's kind of the same but you also need to enable this as well if you're going to use only office you don't need to do this actually but you do need to go to the only Office application and actually install this so this will create the connector that can actually connect to your self-hosted server instance of only office so let's do it with only office then shall we so only office go to the docker compose file and this one is again very easy to set up as you can see so it's very small you can again just go to patena stack create a new stack and run it of course do check that you're not having overlapping ports otherwise you need to change like the left one to a new port or yeah or run it in another in another virtual machine with another IP of course that's also an alternative now to add this so let's let's say you've added this you created the stack you are running it and it should all be fine what we can do is go back to next cloud and go to settings and then there's an option on the administration only office and if it wouldn't fill that in that would be great let me just quickly disable this um setting things I need to blur maybe some of these things now but we'll have a look yeah reload so in my case I have created like a a domain a local in this case it's actually accessible over the internet but you can just give here your either local LAN if of course this container is using the same name server so from pile or you just give the IP address here that connects to the only office location so this is for me I'm going to partially blur this of course because well this is actually available online I don't want other people to make use of this and then after this is validated you can just select here what you actually want to allow how you want to use it um yeah that's pretty much everything here do keep in mind if you are going to run these instances do check that they are the same level of security so if your next Cloud instance is running under http your only office can of course run under HTTP if your next cloud is running under https for example when you're using your own domain and it is automatically validating it and sending it to https your only office link here should also be encrypted if this is not the case you won't be allowed to actually connect because it's not a secure connection so that's something to keep in mind but after you've connected you will either get an error that tells you okay the the it's not the same security certification or it tells you okay it is connected of course and you'll actually see this being updated to Common settings so you can actually change these things then okay that's that's pretty much it for next cloud oh yeah so once this is set up you can just go to files and then when you press on the plus you actually have a lot more options so by default it only has like upload files new folder and a new text file but with only office you also get a new document spreadsheet presentation and form template so that's pretty useful to actually have within the next Cloud itself then last but not least running an nginx website in this case so for that what I have done is within my proxmox instance I've created a virtual machine for website and in this case I have installed just a Debian let's see can I is it still mounted nope but I've used like a Debian container for this and then I've installed engine X I believe oh it was already installed by default if I'm not mistaken so you can just go to where is it local templates Debian 11 for example that's that's a great one in my opinion and when you install it by creating a container we can go to where was it again I think it was before www slash HTML just do an LS and and here we actually have well these are the files for my website but this is where you are going to place your files for your website so the index.html and so on and then normally if I have a look at my nginx proxy and go to my website edit it should indeed just run on Port 80. so you can just soft to the IP address from your web from your um what's it called your virtual machine so IPA in this case for me it is 192.168.0.6 of course you can always make the Statics to make it easier to remember and then when you serve to this it should go to your website so let me copy this paste and this of course loads my website and all should work without any issues Okay so once you've done that so you don't even need to use Docker for this so in this case I'm also not using Docker you can of course if you want to but since this is something a service that is running by default on Debian I I use it like this if it's not running yet you can always do something like system CTL start nginx or if you always want to enable it you can say system CTL enable nginx and this will oops and this will actually always start it up when the virtual machine starts up so yeah now next up to make this website available again to the whole white world one thing you need to do is actually make use of the nginx proxy manager again so what I've done here is I have the IP address from my virtual machine that is running nginx with my website on it I have the port which is just 80. and by default it goes to http of course then I've given here a few domain names where it needs to redirect to and these domain names need to actually be yours of course otherwise this won't work and I also block of course the common exploits and I use an SSL so SSL is for the https so if I go to my website it will always be actually like encrypted and safe to visit so people won't get like these warning signs like when you first open up your pertainer instance or your proxmox instance you get These Warnings so that's why I have a SSL and for this I use cloudflare because they make it very easy in my opinion to set everything up so let me close all these things because we no longer need them container also not nope okay and nginx so I force of course the SSL and any certificate here we do need to generate still so how do we do this well first of all I'm not going to explain of course how to create a whole website but of course make sure that the DNS so the the hosting of it goes through cloudflare so you can always just generate like a you can always create a account once you're logged in you can add your website in this case give your domain name add a site cloudflare will then give you like the name servers that will be used so if you are not purchasing your domain name from cloudflare you need to of course go to your um what's it called again for me it's Epic .com your registrar and if I go there hopefully I don't need to blur too much here that's something I already need to blur great so if I go to my website here and I go to my name servers as you can see I had to change these because normally these go through epic as well for me but I had to change these to the name service from cloudflare and then I can afterwards manage my website through cloudflare so I can click on it there we go and the thing you need to do is for nginx we are going to create an SSL certificate this is how we are going to request it of course and create a let's encrypt certificate and the domain name of course you need to give here so for me it is binatpant.com and just a wildcard.bination.com and then so let's just use a dummy in this case.com you give it a an email address this email address will be used for let's encrypt to actually send you email messages with updates from films of service and when your certificate will be um invalid so after a while it will be invalid and you need to actually request a new one but in this case we are first going to use a DNS challenge because this is what cloudflare uses so let's use cloudflare of course you don't need to use cloudflare if you have another provider as you can see there are a lot a lot of providers here so cloudflare and they actually ask you for an API token in this case so go back to cloudflare and then scroll down on your overview panel I need to blur this again and then here we can get your API token so I press on that and I believe you can just use the global API token but for what I use this I just created a wildcard token and as you can see if I edit this one so you can just click create token and it'll come to this menu you can give it a name and in this case just change the permissions to Zone DNS edit and then include all zones so that's for all the zones so for your normal domain name and all the wild cards in front of it and then we can just continue to summary and it will actually give you an API token and this API token can then be used over here just remove this this one and at whatever is needed here doesn't really matter propagation seconds leave empty yeah we can just leave this empty we can accept of course the terms and service and this will then load up a new certificate now to actually make us able or anyone on the internet able to actually connect to this now because we are we are linking this we do actually also need to set up within cloudflare that we sent all this traffic to our host so to to our server and to do this we can go back to websites to my website and to DNS and we can actually here then create our uh records so in this case as you can see I'll just blur the IP address but we need to First create a well this one will be by default here I think so my domain name and then the wild card is just a star and on your IP address and then the rest here oh yes and something I forgot to mention actually when you're generating this IP this certificate it is maybe recommended that you temporarily disable proxied for these IP addresses otherwise it might not actually be able to connect to um this so yeah so that's very important and so you can just add like a wild card your own domain and maybe also www because pretty much that's also a wild card and for me I also just proxy them all over also because these will be using Port 80 and 443 to actually connect to your website this is something also you need to go port forward on your your modem so in this case for me as you can see here ports 80 will be sent to nine 192.168.0.5 and also Port 443 also 48 TCP also will be sent to the same proxy manager and this the so the 80 is for HTTP so not encrypted not safe and 443 is for of course the encrypted encrypted website connections within here maybe also something else you can enable just to make sure that you always have like SSL um what is it again oh yes here on the SSL TLS you can actually where is it yes yeah an edge certificate uh yeah here you can actually also just generate certificates if you want to um but you can also enable always use https so this is the website connection is always secure so whenever anyone tries to access your website it will always be https hopefully I didn't forget anything here um I don't think so automatic HTTP rewrite is maybe also useful so when someone actually looks for your website with HTTP it will automatically redirect to https so that's all things that we don't need to actually manage with the nginx proxy manager so that's something very useful now do keep in mind if you are planning on running some of your services also over the network so let's say you have a domain but not only you want to use your website for this but you also want to actually like say let's say a run a Plex Media Server or use something like fault Warden as I'm using then you also need a domain let's say you want to actually lock this down even more securely what you can do with an engine Xbox manage is actually create a access list so if I add an access list I can here then give it a name probably enable satisfy any and then the authorization I can actually enable the to add a username and a password so whenever someone wants to access like your Plex server they first need to use a different username and a different password actually to get access to it so this is pretty useful the access IP settings it is useful if you're using it locally but since we are using well cloudflare with proxy well when it went with the crop the connection being proxied you can't really you don't really know what the IP actually is that is being used to connect to this so that's not really useful in my opinion um but for local use this is also a great rule but I think most people will just use a username and a password actually and once this new access rule is created so I have one for auth I I call it two two Factor off what you can do is then go to your host proxy host let's say this one it's disabled so it doesn't really matter I can click on enable oh no not enable I can click on edit and then on the access list I can actually use the off list and if I now want to use the SSL certificate that I've generated I can go to SSL and then here I can select the one that is available so in this case this is the one I've generated and it tells me when it's going to expire so I know when to actually regenerate it I can also request a new SSL certificate so since the API is still linked I can now easily create one from here and if I don't want one I can also just select that as well is there something else I need to mention let's see I'm not going to go into at the advanced rules that's a bit too much in my opinion no that's that's pretty much it I believe did I do everything yeah so that's pretty much everything that well I use a lot a lot more services of course if you can look at my boilerplates again yeah as you can see I run a lot more more services at home but these are in my opinion pretty essential so have a look at what you need what your needs are what you actually want to use I have of course a readme for all of these so if you don't know what they are it tells you very quickly what it actually is with next Cloud also so that's that's pretty useful um yeah so hopefully it is all clear of course I didn't really have a script for this this is all just I just created like a PowerPoint for three slides and that was pretty much my preparation so if you have any questions do let me know in the comment comments um I hope that you have a general idea now how you can set everything up and get everything working of course I do need to mention with vpns and width um yeah these IP addresses and and your your own registrar and your name service this can be finicky so especially if you are using another one do of course your own research don't ask me everything I don't of course know everything but I do wish you all the best of luck with it and um yeah maybe uh I'll see you all in a new Mini course in the future thanks"
    }
}